(()=>{var e,t,s,a,i,o={8936:(e,t,s)=>{"use strict";s.d(t,{gq:()=>n,Z6:()=>r,kw:()=>l});var a=s(2928),i=s(4184),o=s.n(i);s(7294);const n=e=>{let{children:t,className:s}=e;return(0,a.Z)("div",{className:o()("flex-row",s)},void 0,t)},r=e=>{let{children:t,className:s,shrink:i}=e;return(0,a.Z)("div",{className:o()("flex-row-col",s,{"flex-row-col-shrink":i})},void 0,t)},l=e=>{let{auto:t,children:s,className:i}=e;return(0,a.Z)("div",{className:o()("flex-row-section",{"flex-row-section-auto":t},i)},void 0,s)}},905:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});var a=s(2928);s(7294);const i=e=>{let{children:t}=e;return(0,a.Z)("div",{className:"container page-container"},void 0,t)}},9145:(e,t,s)=>{"use strict";s.d(t,{mr:()=>r,gC:()=>l,sP:()=>d,eA:()=>c,Ql:()=>p,bM:()=>u,Iv:()=>h});var a,i=s(2928),o=s(4184),n=s.n(o);s(7294);const r=e=>{let{children:t,className:s,styleName:o}=e;return(0,i.Z)("div",{className:n()("page-header",s,o&&"page-header-"+o)},void 0,(0,i.Z)("div",{className:"page-header-bg-image"},void 0,(0,i.Z)("div",{className:"page-header-bg-overlay"},void 0,a||(a=(0,i.Z)("div",{className:"page-header-image"})),t)))},l=e=>{let{children:t,className:s,styleName:a}=e;return(0,i.Z)("div",{className:n()("page-header-banner",s,a&&"page-header-banner-"+a)},void 0,(0,i.Z)("div",{className:"page-header-banner-bg-image"},void 0,(0,i.Z)("div",{className:"page-header-banner-bg-overlay"},void 0,t)))},d=e=>{let{children:t}=e;return(0,i.Z)("div",{className:"container page-header-container"},void 0,t)},c=e=>{let{children:t,className:s}=e;return(0,i.Z)("div",{className:n()("page-header-details",s)},void 0,t)},p=e=>{let{className:t,message:s}=e;return(0,i.Z)("div",{className:n()("page-header-message",t),dangerouslySetInnerHTML:{__html:s}})},u=e=>{let{children:t,className:s}=e;return(0,i.Z)("div",{className:n()("page-header-message",s)},void 0,t)},h=e=>{let{styleName:t,header:s,message:a}=e;return(0,i.Z)(d,{},void 0,(0,i.Z)(r,{styleName:t},void 0,(0,i.Z)(l,{styleName:t},void 0,(0,i.Z)("h1",{},void 0,s)),a&&(0,i.Z)(c,{styleName:t},void 0,a)))}},6106:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});var a=s(2928),i=(s(7294),s(2233)),o=s(9627);const n=e=>{const{agreement:t,checked:s,errors:i,url:n,value:r,onChange:l}=e;if(!n)return null;const d=interpolate('<a href="%(url)s" target="_blank">%(agreement)s</a>',{agreement:(0,o.Z)(t),url:(0,o.Z)(n)},!0),c=interpolate(gettext("I have read and accept %(agreement)s."),{agreement:d},!0);return(0,a.Z)("div",{className:"checkbox legal-footnote"},void 0,(0,a.Z)("label",{},void 0,(0,a.Z)("input",{checked:s,type:"checkbox",value:r,onChange:l}),(0,a.Z)("span",{dangerouslySetInnerHTML:{__html:c}})),i&&i.map(((e,t)=>(0,a.Z)("div",{className:"help-block errors"},t,e))))},r=e=>{const{errors:t,privacyPolicy:s,termsOfService:o,onPrivacyPolicyChange:r,onTermsOfServiceChange:l}=e,d=i.Z.get("TERMS_OF_SERVICE_ID"),c=i.Z.get("TERMS_OF_SERVICE_URL"),p=i.Z.get("PRIVACY_POLICY_ID"),u=i.Z.get("PRIVACY_POLICY_URL");return d||p?(0,a.Z)("div",{},void 0,(0,a.Z)(n,{agreement:gettext("the terms of service"),checked:null!==o,errors:t.termsOfService,url:c,value:d,onChange:l}),(0,a.Z)(n,{agreement:gettext("the privacy policy"),checked:null!==s,errors:t.privacyPolicy,url:u,value:p,onChange:r})):null}},7235:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});var a,i=s(2928),o=(s(7294),s(2233));const n=e=>{let{className:t,text:s}=e;return s?(0,i.Z)("h5",{className:t||""},void 0,s):null},r=e=>{const{buttonClassName:t,buttonLabel:s,formLabel:r,header:l,labelClassName:d}=e,c=o.Z.get("SOCIAL_AUTH");return 0===c.length?null:(0,i.Z)("div",{className:"form-group form-social-auth"},void 0,(0,i.Z)(n,{className:d,text:l}),(0,i.Z)("div",{className:"row"},void 0,c.map((e=>{let{pk:a,name:o,button_text:n,button_color:r,url:l}=e;const d="btn btn-block btn-default btn-social-"+a,c=r?{color:r}:null,p=n||interpolate(s,{site:o},!0);return(0,i.Z)("div",{className:t||"col-xs-12"},a,(0,i.Z)("a",{className:d,style:c,href:l},void 0,p))}))),a||(a=(0,i.Z)("hr",{})),(0,i.Z)(n,{className:d,text:r}))}},366:(e,t,s)=>{"use strict";s.d(t,{Z:()=>p});var a,i,o,n,r,l,d,c=s(2928);s(7294);const p=e=>{let{thread:t}=e;return(0,c.Z)("ul",{className:"thread-flags"},void 0,2==t.weight&&(0,c.Z)("li",{className:"thread-flag-pinned-globally",title:gettext("Pinned globally")},void 0,a||(a=(0,c.Z)("span",{className:"material-icon"},void 0,"bookmark"))),1==t.weight&&(0,c.Z)("li",{className:"thread-flag-pinned-locally",title:gettext("Pinned in category")},void 0,i||(i=(0,c.Z)("span",{className:"material-icon"},void 0,"bookmark_outline"))),t.best_answer&&(0,c.Z)("li",{className:"thread-flag-answered",title:gettext("Answered")},void 0,o||(o=(0,c.Z)("span",{className:"material-icon"},void 0,"check_circle"))),t.has_poll&&(0,c.Z)("li",{className:"thread-flag-poll",title:gettext("Poll")},void 0,n||(n=(0,c.Z)("span",{className:"material-icon"},void 0,"poll"))),(t.is_unapproved||t.has_unapproved_posts)&&(0,c.Z)("li",{className:"thread-flag-unapproved",title:t.is_unapproved?gettext("Awaiting approval"):gettext("Has unapproved posts")},void 0,r||(r=(0,c.Z)("span",{className:"material-icon"},void 0,"visibility"))),t.is_closed&&(0,c.Z)("li",{className:"thread-flag-closed",title:gettext("Closed")},void 0,l||(l=(0,c.Z)("span",{className:"material-icon"},void 0,"lock"))),t.is_hidden&&(0,c.Z)("li",{className:"thread-flag-hidden",title:gettext("Hidden")},void 0,d||(d=(0,c.Z)("span",{className:"material-icon"},void 0,"visibility_off"))))}},6768:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var a,i=s(2928);s(7294);const o=e=>{let{thread:t}=e;return(0,i.Z)("span",{className:"threads-replies",title:interpolate(ngettext("%(replies)s reply","%(replies)s replies",t.replies),{replies:t.replies},!0)},void 0,a||(a=(0,i.Z)("span",{className:"material-icon"},void 0,"chat_bubble_outline")),t.replies>980?Math.round(t.replies/1e3)+"K":t.replies)}},2490:(e,t,s)=>{"use strict";s.d(t,{o8:()=>n,Eg:()=>r,Z2:()=>l,tw:()=>d});var a=s(2928),i=s(4184),o=s.n(i);s(7294);const n=e=>{let{children:t,className:s}=e;return(0,a.Z)("nav",{className:o()("toolbar",s)},void 0,t)},r=e=>{let{children:t,className:s,shrink:i}=e;return(0,a.Z)("div",{className:o()("toolbar-item",s,{"toolbar-item-shrink":i})},void 0,t)},l=e=>{let{auto:t,children:s,className:i}=e;return(0,a.Z)("div",{className:o()("toolbar-section",{"toolbar-section-auto":t},i)},void 0,s)},d=e=>{let{className:t}=e;return(0,a.Z)("div",{className:o()("toolbar-spacer",t)})}},9605:(e,t,s)=>{"use strict";s.d(t,{ZP:()=>o});var a=s(2928),i=(s(7294),s(2233));function o(e){const t=e.size||100,s=e.size2x||t;return(0,a.Z)("img",{alt:"",className:e.className||"user-avatar",src:n(e.user,t),srcSet:n(e.user,s),width:t,height:t})}function n(e,t){return e&&e.id?function(e,t){let s=e[0];return e.forEach((e=>{e.size>=t&&(s=e)})),s}(e.avatars,t).url:i.Z.get("BLANK_AVATAR_URL")}},2211:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});var a,i=s(2928),o=s(7294),n=s(7848);class r extends o.Component{render(){let e="btn "+this.props.className,t=this.props.disabled;return this.props.loading&&(e+=" btn-loading",t=!0),(0,i.Z)("button",{className:e,disabled:t,onClick:this.props.onClick,type:this.props.onClick?"button":"submit"},void 0,this.props.children,this.props.loading?a||(a=(0,i.Z)(n.Z,{})):null)}}r.defaultProps={className:"btn-default",type:"submit",loading:!1,disabled:!1,onClick:null}},7026:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});var a=s(2928);function i(e){return(0,a.Z)("select",{className:e.className||"form-control",disabled:e.disabled||!1,id:e.id||null,onChange:e.onChange,value:e.value},void 0,e.choices.map((e=>(0,a.Z)("option",{disabled:e.disabled||!1,value:e.value},e.value,"- - ".repeat(e.level)+e.label))))}s(7294)},5247:(e,t,s)=>{"use strict";s.d(t,{Z:()=>f});var a=s(2928),i=s(7294),o=s(3556);function n(e){let{display:t}=e;return t?(0,a.Z)(o.Z,{helpText:gettext("No profile details are editable at this time."),message:gettext("This option is currently unavailable.")}):null}var r,l=s(7848);function d(e){let{display:t}=e;return t?r||(r=(0,a.Z)("div",{className:"panel-body"},void 0,(0,a.Z)(l.Z,{}))):null}var c=s(471);const p=class extends i.Component{onChange=e=>{const{field:t,onChange:s}=this.props;s(t.fieldname,e.target.value)};render(){const{disabled:e,field:t,value:s}=this.props,{input:i}=t;return"select"===i.type?(0,a.Z)(c.Z,{choices:i.choices,disabled:e,id:"id_"+t.fieldname,onChange:this.onChange,value:s}):"textarea"===i.type?(0,a.Z)("textarea",{className:"form-control",disabled:e,id:"id_"+t.fieldname,onChange:this.onChange,rows:"4",type:"text",value:s}):"text"===i.type?(0,a.Z)("input",{className:"form-control",disabled:e,id:"id_"+t.fieldname,onChange:this.onChange,type:"text",value:s}):null}};var u=s(6359);function h(e){let{disabled:t,errors:s,fields:i,name:o,onChange:n,value:r}=e;return(0,a.Z)("fieldset",{},void 0,(0,a.Z)("legend",{},void 0,o),i.map((e=>(0,a.Z)(u.Z,{for:"id_"+e.fieldname,helpText:e.help_text,label:e.label,validation:s[e.fieldname]},e.fieldname,(0,a.Z)(p,{disabled:t,field:e,onChange:n,value:r[e.fieldname]})))))}var m=s(2211),v=s(3345),g=s(8657),Z=s(3904);const b=class extends v.Z{constructor(e){super(e),this.state={isLoading:!1,errors:{}};const t=e.groups.length;for(let s=0;s<t;s++){const t=e.groups[s],a=t.fields.length;for(let e=0;e<a;e++){const s=t.fields[e].fieldname,a=t.fields[e].initial;this.state[s]=a}}}send(){const e=Object.assign({},this.state,{errors:null,isLoading:null});return g.Z.post(this.props.api,e)}handleSuccess(e){this.props.onSuccess(e)}handleError(e){400===e.status?(Z.Z.error(gettext("Form contains errors.")),this.setState({errors:e})):Z.Z.apiError(e)}onChange=(e,t)=>{this.setState({[e]:t})};render(){return(0,a.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,a.Z)("div",{className:"panel-body"},void 0,this.props.groups.map(((e,t)=>(0,a.Z)(h,{disabled:this.state.isLoading,errors:this.state.errors,fields:e.fields,name:e.name,onChange:this.onChange,value:this.state},t)))),(0,a.Z)("div",{className:"panel-footer text-right"},void 0,(0,a.Z)(_,{disabled:this.state.isLoading,onCancel:this.props.onCancel})," ",(0,a.Z)(m.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,gettext("Save changes"))))}};function _(e){let{onCancel:t,disabled:s}=e;return t?(0,a.Z)("button",{className:"btn btn-default",disabled:s,onClick:t,type:"button"},void 0,gettext("Cancel")):null}const f=class extends i.Component{constructor(e){super(e),this.state={loading:!0,groups:null}}componentDidMount(){g.Z.get(this.props.api).then((e=>{this.setState({loading:!1,groups:e})}),(e=>{Z.Z.apiError(e),this.props.cancel&&this.props.cancel()}))}render(){const{groups:e,loading:t}=this.state;return(0,a.Z)("div",{className:"panel panel-default panel-form"},void 0,(0,a.Z)("div",{className:"panel-heading"},void 0,(0,a.Z)("h3",{className:"panel-title"},void 0,gettext("Edit details"))),(0,a.Z)(d,{display:t}),(0,a.Z)(n,{display:!t&&!e.length}),(0,a.Z)(N,{api:this.props.api,display:!t&&e.length,groups:e,onCancel:this.props.onCancel,onSuccess:this.props.onSuccess}))}};function N(e){let{api:t,display:s,groups:i,onCancel:o,onSuccess:n}=e;return s?(0,a.Z)(b,{api:t,groups:i,onCancel:o,onSuccess:n}):null}},6359:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var a=s(2928),i=s(7294);const o=class extends i.Component{isValidated(){return void 0!==this.props.validation}getClassName(){let e="form-group";return this.isValidated()&&(e+=" has-feedback",null===this.props.validation?e+=" has-success":e+=" has-error"),e}getFeedback(){return this.props.validation?(0,a.Z)("div",{className:"help-block errors"},void 0,this.props.validation.map(((e,t)=>(0,a.Z)("p",{},this.props.for+"FeedbackItem"+t,e)))):null}getFeedbackDescription(){return this.isValidated()?(0,a.Z)("span",{id:this.props.for+"_status",className:"sr-only"},void 0,this.props.validation?gettext("(error)"):gettext("(success)")):null}getHelpText(){return this.props.helpText?(0,a.Z)("p",{className:"help-block"},void 0,this.props.helpText):null}render(){return(0,a.Z)("div",{className:this.getClassName()},void 0,(0,a.Z)("label",{className:"control-label "+(this.props.labelClass||""),htmlFor:this.props.for||""},void 0,this.props.label+":"),(0,a.Z)("div",{className:this.props.controlClass||""},void 0,this.props.children,this.getFeedbackDescription(),this.getFeedback(),this.getHelpText(),this.props.extra||null))}}},3345:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});var a=s(7294),i=s(5210),o=s(3904);let n=(0,i.C1)();const r=class extends a.Component{validate(){let e={};if(!this.state.validators)return e;let t={required:this.state.validators.required||this.state.validators,optional:this.state.validators.optional||{}},s=[];for(let e in t.required)t.required.hasOwnProperty(e)&&t.required[e]&&s.push(e);for(let e in t.optional)t.optional.hasOwnProperty(e)&&t.optional[e]&&s.push(e);for(let t in s){let a=s[t],i=this.validateField(a,this.state[a]);null===i?e[a]=null:i&&(e[a]=i)}return e}isValid(){let e=this.validate();for(let t in e)if(e.hasOwnProperty(t)&&null!==e[t])return!1;return!0}validateField(e,t){let s=[];if(!this.state.validators)return s;let a={required:(this.state.validators.required||this.state.validators)[e],optional:(this.state.validators.optional||{})[e]},i=n(t)||!1;if(a.required){if(i)s=[i];else for(let e in a.required){let i=a.required[e](t);i&&s.push(i)}return s.length?s:null}if(!1===i&&a.optional){for(let e in a.optional){let i=a.optional[e](t);i&&s.push(i)}return s.length?s:null}return!1}bindInput=e=>t=>{this.changeValue(e,t.target.value)};changeValue=(e,t)=>{let s={[e]:t};const a=this.state.errors||{};a[e]=this.validateField(e,s[e]),s.errors=a,this.setState(s)};clean(){return!0}send(){return null}handleSuccess(e){}handleError(e){o.Z.apiError(e)}handleSubmit=e=>{if(e&&e.preventDefault(),!this.state.isLoading&&this.clean()){this.setState({isLoading:!0});let e=this.send();e?e.then((e=>{this.setState({isLoading:!1}),this.handleSuccess(e)}),(e=>{this.setState({isLoading:!1}),this.handleError(e)})):this.setState({isLoading:!1})}}}},4417:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var a=s(2928),i=s(7294);const o=class extends i.Component{isActive(){return this.props.isControlled?this.props.isActive:!!this.props.path&&0===document.location.pathname.indexOf(this.props.path)}getClassName(){return this.isActive()?(this.props.className||"")+" "+(this.props.activeClassName||"active"):this.props.className||""}render(){return(0,a.Z)("li",{className:this.getClassName()},void 0,this.props.children)}}},7848:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var a,i=s(2928);function o(e){return(0,i.Z)("div",{className:e.className||"loader"},void 0,a||(a=(0,i.Z)("div",{className:"loader-spinning-wheel"})))}s(7294)},2753:(e,t,s)=>{"use strict";s.d(t,{ZP:()=>c});var a,i=s(2928),o=(s(7294),s(2211)),n=s(3345),r=s(6359),l=s(8657),d=s(9801);const c=class extends n.Z{constructor(e){super(e),this.state={isLoading:!1,bestAnswer:"0",poll:"0"}}clean(){return!this.props.polls||"0"!==this.state.poll||window.confirm(gettext("Are you sure you want to delete all polls?"))}send(){const e=Object.assign({},this.props.data,{best_answer:this.state.bestAnswer,poll:this.state.poll});return l.Z.post(this.props.api,e)}handleSuccess=e=>{this.props.onSuccess(e),d.Z.hide()};handleError=e=>{this.props.onError(e)};onBestAnswerChange=e=>{this.changeValue("bestAnswer",e.target.value)};onPollChange=e=>{this.changeValue("poll",e.target.value)};render(){return(0,i.Z)("div",{className:"modal-dialog",role:"document"},void 0,(0,i.Z)("div",{className:"modal-content"},void 0,(0,i.Z)("div",{className:"modal-header"},void 0,(0,i.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,a||(a=(0,i.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,i.Z)("h4",{className:"modal-title"},void 0,gettext("Merge threads"))),(0,i.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,i.Z)("div",{className:"modal-body"},void 0,(0,i.Z)(p,{choices:this.props.bestAnswers,onChange:this.onBestAnswerChange,value:this.state.bestAnswer}),(0,i.Z)(u,{choices:this.props.polls,onChange:this.onPollChange,value:this.state.poll})),(0,i.Z)("div",{className:"modal-footer"},void 0,(0,i.Z)("button",{className:"btn btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,gettext("Cancel")),(0,i.Z)(o.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,gettext("Merge threads"))))))}};function p(e){let{choices:t,onChange:s,value:a}=e;return t?(0,i.Z)(r.Z,{label:gettext("Best answer"),helpText:gettext("Please select the best answer for your newly merged thread. No posts will be deleted during the merge."),for:"id_best_answer"},void 0,(0,i.Z)("select",{className:"form-control",id:"id_best_answer",onChange:s,value:a},void 0,t.map((e=>(0,i.Z)("option",{value:e[0]},e[0],e[1]))))):null}function u(e){let{choices:t,onChange:s,value:a}=e;return t?(0,i.Z)(r.Z,{label:gettext("Poll"),helpText:gettext("Please select the poll for your newly merged thread. Rejected polls will be permanently deleted and cannot be recovered."),for:"id_poll"},void 0,(0,i.Z)("select",{className:"form-control",id:"id_poll",onChange:s,value:a},void 0,t.map((e=>(0,i.Z)("option",{value:e[0]},e[0],e[1]))))):null}},9092:(e,t,s)=>{"use strict";s.d(t,{Z:()=>p});var a=s(4184),i=s.n(a),o=s(7294),n=s(9755);const r=new RegExp("^.*(?:(?:youtu.be/|v/|vi/|u/w/|embed/)|(?:(?:watch)??v(?:i)?=|&v(?:i)?=))([^#&?]*).*"),l=new class{constructor(){this._youtube={}}render=e=>{e&&(this.highlightCode(e),this.embedYoutubePlayers(e))};highlightCode(e){s.e(417).then(s.bind(s,5739)).then((t=>{let{default:s}=t;const a=e.querySelectorAll("pre>code");for(let e=0;e<a.length;e++)s.highlightElement(a[e])}))}embedYoutubePlayers(e){const t=e.querySelectorAll("p>a");for(let e=0;e<t.length;e++){const s=t[e],a=1===s.parentNode.childNodes.length;this._youtube[s.href]||(this._youtube[s.href]=d(s.href));const i=this._youtube[s.href];a&&i&&!1!==i.data&&this.swapYoutubePlayer(s,i)}}swapYoutubePlayer(e,t){let s="https://www.youtube.com/embed/";s+=t.video,s+="?feature=oembed",t.start&&(s+="&start="+t.start);const a=n('<iframe class="embed-responsive-item" frameborder="0" src="'+s+'" allow="encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>');n(e).replaceWith(a),a.wrap('<div class="embed-responsive embed-responsive-16by9"></div>')}};function d(e){const t=function(e){let t=e;return"https://"===e.substr(0,8)?t=t.substr(8):"http://"===e.substr(0,7)&&(t=t.substr(7)),"www."===t.substr(0,4)&&(t=t.substr(4)),t}(e),s=function(e){if(-1===e.indexOf("youtu"))return null;const t=e.match(r);return t?t[1]:null}(t);if(!s)return null;let a=0;if(t.indexOf("?")>0){const e=t.substr(t.indexOf("?")+1).split("&").filter((e=>"t="===e.substr(0,2)))[0];if(e){const t=e.substr(2).split("m");"s"===t[0].substr(-1)?a+=parseInt(t[0].substr(0,t[0].length-1)):(a+=60*parseInt(t[0]),t[1]&&"s"===t[1].substr(-1)&&(a+=parseInt(t[1].substr(0,t[1].length-1))))}}return{start:a,video:s}}var c=s(9755);const p=class extends o.Component{componentDidMount(){l.render(this.documentNode),c(this.documentNode).find(".spoiler-reveal").click(u)}componentDidUpdate(e,t){l.render(this.documentNode),c(this.documentNode).find(".spoiler-reveal").click(u)}shouldComponentUpdate(e,t){return e.markup!==this.props.markup}render(){return o.createElement("article",{className:i()("misago-markup",this.props.className),dangerouslySetInnerHTML:{__html:this.props.markup},"data-author":this.props.author||void 0,ref:e=>{this.documentNode=e}})}};function u(e){var t=e.target;c(t).parent().parent().addClass("revealed")}},3784:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});var a,i=s(2928),o=s(7294),n=s(7848);const r=class extends o.Component{render(){return a||(a=(0,i.Z)("div",{className:"modal-body modal-loader"},void 0,(0,i.Z)(n.Z,{})))}}},337:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var a=s(2928),i=(s(7294),s(3556));const o=class extends i.Z{getHelpText(){return this.props.helpText?(0,a.Z)("p",{className:"help-block"},void 0,this.props.helpText):null}render(){return(0,a.Z)("div",{className:"modal-body"},void 0,(0,a.Z)("div",{className:"message-icon"},void 0,(0,a.Z)("span",{className:"material-icon"},void 0,this.props.icon||"info_outline")),(0,a.Z)("div",{className:"message-body"},void 0,(0,a.Z)("p",{className:"lead"},void 0,this.props.message),this.getHelpText(),(0,a.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,gettext("Ok"))))}}},5187:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});var a,i=s(2928),o=s(7294),n=s(7848);const r=class extends o.Component{render(){return a||(a=(0,i.Z)("div",{className:"panel-body panel-body-loading"},void 0,(0,i.Z)(n.Z,{className:"loader loader-spaced"})))}}},3556:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var a=s(2928),i=s(7294);const o=class extends i.Component{getHelpText(){return this.props.helpText?(0,a.Z)("p",{className:"help-block"},void 0,this.props.helpText):null}render(){return(0,a.Z)("div",{className:"panel-body panel-message-body"},void 0,(0,a.Z)("div",{className:"message-icon"},void 0,(0,a.Z)("span",{className:"material-icon"},void 0,this.props.icon||"info_outline")),(0,a.Z)("div",{className:"message-body"},void 0,(0,a.Z)("p",{className:"lead"},void 0,this.props.message),this.getHelpText()))}}},1005:(e,t,s)=>{"use strict";s.d(t,{Z:()=>y});var a=s(2928),i=s(7294),o=s(9092);function n(e){return e.post.content?i.createElement(r,e):i.createElement(l,e)}function r(e){return(0,a.Z)("div",{className:"post-body"},void 0,(0,a.Z)(o.Z,{markup:e.post.content}))}function l(e){return(0,a.Z)("div",{className:"post-body post-body-invalid"},void 0,(0,a.Z)("p",{className:"lead"},void 0,gettext("This post's contents cannot be displayed.")),(0,a.Z)("p",{className:"text-muted"},void 0,gettext("This error is caused by invalid post content manipulation.")))}function d(e){let{post:t}=e;const{category:s,thread:i}=t,o=interpolate(gettext("posted %(posted_on)s"),{posted_on:t.posted_on.format("LL, LT")},!0);return(0,a.Z)("div",{className:"post-heading"},void 0,(0,a.Z)("a",{className:"btn btn-link item-title",href:i.url},void 0,i.title),(0,a.Z)("a",{className:"btn btn-link post-category",href:s.url.index},void 0,s.name),(0,a.Z)("a",{href:t.url.index,className:"btn btn-link posted-on",title:o},void 0,t.posted_on.fromNow()))}var c,p,u=s(9605);function h(e){let{post:t}=e;return(0,a.Z)("a",{className:"btn btn-default btn-icon pull-right",href:t.url.index},void 0,(0,a.Z)("span",{className:"btn-text-left hidden-xs"},void 0,gettext("See post")),c||(c=(0,a.Z)("span",{className:"material-icon"},void 0,"chevron_right")))}function m(e){let{post:t}=e;return(0,a.Z)("div",{className:"post-side post-side-anonymous"},void 0,(0,a.Z)(h,{post:t}),(0,a.Z)("div",{className:"media"},void 0,p||(p=(0,a.Z)("div",{className:"media-left"},void 0,(0,a.Z)("span",{},void 0,(0,a.Z)(u.ZP,{className:"poster-avatar",size:50})))),(0,a.Z)("div",{className:"media-body"},void 0,(0,a.Z)("div",{className:"media-heading"},void 0,(0,a.Z)("span",{className:"item-title"},void 0,t.poster_name)),(0,a.Z)("span",{className:"user-title user-title-anonymous"},void 0,gettext("Removed user")))))}function v(e){let{rank:t,title:s}=e,i=s||t.title||t.name,o="user-title";return t.css_class&&(o+=" user-title-"+t.css_class),t.is_tab?(0,a.Z)("a",{className:o,href:t.url},void 0,i):(0,a.Z)("span",{className:o},void 0,i)}function g(e){let{post:t,poster:s}=e;return(0,a.Z)("div",{className:"post-side post-side-registered"},void 0,(0,a.Z)(h,{post:t}),(0,a.Z)("div",{className:"media"},void 0,(0,a.Z)("div",{className:"media-left"},void 0,(0,a.Z)("a",{href:s.url},void 0,(0,a.Z)(u.ZP,{className:"poster-avatar",size:50,user:s}))),(0,a.Z)("div",{className:"media-body"},void 0,(0,a.Z)("div",{className:"media-heading"},void 0,(0,a.Z)("a",{className:"item-title",href:s.url},void 0,s.username)),(0,a.Z)(v,{title:s.title,rank:s.rank}))))}function Z(e){let{post:t,poster:s}=e;return s&&s.id?(0,a.Z)(g,{post:t,poster:s}):(0,a.Z)(m,{post:t})}function b(e){let{post:t,poster:s}=e;const i=s||t.poster;let o="post";return i&&i.rank.css_class&&(o+=" post-"+i.rank.css_class),(0,a.Z)("li",{className:o,id:"post-"+t.id},void 0,(0,a.Z)("div",{className:"panel panel-default panel-post"},void 0,(0,a.Z)("div",{className:"panel-body"},void 0,(0,a.Z)("div",{className:"panel-content"},void 0,(0,a.Z)(Z,{post:t,poster:i}),(0,a.Z)(d,{post:t}),(0,a.Z)(n,{post:t})))))}var _,f,N=s(4039);function x(){return(0,a.Z)("ul",{className:"posts-list post-feed ui-preview"},void 0,(0,a.Z)("li",{className:"post"},void 0,(0,a.Z)("div",{className:"panel panel-default panel-post"},void 0,(0,a.Z)("div",{className:"panel-body"},void 0,(0,a.Z)("div",{className:"panel-content"},void 0,(0,a.Z)("div",{className:"post-side post-side-anonymous"},void 0,(0,a.Z)("div",{className:"media"},void 0,_||(_=(0,a.Z)("div",{className:"media-left"},void 0,(0,a.Z)("span",{},void 0,(0,a.Z)(u.ZP,{className:"poster-avatar",size:50})))),(0,a.Z)("div",{className:"media-body"},void 0,(0,a.Z)("div",{className:"media-heading"},void 0,(0,a.Z)("span",{className:"item-title"},void 0,(0,a.Z)("span",{className:"ui-preview-text",style:{width:N.e(30,200)+"px"}},void 0," "))),(0,a.Z)("span",{className:"user-title user-title-anonymous"},void 0,(0,a.Z)("span",{className:"ui-preview-text",style:{width:N.e(30,200)+"px"}},void 0," "))))),(0,a.Z)("div",{className:"post-heading"},void 0,(0,a.Z)("span",{className:"ui-preview-text",style:{width:N.e(30,200)+"px"}},void 0," ")),(0,a.Z)("div",{className:"post-body"},void 0,(0,a.Z)("article",{className:"misago-markup"},void 0,(0,a.Z)("p",{},void 0,(0,a.Z)("span",{className:"ui-preview-text",style:{width:N.e(30,200)+"px"}},void 0," ")," ",(0,a.Z)("span",{className:"ui-preview-text",style:{width:N.e(30,200)+"px"}},void 0," ")," ",(0,a.Z)("span",{className:"ui-preview-text",style:{width:N.e(30,200)+"px"}},void 0," ")))))))))}function y(e){let{isReady:t,posts:s,poster:i}=e;return t?(0,a.Z)("ul",{className:"posts-list post-feed ui-ready"},void 0,s.map((e=>(0,a.Z)(b,{post:e,poster:i},e.id)))):f||(f=(0,a.Z)(x,{}))}},661:(e,t,s)=>{"use strict";s.d(t,{mv:()=>r,ZP:()=>ns,MO:()=>w,Fi:()=>h});var a,i=s(7294),o=s(2928),n=s(4646);class r extends i.Component{constructor(e){super(e),this.state={range:null,rect:null},this.element=null}selected=()=>{if(this.element){const e=d(this.element)||null,t=e?e.getBoundingClientRect():null;this.setState({range:e,rect:t})}};reply=()=>{if(n.Z.isOpen()){const e=w();e&&!e.disabled&&(e.quote(h(this.state.range)),this.setState({range:null,rect:null}),l())}else{const e=h(this.state.range);n.Z.open(Object.assign({},this.props.posting,{default:e})),this.setState({range:null,rect:null}),window.setTimeout(l,1e3)}};render=()=>(0,o.Z)("div",{},void 0,i.createElement("div",{ref:e=>{e&&(this.element=e)},onMouseUp:this.selected,onTouchEnd:this.selected},this.props.children),!!this.state.rect&&(0,o.Z)("div",{className:"quote-control",style:{position:"absolute",left:this.state.rect.left+window.scrollX,top:this.state.rect.bottom+window.scrollY}},void 0,a||(a=(0,o.Z)("div",{className:"quote-control-arrow"})),(0,o.Z)("div",{className:"quote-control-inner"},void 0,(0,o.Z)("button",{className:"btn quote-control-btn",type:"button",onClick:this.reply},void 0,pgettext("post reply","Quote")))))}function l(){const e=document.querySelector("#posting-mount textarea");e.focus(),e.selectionStart=e.selectionEnd=e.value.length}const d=e=>{if(void 0===window.getSelection)return;const t=window.getSelection();if(!t)return;if("Range"!==t.type)return;if(1!==t.rangeCount)return;const s=t.getRangeAt(0);return c(s,e)&&p(s)&&u(s.cloneContents())?s:void 0},c=(e,t)=>{const s=e.commonAncestorContainer;if(s===t)return!0;let a=s.parentNode;for(;a;){if(a===t)return!0;a=a.parentNode}return!1},p=e=>{const t=e.commonAncestorContainer;if("ARTICLE"===t.nodeName)return!0;if(t.dataset&&"1"===t.dataset.noquote)return!1;let s=t.parentNode;for(;s;){if(s.dataset&&"1"===s.dataset.noquote)return!1;if("ARTICLE"===s.nodeName)return!0;s=s.parentNode}return!1},u=e=>{for(let t=0;t<e.childNodes.length;t++){const s=e.childNodes[t];if(s.nodeType===Node.TEXT_NODE&&s.textContent&&s.textContent.trim().length>0)return!0;if("IMG"===s.nodeName)return!0;if(u(s))return!0}return!1},h=e=>{const t=m(e);let s=N(e.cloneContents().childNodes,[]),a=t?`[quote="${t}"]\n`:"[quote]\n",i="\n[/quote]\n\n";const o=Z(e);return o?(a+=o.syntax?`[code=${o.syntax}]\n`:"[code]\n",i="\n[/code]"+i):_(e)?(s=s.trim(),a+="`",i="`"+i):s=s.trim(),a+s+i},m=e=>{const t=e.commonAncestorContainer;if(v(t))return g(t);let s=t.parentNode;for(;s;){if(v(s))return g(s);s=s.parentNode}return""},v=e=>e.nodeType===Node.ELEMENT_NODE&&("ARTICLE"===e.nodeName||"BLOCKQUOTE"===e.nodeName&&e.dataset&&"quote"===e.dataset.block),g=e=>e.dataset&&e.dataset.author||null,Z=e=>{const t=e.commonAncestorContainer;if(b(t))return f(t);let s=t.parentNode;for(;s;){if(b(s))return f(s);s=s.parentNode}return null},b=e=>"PRE"===e.nodeName,_=e=>{const t=e.commonAncestorContainer;if("CODE"===t.nodeName)return!0;let s=t.parentNode;for(;s;){if(v(s))return!1;if("CODE"===s.nodeName)return!0;s=s.parentNode}return!1},f=e=>e.dataset?{syntax:e.dataset.syntax||null}:{syntax:null},N=(e,t)=>{let s="";for(let a=0;a<e.length;a++){const i=e[a];s+=y(i,t)}return s},x={H1:["\n\n# ",""],H2:["\n\n## ",""],H3:["\n\n### ",""],H4:["\n\n#### ",""],H5:["\n\n##### ",""],H6:["\n\n###### ",""],STRONG:["**","**"],EM:["*","*"],DEL:["~~","~~"],B:["[b]","[/b]"],U:["[u]","[/u]"],I:["[i]","[/i]"],SUB:["[sub]","[/sub]"],SUP:["[sup]","[/sup]"]},y=(e,t)=>{const s=e.dataset||{};if(e.nodeType===Node.TEXT_NODE)return e.textContent||"";if(e.nodeType===Node.ELEMENT_NODE){if(s.quote)return s.quote||"";if("1"===s.noquote)return""}if(e.nodeType===Node.ELEMENT_NODE&&s.quote&&s.quote.trim())return"";if("HR"===e.nodeName)return"\n\n- - -";if(x[e.nodeName]){const[s,a]=x[e.nodeName];return s+N(e.childNodes,[...t,e.nodeName])+a}if("A"===e.nodeName){const s=e.href,a=N(e.childNodes,[...t,e.nodeName]);return a?`[${a}](${s})`:`!(${s})`}if("IMG"===e.nodeName){const t=e.src,s=e.alt;return s?`![${s}](${t})`:`!(${t})`}if("DIV"===e.nodeName||"ASIDE"===e.nodeName){const a=s.block&&s.block.toUpperCase();if(a&&x[a]){const[s,i]=x[a];return s+N(e.childNodes,[...t,a])+i}return N(e.childNodes,t)}if("BLOCKQUOTE"===e.nodeName){if("spoiler"===s.block){const s=N(e.childNodes,[...t,"SPOILER"]).trim();if(!s)return"";let a="\n[spoiler]\n";return a+=s,a+="\n[/spoiler]",a}const a=N(e.childNodes,[...t,"QUOTE"]).trim();if(!a)return"";const i=g(e);let o=i?`\n[quote=${i}]\n`:"\n\n[quote]\n";return o+=a,o+="\n[/quote]",o}if("PRE"===e.nodeName){const t=s.syntax||null,a=e.querySelector("code"),i=a&&a.innerText||"";return i.trim()?"\n[code"+(t?"="+t:"")+"]"+i+"[/code]":""}if("CODE"===e.nodeName)return"`"+e.innerText+"`";if("P"===e.nodeName)return"\n"+N(e.childNodes,[...t,e.nodeName]);if("UL"===e.nodeName||"OL"===e.nodeName)return(0===t.filter((e=>"OL"===e||"UL"===e)).length?"\n":"")+N(e.childNodes,[...t,e.nodeName]);if("LI"===e.nodeName){let a="";const i=t.filter((e=>"OL"===e||"UL"===e)).length;for(let e=1;e<i;e++)a+="    ";a+="OL"===t[t.length-1]?s.index?s.index+". ":"1. ":"- ";const o=N(e.childNodes,[...t,e.nodeName]);return o.trim()?"\n"+a+o:""}return"SPAN"===e.nodeName?N(e.childNodes,t):""};function w(){return window.misagoReply}function k(e,t){window.misagoReply={disabled:e,quote:t}}function C(){window.misagoReply=null}var S=s(7026),E=s(3345),L=s(381),T=s.n(L);function P(e){return e.filter((e=>e.id&&!e.isRemoved)).map((e=>e.id))}var O,R=s(2891),A=s(8657),I=s(3904),D=s(4184),j=s.n(D),z=s(2233),U=s(9092),M=s(9801),B=s(8772);function q(e){let{attachment:t}=e;return(0,o.Z)("div",{className:"modal-dialog modal-lg",role:"document"},void 0,(0,o.Z)("div",{className:"modal-content"},void 0,(0,o.Z)("div",{className:"modal-header"},void 0,(0,o.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,O||(O=(0,o.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,o.Z)("h4",{className:"modal-title"},void 0,pgettext("markup editor","Attachment details"))),(0,o.Z)("div",{className:"modal-body"},void 0,!!t.is_image&&(0,o.Z)("div",{className:"markup-editor-attachment-modal-preview"},void 0,(0,o.Z)("a",{href:t.url.index+"?shva=1",target:"_blank"},void 0,(0,o.Z)("img",{src:t.url.index+"?shva=1",alt:""}))),(0,o.Z)("div",{className:"markup-editor-attachment-modal-filename"},void 0,t.filename),(0,o.Z)("div",{className:"row markup-editor-attachment-modal-details"},void 0,(0,o.Z)("div",{className:"col-xs-12 col-md-3"},void 0,(0,o.Z)("strong",{},void 0,t.filetype+", "+(0,B.Z)(t.size)),(0,o.Z)("div",{className:"text-muted"},void 0,(0,o.Z)("small",{},void 0,pgettext("markup editor","Type and size")))),(0,o.Z)("div",{className:"col-xs-12 col-md-4"},void 0,(0,o.Z)("strong",{},void 0,(0,o.Z)("abbr",{title:t.uploaded_on.format("LLL")},void 0,t.uploaded_on.fromNow())),(0,o.Z)("div",{className:"text-muted"},void 0,(0,o.Z)("small",{},void 0,pgettext("markup editor","Uploaded at")))),(0,o.Z)("div",{className:"col-xs-12 col-md-3"},void 0,t.url.uploader?(0,o.Z)("a",{href:t.url.uploader,target:"_blank",className:"item-title"},void 0,t.uploader_name):(0,o.Z)("span",{className:"item-title"},void 0,t.uploader_name),(0,o.Z)("div",{className:"text-muted"},void 0,(0,o.Z)("small",{},void 0,pgettext("markup editor","Uploader")))))),(0,o.Z)("div",{className:"modal-footer"},void 0,(0,o.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,pgettext("modal","Close")))))}const H=(e,t,s,a,i)=>{const o=e.text||i||"";let n=e.prefix;n+=s+o+a,n+=e.suffix,t(n),window.setTimeout((()=>{G(e.textarea);const t=e.start+s.length;e.textarea.setSelectionRange(t,t+o.length)}),250)},F=(e,t,s)=>{let a=e.prefix;a+=s,a+=e.suffix,t(a),window.setTimeout((()=>{G(e.textarea);const t=e.end+s.length;e.textarea.setSelectionRange(t,t)}),250)},Y=e=>{if(document.selection){e.focus();const t=document.selection.createRange(),s=t.text.length;return t.moveStart("character",-e.value.length),V(e,t.text.length-s,t.text.length)}if(e.selectionStart||"0"==e.selectionStart)return V(e,e.selectionStart,e.selectionEnd)},V=(e,t,s)=>({textarea:e,start:t,end:s,text:e.value.substring(t,s),prefix:e.value.substring(0,t),suffix:e.value.substring(s)});function G(e){const t=e.scrollTop;e.focus(),e.scrollTop=t}var $,W,Q,K;const J=e=>{var t;let{attachment:s,disabled:a,element:i,setState:n,update:r}=e;return(0,o.Z)("div",{className:"markup-editor-attachments-item"},void 0,(0,o.Z)("div",{className:"markup-editor-attachment"},void 0,(0,o.Z)("div",{className:"markup-editor-attachment-details"},void 0,s.id?(0,o.Z)("a",{className:"item-title",href:s.url.index+"?shva=1",target:"_blank",onClick:e=>{e.preventDefault(),M.Z.show(t||(t=(0,o.Z)(q,{attachment:s})))}},void 0,s.filename):(0,o.Z)("strong",{className:"item-title"},void 0,s.filename),(0,o.Z)("div",{className:"text-muted"},void 0,(0,o.Z)("ul",{className:"list-unstyled list-inline"},void 0,!s.id&&(0,o.Z)("li",{},void 0,s.progress+"%"),!!s.filetype&&(0,o.Z)("li",{},void 0,s.filetype),s.size>0&&(0,o.Z)("li",{},void 0,(0,B.Z)(s.size))))),!!s.id&&(0,o.Z)("div",{className:"markup-editor-attachment-buttons"},void 0,(0,o.Z)("button",{className:"btn btn-markup-editor-attachment btn-icon",title:pgettext("markup editor","Insert into message"),type:"button",disabled:a,onClick:()=>{const e=function(e){let t="[";return e.is_image?(t+="!["+e.filename+"]",t+="("+(e.url.thumb||e.url.index)+"?shva=1)"):t+=e.filename,t+="]("+e.url.index+"?shva=1)",t}(s),t=Y(i);F(t,r,e)}},void 0,$||($=(0,o.Z)("span",{className:"material-icon"},void 0,"flip_to_front"))),(0,o.Z)("button",{className:"btn btn-markup-editor-attachment btn-icon",title:pgettext("markup editor","Remove attachment"),type:"button",disabled:a,onClick:()=>{n((e=>{let{attachments:t}=e;if(window.confirm(pgettext("markup editor","Remove this attachment?")))return{attachments:t.filter((e=>{let{id:t}=e;return t!==s.id}))}}))}},void 0,W||(W=(0,o.Z)("span",{className:"material-icon"},void 0,"close")))),!s.id&&!!s.key&&(0,o.Z)("div",{className:"markup-editor-attachment-buttons"},void 0,s.error&&(0,o.Z)("button",{className:"btn btn-markup-editor-attachment btn-icon",title:pgettext("markup editor","See error"),type:"button",onClick:()=>{I.Z.error(interpolate(pgettext("markup editor","%(filename)s: %(error)s"),{filename:s.filename,error:s.error},!0))}},void 0,Q||(Q=(0,o.Z)("span",{className:"material-icon"},void 0,"warning"))),(0,o.Z)("button",{className:"btn btn-markup-editor-attachment btn-icon",title:pgettext("markup editor","Remove attachment"),type:"button",disabled:a,onClick:()=>{n((e=>{let{attachments:t}=e;return{attachments:t.filter((e=>{let{key:t}=e;return t!==s.key}))}}))}},void 0,K||(K=(0,o.Z)("span",{className:"material-icon"},void 0,"close"))))))},X=e=>{let{attachments:t,disabled:s,element:a,setState:i,update:n}=e;return(0,o.Z)("div",{className:"markup-editor-attachments"},void 0,(0,o.Z)("div",{className:"markup-editor-attachments-container"},void 0,t.map((e=>(0,o.Z)(J,{attachment:e,disabled:s,element:a,setState:i,update:n},e.key||e.id)))))};var ee,te=s(2211);const se=e=>{let{canProtect:t,disabled:s,empty:a,preview:i,isProtected:n,submitText:r,showPreview:l,closePreview:d,enableProtection:c,disableProtection:p}=e;return(0,o.Z)("div",{className:"markup-editor-footer"},void 0,!!t&&(0,o.Z)(te.Z,{className:"btn-default btn-icon hidden-sm hidden-md hidden-lg",title:n?pgettext("markup editor","Protected"):pgettext("markup editor","Protect"),type:"button",disabled:s,onClick:()=>{n?p():c()}},void 0,(0,o.Z)("span",{className:"material-icon"},void 0,n?"lock":"lock_open")),!!t&&(0,o.Z)("div",{},void 0,(0,o.Z)(te.Z,{className:"btn-default hidden-xs",type:"button",disabled:s,onClick:()=>{n?p():c()}},void 0,(0,o.Z)("span",{className:"material-icon"},void 0,n?"lock":"lock_open"),n?pgettext("markup editor","Protected"):pgettext("markup editor","Protect"))),ee||(ee=(0,o.Z)("div",{className:"markup-editor-spacer"})),i?(0,o.Z)(te.Z,{className:"btn-default btn-auto",type:"button",onClick:d},void 0,pgettext("markup editor","Edit")):(0,o.Z)(te.Z,{className:"btn-default btn-auto",disabled:s||a,type:"button",onClick:l},void 0,pgettext("markup editor","Preview")),(0,o.Z)(te.Z,{className:"btn-primary btn-auto",disabled:s||a},void 0,r||gettext("Post")))};var ae,ie=s(6359);class oe extends i.Component{constructor(e){super(e),this.state={error:null,syntax:"",text:e.selection.text}}handleSubmit=e=>{e.preventDefault();const{selection:t,update:s}=this.props,a=this.state.syntax.trim(),i=this.state.text.trim();if(0===i.length)return this.setState({error:gettext("This field is required.")}),!1;const o=t.prefix.trim().length?"\n\n":"";return F(Object.assign({},t,{text:i}),s,o+"```"+a+"\n"+i+"\n```\n\n"),M.Z.hide(),!1};render(){return(0,o.Z)("div",{className:"modal-dialog modal-lg",role:"document"},void 0,(0,o.Z)("div",{className:"modal-content"},void 0,(0,o.Z)("div",{className:"modal-header"},void 0,(0,o.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,ae||(ae=(0,o.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,o.Z)("h4",{className:"modal-title"},void 0,pgettext("markup editor","Code"))),(0,o.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,o.Z)("div",{className:"modal-body"},void 0,(0,o.Z)(ie.Z,{for:"markup_code_syntax",label:pgettext("markup editor","Syntax highlighting")},void 0,(0,o.Z)("select",{id:"markup_code_syntax",className:"form-control",value:this.state.syntax,onChange:e=>this.setState({syntax:e.target.value})},void 0,(0,o.Z)("option",{value:""},void 0,pgettext("markup editor","No syntax highlighting")),ne.map((e=>{let{value:t,name:s}=e;return(0,o.Z)("option",{value:t},t,s)})))),(0,o.Z)(ie.Z,{for:"markup_code_text",label:pgettext("markup editor","Code to insert"),validation:this.state.error?[this.state.error]:void 0},void 0,(0,o.Z)("textarea",{id:"markup_code_text",className:"form-control",rows:"8",value:this.state.text,onChange:e=>this.setState({text:e.target.value})}))),(0,o.Z)("div",{className:"modal-footer"},void 0,(0,o.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,gettext("Cancel")),(0,o.Z)("button",{className:"btn btn-primary"},void 0,pgettext("markup editor","Insert code"))))))}}const ne=[{value:"bash",name:"Bash"},{value:"c",name:"C"},{value:"c#",name:"C#"},{value:"c++",name:"C++"},{value:"css",name:"CSS"},{value:"diff",name:"Diff"},{value:"go",name:"Go"},{value:"graphql",name:"GraphQL"},{value:"html,",name:"HTML"},{value:"xml",name:"XML"},{value:"json",name:"JSON"},{value:"java",name:"Java"},{value:"javascript",name:"JavaScript"},{value:"kotlin",name:"Kotlin"},{value:"less",name:"Less"},{value:"lua",name:"Lua"},{value:"makefile",name:"Makefile"},{value:"markdown",name:"Markdown"},{value:"objective-C",name:"Objective-C"},{value:"php",name:"PHP"},{value:"perl",name:"Perl"},{value:"plain",name:"Plain"},{value:"text",name:"text"},{value:"python",name:"Python"},{value:"repl",name:"REPL"},{value:"r",name:"R"},{value:"ruby",name:"Ruby"},{value:"rust",name:"Rust"},{value:"scss",name:"SCSS"},{value:"sql",name:"SQL"},{value:"shell",name:"Shell Session"},{value:"swift",name:"Swift"},{value:"toml",name:"TOML"},{value:"ini",name:"INI"},{value:"typescript",name:"TypeScript"},{value:"visualbasic",name:"Visual Basic .NET"},{value:"webassembly",name:"WebAssembly"},{value:"yaml",name:"YAML"}],re=oe;var le,de,ce,pe,ue,he,me,ve,ge,Ze,be,_e,fe,Ne,xe,ye,we,ke,Ce,Se,Ee,Le,Te,Pe,Oe,Re,Ae,Ie,De,je,ze,Ue,Me,Be,qe,He,Fe,Ye,Ve,Ge,$e,We,Qe,Ke,Je;function Xe(){return(0,o.Z)("div",{className:"modal-dialog modal-lg",role:"document"},void 0,(0,o.Z)("div",{className:"modal-content"},void 0,(0,o.Z)("div",{className:"modal-header"},void 0,(0,o.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,le||(le=(0,o.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,o.Z)("h4",{className:"modal-title"},void 0,pgettext("markup help","Formatting help"))),(0,o.Z)("div",{className:"modal-body formatting-help"},void 0,(0,o.Z)("h4",{},void 0,pgettext("markup help","Emphasis text")),(0,o.Z)(et,{markup:pgettext("markup help","_This text will have emphasis_"),result:(0,o.Z)("p",{},void 0,(0,o.Z)("em",{},void 0,pgettext("markup help","This text will have emphasis")))}),de||(de=(0,o.Z)("hr",{})),(0,o.Z)("h4",{},void 0,pgettext("markup help","Bold text")),(0,o.Z)(et,{markup:pgettext("markup help","**This text will be bold**"),result:(0,o.Z)("p",{},void 0,(0,o.Z)("strong",{},void 0,pgettext("markup help","This text will be bold")))}),ce||(ce=(0,o.Z)("hr",{})),(0,o.Z)("h4",{},void 0,pgettext("markup help","Removed text")),(0,o.Z)(et,{markup:pgettext("markup help","~~This text will be removed~~"),result:(0,o.Z)("p",{},void 0,(0,o.Z)("del",{},void 0,pgettext("markup help","This text will be removed")))}),pe||(pe=(0,o.Z)("hr",{})),(0,o.Z)("h4",{},void 0,pgettext("markup help","Bold text (BBCode)")),(0,o.Z)(et,{markup:pgettext("markup help","[b]This text will be bold[/b]"),result:(0,o.Z)("p",{},void 0,(0,o.Z)("b",{},void 0,pgettext("markup help","This text will be bold")))}),ue||(ue=(0,o.Z)("hr",{})),(0,o.Z)("h4",{},void 0,pgettext("markup help","Underlined text (BBCode)")),(0,o.Z)(et,{markup:pgettext("markup help","[u]This text will be underlined[/u]"),result:(0,o.Z)("p",{},void 0,(0,o.Z)("u",{},void 0,pgettext("markup help","This text will be underlined")))}),he||(he=(0,o.Z)("hr",{})),(0,o.Z)("h4",{},void 0,pgettext("markup help","Italics text (BBCode)")),(0,o.Z)(et,{markup:pgettext("markup help","[i]This text will be in italics[/i]"),result:(0,o.Z)("p",{},void 0,(0,o.Z)("i",{},void 0,pgettext("markup help","This text will be in italics")))}),me||(me=(0,o.Z)("hr",{})),(0,o.Z)("h4",{},void 0,pgettext("markup help","Link")),ve||(ve=(0,o.Z)(et,{markup:"<http://example.com>",result:(0,o.Z)("p",{},void 0,(0,o.Z)("a",{href:"#"},void 0,"example.com"))})),ge||(ge=(0,o.Z)("hr",{})),(0,o.Z)("h4",{},void 0,pgettext("markup help","Link with text")),(0,o.Z)(et,{markup:"["+pgettext("markup help","Link text")+"](http://example.com)",result:(0,o.Z)("p",{},void 0,(0,o.Z)("a",{href:"#"},void 0,pgettext("markup help","Link text")))}),Ze||(Ze=(0,o.Z)("hr",{})),(0,o.Z)("h4",{},void 0,pgettext("markup help","Link (BBCode)")),be||(be=(0,o.Z)(et,{markup:"[url]http://example.com[/url]",result:(0,o.Z)("p",{},void 0,(0,o.Z)("a",{href:"#"},void 0,"example.com"))})),_e||(_e=(0,o.Z)("hr",{})),(0,o.Z)("h4",{},void 0,pgettext("markup help","Link with text (BBCode)")),(0,o.Z)(et,{markup:"[url=http://example.com]"+pgettext("markup help","Link text")+"[/url]",result:(0,o.Z)("p",{},void 0,(0,o.Z)("a",{href:"#"},void 0,pgettext("markup help","Link text")))}),fe||(fe=(0,o.Z)("hr",{})),(0,o.Z)("h4",{},void 0,pgettext("markup help","Image")),Ne||(Ne=(0,o.Z)(et,{markup:"!(http://placekitten.com/38/38)",result:(0,o.Z)("p",{},void 0,(0,o.Z)("img",{alt:"",src:"http://placekitten.com/38/38"}))})),xe||(xe=(0,o.Z)("hr",{})),(0,o.Z)("h4",{},void 0,pgettext("markup help","Image with alternate text")),(0,o.Z)(et,{markup:"!["+pgettext("markup help","Image text")+"](http://placekitten.com/38/38)",result:(0,o.Z)("p",{},void 0,(0,o.Z)("img",{alt:pgettext("markup help","Image text"),src:"http://placekitten.com/38/38"}))}),ye||(ye=(0,o.Z)("hr",{})),(0,o.Z)("h4",{},void 0,pgettext("markup help","Image (BBCode)")),we||(we=(0,o.Z)(et,{markup:"[img]http://placekitten.com/38/38[/img]",result:(0,o.Z)("p",{},void 0,(0,o.Z)("img",{alt:"",src:"http://placekitten.com/38/38"}))})),ke||(ke=(0,o.Z)("hr",{})),(0,o.Z)("h4",{},void 0,pgettext("markup help","Mention user by their name")),Ce||(Ce=(0,o.Z)(et,{markup:"@username",result:(0,o.Z)("p",{},void 0,(0,o.Z)("a",{href:"#"},void 0,"@username"))})),Se||(Se=(0,o.Z)("hr",{})),(0,o.Z)("h4",{},void 0,pgettext("markup help","Heading 1")),(0,o.Z)(et,{markup:pgettext("markup help","# First level heading"),result:(0,o.Z)("h1",{},void 0,pgettext("markup help","First level heading"))}),Ee||(Ee=(0,o.Z)("hr",{})),(0,o.Z)("h4",{},void 0,pgettext("markup help","Heading 2")),(0,o.Z)(et,{markup:pgettext("markup help","## Second level heading"),result:(0,o.Z)("h2",{},void 0,pgettext("markup help","Second level heading"))}),Le||(Le=(0,o.Z)("hr",{})),(0,o.Z)("h4",{},void 0,pgettext("markup help","Heading 3")),(0,o.Z)(et,{markup:pgettext("markup help","### Third level heading"),result:(0,o.Z)("h3",{},void 0,pgettext("markup help","Third level heading"))}),Te||(Te=(0,o.Z)("hr",{})),(0,o.Z)("h4",{},void 0,pgettext("markup help","Heading 4")),(0,o.Z)(et,{markup:pgettext("markup help","#### Fourth level heading"),result:(0,o.Z)("h4",{},void 0,pgettext("markup help","Fourth level heading"))}),Pe||(Pe=(0,o.Z)("hr",{})),(0,o.Z)("h4",{},void 0,pgettext("markup help","Heading 5")),(0,o.Z)(et,{markup:pgettext("markup help","##### Fifth level heading"),result:(0,o.Z)("h5",{},void 0,pgettext("markup help","Fifth level heading"))}),Oe||(Oe=(0,o.Z)("hr",{})),(0,o.Z)("h4",{},void 0,pgettext("markup help","Unordered list")),Re||(Re=(0,o.Z)(et,{markup:"- Lorem ipsum\n- Dolor met\n- Vulputate lectus",result:(0,o.Z)("ul",{},void 0,(0,o.Z)("li",{},void 0,"Lorem ipsum"),(0,o.Z)("li",{},void 0,"Dolor met"),(0,o.Z)("li",{},void 0,"Vulputate lectus"))})),Ae||(Ae=(0,o.Z)("hr",{})),(0,o.Z)("h4",{},void 0,pgettext("markup help","Ordered list")),Ie||(Ie=(0,o.Z)(et,{markup:"1. Lorem ipsum\n2. Dolor met\n3. Vulputate lectus",result:(0,o.Z)("ol",{},void 0,(0,o.Z)("li",{},void 0,"Lorem ipsum"),(0,o.Z)("li",{},void 0,"Dolor met"),(0,o.Z)("li",{},void 0,"Vulputate lectus"))})),De||(De=(0,o.Z)("hr",{})),(0,o.Z)("h4",{},void 0,pgettext("markup help","Quote text")),(0,o.Z)(et,{markup:"> "+pgettext("markup help","Quoted text"),result:(0,o.Z)("blockquote",{},void 0,(0,o.Z)("p",{},void 0,pgettext("markup help","Quoted text")))}),je||(je=(0,o.Z)("hr",{})),(0,o.Z)("h4",{},void 0,pgettext("markup help","Quote text (BBCode)")),(0,o.Z)(et,{markup:"[quote]\n"+pgettext("markup help","Quoted text")+"\n[/quote]",result:(0,o.Z)("aside",{className:"quote-block"},void 0,(0,o.Z)("div",{className:"quote-heading"},void 0,gettext("Quoted message:")),(0,o.Z)("blockquote",{className:"quote-body"},void 0,(0,o.Z)("p",{},void 0,pgettext("markup help","Quoted text"))))}),ze||(ze=(0,o.Z)("hr",{})),(0,o.Z)("h4",{},void 0,pgettext("markup help","Quote text with title (BBCode)")),(0,o.Z)(et,{markup:'[quote="'+pgettext("markup help","Quote title")+'"]\n'+pgettext("markup help","Quoted text")+"\n[/quote]",result:(0,o.Z)("aside",{className:"quote-block"},void 0,(0,o.Z)("div",{className:"quote-heading"},void 0,gettext("Quote title has written:")),(0,o.Z)("blockquote",{className:"quote-body"},void 0,(0,o.Z)("p",{},void 0,pgettext("markup help","Quoted text"))))}),Ue||(Ue=(0,o.Z)("hr",{})),(0,o.Z)("h4",{},void 0,pgettext("markup help","Spoiler")),(0,o.Z)(et,{markup:"[spoiler]\n"+pgettext("markup help","Secret text")+"\n[/spoiler]",result:(0,o.Z)(tt,{},void 0,pgettext("markup help","Secret text"))}),Me||(Me=(0,o.Z)("hr",{})),(0,o.Z)("h4",{},void 0,pgettext("markup help","Inline code")),(0,o.Z)(et,{markup:pgettext("markup help","`Inline code`"),result:(0,o.Z)("p",{},void 0,(0,o.Z)("code",{},void 0,pgettext("markup help","Inline code")))}),Be||(Be=(0,o.Z)("hr",{})),(0,o.Z)("h4",{},void 0,pgettext("markup help","Code block")),qe||(qe=(0,o.Z)(et,{markup:'```\nalert("Hello world!");\n```',result:(0,o.Z)("pre",{},void 0,(0,o.Z)("code",{className:"hljs"},void 0,'alert("Hello world!");'))})),He||(He=(0,o.Z)("hr",{})),(0,o.Z)("h4",{},void 0,pgettext("markup help","Code block with syntax highlighting")),Fe||(Fe=(0,o.Z)(et,{markup:'```python\nprint("Hello world!");\n```',result:(0,o.Z)("pre",{},void 0,(0,o.Z)("code",{className:"hljs language-python"},void 0,(0,o.Z)("span",{className:"hljs-built_in"},void 0,"print"),'("Hello world!");'))})),Ye||(Ye=(0,o.Z)("hr",{})),(0,o.Z)("h4",{},void 0,pgettext("markup help","Code block (BBCode)")),Ve||(Ve=(0,o.Z)(et,{markup:'[code]\nalert("Hello world!");\n[/code]',result:(0,o.Z)("pre",{},void 0,(0,o.Z)("code",{className:"hljs"},void 0,'alert("Hello world!");'))})),Ge||(Ge=(0,o.Z)("hr",{})),(0,o.Z)("h4",{},void 0,pgettext("markup help","Code block with syntax highlighting (BBCode)")),$e||($e=(0,o.Z)(et,{markup:'[code="python"]\nprint("Hello world!");\n[/code]',result:(0,o.Z)("pre",{},void 0,(0,o.Z)("code",{className:"hljs language-python"},void 0,(0,o.Z)("span",{className:"hljs-built_in"},void 0,"print"),'("Hello world!");'))})),We||(We=(0,o.Z)("hr",{})),(0,o.Z)("h4",{},void 0,pgettext("markup help","Horizontal rule")),Qe||(Qe=(0,o.Z)(et,{markup:"Lorem ipsum\n- - -\nDolor met",result:(0,o.Z)("div",{},void 0,(0,o.Z)("p",{},void 0,"Lorem ipsum"),(0,o.Z)("hr",{}),(0,o.Z)("p",{},void 0,"Dolor met"))})),Ke||(Ke=(0,o.Z)("hr",{})),(0,o.Z)("h4",{},void 0,pgettext("markup help","Horizontal rule (BBCode)")),Je||(Je=(0,o.Z)(et,{markup:"Lorem ipsum\n[hr]\nDolor met",result:(0,o.Z)("div",{},void 0,(0,o.Z)("p",{},void 0,"Lorem ipsum"),(0,o.Z)("hr",{}),(0,o.Z)("p",{},void 0,"Dolor met"))}))),(0,o.Z)("div",{className:"modal-footer"},void 0,(0,o.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,pgettext("modal","Close")))))}function et(e){let{markup:t,result:s}=e;return(0,o.Z)("div",{className:"formatting-help-item"},void 0,(0,o.Z)("div",{className:"formatting-help-item-markup"},void 0,(0,o.Z)("pre",{},void 0,(0,o.Z)("code",{},void 0,t))),(0,o.Z)("div",{className:"formatting-help-item-preview"},void 0,(0,o.Z)("article",{className:"misago-markup"},void 0,s)))}class tt extends i.Component{constructor(e){super(e),this.state={reveal:!1}}render(){return(0,o.Z)("aside",{className:this.state.reveal?"spoiler-block revealed":"spoiler-block"},void 0,(0,o.Z)("blockquote",{className:"spoiler-body"},void 0,(0,o.Z)("p",{},void 0,this.props.children)),!this.state.reveal&&(0,o.Z)("div",{className:"spoiler-overlay"},void 0,(0,o.Z)("button",{className:"spoiler-reveal",type:"button",onClick:()=>{this.setState({reveal:!0})}},void 0,gettext("Reveal spoiler"))))}}var st=s(9755);const at=new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i");function it(e){return at.test(st.trim(e))}var ot;class nt extends i.Component{constructor(e){super(e);const t=e.selection.text.trim(),s=it(t);this.state={error:null,text:s?"":t,url:s?t:""}}handleSubmit=e=>{e.preventDefault();const{selection:t,update:s}=this.props,a=this.state.text.trim(),i=this.state.url.trim();return 0===i.length?(this.setState({error:gettext("This field is required.")}),!1):it(i)?(a.length>0?F(t,s,"!["+a+"]("+i+")"):F(t,s,"!("+i+")"),M.Z.hide(),!1):(this.setState({error:gettext("Enter a valid address.")}),!1)};render(){return(0,o.Z)("div",{className:"modal-dialog",role:"document"},void 0,(0,o.Z)("div",{className:"modal-content"},void 0,(0,o.Z)("div",{className:"modal-header"},void 0,(0,o.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,ot||(ot=(0,o.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,o.Z)("h4",{className:"modal-title"},void 0,pgettext("markup editor","Image"))),(0,o.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,o.Z)("div",{className:"modal-body"},void 0,(0,o.Z)(ie.Z,{for:"markup_link_url",label:pgettext("markup editor","Image description"),helpText:pgettext("markup editor","Optional but recommended . Will be displayed instead of image when it fails to load.")},void 0,(0,o.Z)("input",{id:"markup_link_text",className:"form-control",type:"text",value:this.state.text,onChange:e=>this.setState({text:e.target.value})})),(0,o.Z)(ie.Z,{for:"markup_link_url",label:pgettext("markup editor","Image address"),validation:this.state.error?[this.state.error]:void 0},void 0,(0,o.Z)("input",{id:"markup_link_url",className:"form-control",type:"text",value:this.state.url,onChange:e=>this.setState({url:e.target.value})}))),(0,o.Z)("div",{className:"modal-footer"},void 0,(0,o.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,gettext("Cancel")),(0,o.Z)("button",{className:"btn btn-primary"},void 0,pgettext("markup editor","Insert image"))))))}}const rt=nt;var lt;class dt extends i.Component{constructor(e){super(e);const t=e.selection.text.trim(),s=it(t);this.state={error:null,text:s?"":t,url:s?t:""}}handleSubmit=e=>{e.preventDefault();const{selection:t,update:s}=this.props,a=this.state.text.trim(),i=this.state.url.trim();return 0===i.length?(this.setState({error:gettext("This field is required.")}),!1):it(i)?(a.length>0?F(t,s,"["+a+"]("+i+")"):F(t,s,"<"+i+">"),M.Z.hide(),!1):(this.setState({error:gettext("Enter a valid address.")}),!1)};render(){return(0,o.Z)("div",{className:"modal-dialog",role:"document"},void 0,(0,o.Z)("div",{className:"modal-content"},void 0,(0,o.Z)("div",{className:"modal-header"},void 0,(0,o.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,lt||(lt=(0,o.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,o.Z)("h4",{className:"modal-title"},void 0,pgettext("markup editor","Link"))),(0,o.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,o.Z)("div",{className:"modal-body"},void 0,(0,o.Z)(ie.Z,{for:"markup_link_url",label:pgettext("markup editor","Link text"),helpText:pgettext("markup editor","Optional. Will be displayed instead of link's address.")},void 0,(0,o.Z)("input",{id:"markup_link_text",className:"form-control",type:"text",value:this.state.text,onChange:e=>this.setState({text:e.target.value})})),(0,o.Z)(ie.Z,{for:"markup_link_url",label:pgettext("markup editor","Link address"),validation:this.state.error?[this.state.error]:void 0},void 0,(0,o.Z)("input",{id:"markup_link_url",className:"form-control",type:"text",value:this.state.url,onChange:e=>this.setState({url:e.target.value})}))),(0,o.Z)("div",{className:"modal-footer"},void 0,(0,o.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,gettext("Cancel")),(0,o.Z)("button",{className:"btn btn-primary"},void 0,pgettext("markup editor","Insert link"))))))}}const ct=dt;var pt;class ut extends i.Component{constructor(e){super(e),this.state={error:null,author:"",text:e.selection.text}}handleSubmit=e=>{e.preventDefault();const{selection:t,update:s}=this.props,a=this.state.author.trim(),i=this.state.text.trim();if(0===i.length)return this.setState({error:gettext("This field is required.")}),!1;const o=t.prefix.trim().length?"\n\n":"";return F(t,s,a?o+'[quote="'+a+'"]\n'+i+"\n[/quote]\n\n":o+"[quote]\n"+i+"\n[/quote]\n\n"),M.Z.hide(),!1};render(){return(0,o.Z)("div",{className:"modal-dialog modal-lg",role:"document"},void 0,(0,o.Z)("div",{className:"modal-content"},void 0,(0,o.Z)("div",{className:"modal-header"},void 0,(0,o.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,pt||(pt=(0,o.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,o.Z)("h4",{className:"modal-title"},void 0,pgettext("markup editor","Quote"))),(0,o.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,o.Z)("div",{className:"modal-body"},void 0,(0,o.Z)(ie.Z,{for:"markup_quote_author",label:pgettext("markup editor","Quote's author or source"),helpText:pgettext("markup editor",'Optional. If it\'s username, put "@" before it ("@JohnDoe").')},void 0,(0,o.Z)("input",{id:"markup_quote_author",className:"form-control",type:"text",value:this.state.author,onChange:e=>this.setState({author:e.target.value})})),(0,o.Z)(ie.Z,{for:"markup_quote_text",label:pgettext("markup editor","Quoted text"),validation:this.state.error?[this.state.error]:void 0},void 0,(0,o.Z)("textarea",{id:"markup_quote_text",className:"form-control",rows:"8",value:this.state.text,onChange:e=>this.setState({text:e.target.value})}))),(0,o.Z)("div",{className:"modal-footer"},void 0,(0,o.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,gettext("Cancel")),(0,o.Z)("button",{className:"btn btn-primary"},void 0,pgettext("markup editor","Insert quote"))))))}}const ht=ut,mt=e=>{let{disabled:t,icon:s,title:a,onClick:i}=e;return(0,o.Z)("button",{className:"btn btn-markup-editor",title:a,type:"button",disabled:t,onClick:i},void 0,(0,o.Z)("span",{className:"material-icon"},void 0,s))},vt="12345678990abcdefghijklmnopqrstuvwxyz",gt=vt.length,Zt=e=>{const t=[];for(let s=0;s<e;s++){const e=Math.floor(Math.random()*gt);t.push(vt[e])}return t.join("")},bt=(e,t)=>{const s=1024*z.Z.get("user").acl.max_attachment_size;if(e.size>s)return void I.Z.error(interpolate(pgettext("markup editor","File %(filename)s is bigger than %(limit)s."),{filename:e.name,limit:(0,B.Z)(s)},!0));let a={id:null,key:Zt(32),error:null,uploaded_on:null,progress:0,filename:e.name,filetype:null,is_image:!1,size:e.size,url:null,uploader_name:null};t((e=>{let{attachments:t}=e;return{attachments:[a].concat(t)}}));const i=()=>{t((e=>{let{attachments:t}=e;return{attachments:t.concat()}}))},o=new FormData;o.append("upload",e),A.Z.upload(z.Z.get("ATTACHMENTS_API"),o,(e=>{a.progress=e,i()})).then((e=>{Object.assign(a,e,{uploaded_on:T()(e.uploaded_on)}),i()}),(e=>{400===e.status||413===e.status?(a.error=e.detail,I.Z.error(e.detail),i()):I.Z.apiError(e)}))};var _t,ft;const Nt=e=>{let{disabled:t,element:s,update:a,updateAttachments:i}=e;const n=[{name:pgettext("markup editor","Strong"),icon:"format_bold",onClick:()=>{H(Y(s),a,"**","**",pgettext("example markup","Strong text"))}},{name:pgettext("markup editor","Emphasis"),icon:"format_italic",onClick:()=>{H(Y(s),a,"*","*",pgettext("example markup","Text with emphasis"))}},{name:pgettext("markup editor","Strikethrough"),icon:"format_strikethrough",onClick:()=>{H(Y(s),a,"~~","~~",pgettext("example markup","Text with strikethrough"))}},{name:pgettext("markup editor","Horizontal ruler"),icon:"remove",onClick:()=>{F(Y(s),a,"\n\n- - -\n\n")}},{name:pgettext("markup editor","Link"),icon:"insert_link",onClick:()=>{const e=Y(s);M.Z.show((0,o.Z)(ct,{selection:e,element:s,update:a}))}},{name:pgettext("markup editor","Image"),icon:"insert_photo",onClick:()=>{const e=Y(s);M.Z.show((0,o.Z)(rt,{selection:e,element:s,update:a}))}},{name:pgettext("markup editor","Quote"),icon:"format_quote",onClick:()=>{const e=Y(s);M.Z.show((0,o.Z)(ht,{selection:e,element:s,update:a}))}},{name:pgettext("markup editor","Spoiler"),icon:"visibility_off",onClick:()=>{((e,t)=>{const s=Y(e),a=s.prefix.trim().length?"\n\n":"";H(s,t,a+"[spoiler]\n","\n[/spoiler]\n\n",pgettext("markup editor","Spoiler text"))})(s,a)}},{name:pgettext("markup editor","Code"),icon:"code",onClick:()=>{const e=Y(s);M.Z.show((0,o.Z)(re,{selection:e,element:s,update:a}))}}];return z.Z.get("user").acl.max_attachment_size&&n.push({name:pgettext("markup editor","Upload file"),icon:"file_upload",onClick:()=>(e=>{const t=document.createElement("input");t.type="file",t.multiple="multiple",t.addEventListener("change",(function(){for(let s=0;s<t.files.length;s++)bt(t.files[s],e)})),t.click()})(i)}),(0,o.Z)("div",{className:"markup-editor-toolbar"},void 0,(0,o.Z)("div",{className:"markup-editor-toolbar-left"},void 0,n.map((e=>{let{name:a,icon:i,onClick:n}=e;return(0,o.Z)(mt,{title:a,icon:i,disabled:t||!s,onClick:n},i)}))),(0,o.Z)("div",{className:"markup-editor-toolbar-right"},void 0,(0,o.Z)("div",{className:"markup-editor-controls-dropdown"},void 0,(0,o.Z)("button",{type:"button",className:"btn btn-markup-editor dropdown-toggle","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",disabled:t||!s},void 0,_t||(_t=(0,o.Z)("span",{className:"material-icon"},void 0,"more_vert"))),(0,o.Z)("ul",{className:"dropdown-menu dropdown-menu-right stick-to-bottom"},void 0,n.map((e=>{let{name:a,icon:i,onClick:n}=e;return(0,o.Z)("li",{},i,(0,o.Z)("button",{type:"button",className:"btn-link",disabled:t||!s,onClick:n},void 0,(0,o.Z)("span",{className:"material-icon"},void 0,i),a))})))),(0,o.Z)(mt,{title:pgettext("markup editor","Formatting help"),icon:"help_outline",onClick:()=>{M.Z.show(ft||(ft=(0,o.Z)(Xe,{})))}})))};var xt=s(9755);class yt extends i.Component{constructor(e){super(e),this.state={element:null,focused:!1,loading:!1,preview:!1,parsed:null}}showPreview=()=>{this.state.loading||(this.setState({loading:!0,preview:!0,element:null}),A.Z.post(z.Z.get("PARSE_MARKUP_API"),{post:this.props.value}).then((e=>{this.setState({loading:!1,parsed:e.parsed})}),(e=>{400===e.status?I.Z.error(e.detail):I.Z.apiError(e),this.setState({loading:!1,preview:!1})})))};closePreview=()=>{this.setState({loading:!1,preview:!1})};onDrop=e=>{if(e.preventDefault(),e.stopPropagation(),!e.dataTransfer.files)return;const{onAttachmentsChange:t}=this.props;if(z.Z.get("user").acl.max_attachment_size)for(let s=0;s<e.dataTransfer.files.length;s++){const a=e.dataTransfer.files[s];bt(a,t)}};onPaste=e=>{const{onAttachmentsChange:t}=this.props,s=[];for(let t=0;t<e.clipboardData.items.length;t++){const a=e.clipboardData.items[t];"file"===a.kind&&s.push(a.getAsFile())}if(s.length&&(e.preventDefault(),e.stopPropagation(),z.Z.get("user").acl.max_attachment_size))for(let e=0;e<s.length;e++)bt(s[e],t)};render=()=>(0,o.Z)("div",{className:j()("markup-editor",{"markup-editor-focused":this.state.focused&&!this.state.preview})},void 0,(0,o.Z)(Nt,{disabled:this.props.disabled||this.state.preview,element:this.state.element,update:e=>this.props.onChange({target:{value:e}}),updateAttachments:this.props.onAttachmentsChange}),this.state.preview?(0,o.Z)("div",{className:"markup-editor-preview"},void 0,this.state.loading?(0,o.Z)("div",{className:"markup-editor-preview-loading"},void 0,(0,o.Z)("div",{className:"ui-preview"},void 0,(0,o.Z)("span",{className:"ui-preview-text",style:{width:"240px"}}))):(0,o.Z)(U.Z,{className:"markup-editor-preview-contents",markup:this.state.parsed})):i.createElement("textarea",{className:"markup-editor-textarea form-control",placeholder:this.props.placeholder,value:this.props.value,disabled:this.props.disabled||this.state.loading,rows:6,ref:e=>{e&&this.state.element!==e&&(this.setState({element:e}),function(e,t){xt(t).atwho({at:"@",displayTpl:'<li><img src="${avatar}" alt="">${username}</li>',insertTpl:"@${username}",searchKey:"username",callbacks:{remoteFilter:function(e,t){xt.getJSON(z.Z.get("MENTION_API"),{q:e},t)}}}),xt(t).on("inserted.atwho",((t,s,a,i)=>{const{query:o}=i,n=a.target.innerText.trim(),r=t.target.value.substr(0,o.headPos),l=t.target.value.substr(o.endPos);t.target.value=r+n+l,e.onChange(t);const d=o.headPos+n.length;t.target.setSelectionRange(d,d),t.target.focus()}))}(this.props,e))},onChange:this.props.onChange,onDrop:this.onDrop,onFocus:()=>this.setState({focused:!0}),onPaste:this.onPaste,onBlur:()=>this.setState({focused:!1})}),this.props.attachments.length>0&&(0,o.Z)(X,{attachments:this.props.attachments,disabled:this.props.disabled||this.state.preview,element:this.state.element,setState:this.props.onAttachmentsChange,update:e=>this.props.onChange({target:{value:e}})}),(0,o.Z)(se,{preview:this.state.preview,canProtect:this.props.canProtect,isProtected:this.props.isProtected,disabled:this.props.disabled,empty:this.props.value.trim().length<z.Z.get("SETTINGS").post_length_min||this.state.loading,enableProtection:this.props.enableProtection,disableProtection:this.props.disableProtection,showPreview:this.showPreview,closePreview:this.closePreview,submitText:this.props.submitText}))}const wt=yt;var kt=s(2490);const Ct="posting-active",St="posting-default",Et="posting-minimized",Lt="posting-fullscreen";class Tt extends i.Component{componentDidMount(){document.body.classList.add(Ct,St)}componentWillUnmount(){document.body.classList.remove(Ct,St,Et,Lt)}componentWillReceiveProps(e){let{fullscreen:t,minimized:s}=e;s?(document.body.classList.remove(St,Lt),document.body.classList.add(Et)):t?(document.body.classList.remove(St,Et),document.body.classList.add(Lt)):(document.body.classList.remove(Lt,Et),document.body.classList.add(St))}render(){const{children:e,fullscreen:t,minimized:s}=this.props;return(0,o.Z)("div",{className:j()("posting-dialog",{"posting-dialog-minimized":s,"posting-dialog-fullscreen":t&&!s})},void 0,(0,o.Z)("div",{className:"posting-dialog-container"},void 0,e))}}const Pt=Tt,Ot=e=>{let{children:t}=e;return(0,o.Z)("div",{className:"posting-dialog-body"},void 0,t)};var Rt;const At=e=>{let{close:t,message:s}=e;return(0,o.Z)("div",{className:"posting-dialog-error"},void 0,Rt||(Rt=(0,o.Z)("div",{className:"posting-dialog-error-icon"},void 0,(0,o.Z)("span",{className:"material-icon"},void 0,"error_outlined"))),(0,o.Z)("div",{className:"posting-dialog-error-detail"},void 0,(0,o.Z)("p",{},void 0,s),(0,o.Z)("button",{type:"button",className:"btn btn-default",onClick:t},void 0,pgettext("modal","Close"))))};var It,Dt,jt,zt,Ut;const Mt=e=>{let{children:t,close:s,fullscreen:a,minimize:i,minimized:n,fullscreenEnter:r,fullscreenExit:l,open:d}=e;return(0,o.Z)("div",{className:"posting-dialog-header"},void 0,(0,o.Z)("div",{className:"posting-dialog-caption"},void 0,t),n?(0,o.Z)("button",{className:"btn btn-posting-dialog",title:pgettext("dialog","Open"),type:"button",onClick:d},void 0,It||(It=(0,o.Z)("span",{className:"material-icon"},void 0,"expand_less"))):(0,o.Z)("button",{className:"btn btn-posting-dialog",title:pgettext("dialog","Minimize"),type:"button",onClick:i},void 0,Dt||(Dt=(0,o.Z)("span",{className:"material-icon"},void 0,"expand_more"))),a?(0,o.Z)("button",{className:"btn btn-posting-dialog hidden-xs",title:pgettext("dialog","Exit the fullscreen mode"),type:"button",onClick:l},void 0,jt||(jt=(0,o.Z)("span",{className:"material-icon"},void 0,"fullscreen_exit"))):(0,o.Z)("button",{className:"btn btn-posting-dialog hidden-xs",title:pgettext("dialog","Enter the fullscreen mode"),type:"button",onClick:r},void 0,zt||(zt=(0,o.Z)("span",{className:"material-icon"},void 0,"fullscreen"))),(0,o.Z)("button",{className:"btn btn-posting-dialog",title:pgettext("dialog","Cancel"),type:"button",onClick:s},void 0,Ut||(Ut=(0,o.Z)("span",{className:"material-icon"},void 0,"close"))))};var Bt,qt,Ht,Ft,Yt,Vt,Gt,$t,Wt;function Qt(e){let{isClosed:t,isHidden:s,isPinned:a,disabled:i,options:n,close:r,open:l,hide:d,unhide:c,pinGlobally:p,pinLocally:u,unpin:h}=e;const m=function(e,t,s){const a=[];return 2===s&&a.push("bookmark"),1===s&&a.push("bookmark_outline"),e&&a.push("lock"),t&&a.push("visibility_off"),a}(t,s,a);return(0,o.Z)("div",{className:"dropdown"},void 0,(0,o.Z)("button",{className:"btn btn-default btn-outline btn-icon",title:pgettext("post thread","Options"),"aria-expanded":"true","aria-haspopup":"true","data-toggle":"dropdown",type:"button",disabled:i},void 0,m.length>0?(0,o.Z)("span",{className:"btn-icons-family"},void 0,m.map((e=>(0,o.Z)("span",{className:"material-icon"},e,e)))):Bt||(Bt=(0,o.Z)("span",{className:"material-icon"},void 0,"more_horiz"))),(0,o.Z)("ul",{className:"dropdown-menu dropdown-menu-right stick-to-bottom"},void 0,2===n.pin&&2!==a&&(0,o.Z)("li",{},void 0,(0,o.Z)("button",{className:"btn btn-link",onClick:p,type:"button",disabled:i},void 0,qt||(qt=(0,o.Z)("span",{className:"material-icon"},void 0,"bookmark")),pgettext("post thread","Pinned globally"))),n.pin>=a&&1!==a&&(0,o.Z)("li",{},void 0,(0,o.Z)("button",{className:"btn btn-link",onClick:u,type:"button",disabled:i},void 0,Ht||(Ht=(0,o.Z)("span",{className:"material-icon"},void 0,"bookmark_outline")),pgettext("post thread","Pinned locally"))),n.pin>=a&&0!==a&&(0,o.Z)("li",{},void 0,(0,o.Z)("button",{className:"btn btn-link",onClick:h,type:"button",disabled:i},void 0,Ft||(Ft=(0,o.Z)("span",{className:"material-icon"},void 0,"radio_button_unchecked")),pgettext("post thread","Not pinned"))),n.close&&!!t&&(0,o.Z)("li",{},void 0,(0,o.Z)("button",{className:"btn btn-link",onClick:l,type:"button",disabled:i},void 0,Yt||(Yt=(0,o.Z)("span",{className:"material-icon"},void 0,"lock_outline")),pgettext("post thread","Open"))),n.close&&!t&&(0,o.Z)("li",{},void 0,(0,o.Z)("button",{className:"btn btn-link",onClick:r,type:"button",disabled:i},void 0,Vt||(Vt=(0,o.Z)("span",{className:"material-icon"},void 0,"lock")),pgettext("post thread","Closed"))),n.hide&&!!s&&(0,o.Z)("li",{},void 0,(0,o.Z)("button",{className:"btn btn-link",onClick:c,type:"button",disabled:i},void 0,Gt||(Gt=(0,o.Z)("span",{className:"material-icon"},void 0,"visibility")),pgettext("post thread","Visible"))),n.hide&&!s&&(0,o.Z)("li",{},void 0,(0,o.Z)("button",{className:"btn btn-link",onClick:d,type:"button",disabled:i},void 0,$t||($t=(0,o.Z)("span",{className:"material-icon"},void 0,"visibility_off")),pgettext("post thread","Hidden")))))}const Kt=class extends E.Z{constructor(e){super(e),this.state={isReady:!1,isLoading:!1,error:null,minimized:!1,fullscreen:!1,options:null,title:"",category:e.category||null,categories:[],post:"",attachments:[],close:!1,hide:!1,pin:0,validators:{title:(0,R.jn)(),post:(0,R.Jh)()},errors:{}}}componentDidMount(){A.Z.get(this.props.config).then(this.loadSuccess,this.loadError)}loadSuccess=e=>{let t=null,s=null;const a=e.map((e=>(!1===e.post||t&&e.id!=this.state.category||(t=e.id,s=e.post),Object.assign(e,{disabled:!1===e.post,label:e.name,value:e.id}))));this.setState({isReady:!0,options:s,categories:a,category:t})};loadError=e=>{this.setState({error:e.detail})};onCancel=()=>{window.confirm(pgettext("post thread","Are you sure you want to discard thread?"))&&(this.minimize(),n.Z.close())};onTitleChange=e=>{this.changeValue("title",e.target.value)};onCategoryChange=e=>{const t=this.state.categories.find((t=>e.target.value==t.value));let s=this.state.pin;t.post.pin&&t.post.pin<s&&(s=t.post.pin),this.setState({category:t.id,categoryOptions:t.post,pin:s})};onPostChange=e=>{this.changeValue("post",e.target.value)};onAttachmentsChange=e=>{this.setState(e)};onClose=()=>{this.changeValue("close",!0)};onOpen=()=>{this.changeValue("close",!1)};onPinGlobally=()=>{this.changeValue("pin",2)};onPinLocally=()=>{this.changeValue("pin",1)};onUnpin=()=>{this.changeValue("pin",0)};onHide=()=>{this.changeValue("hide",!0)};onUnhide=()=>{this.changeValue("hide",!1)};close=()=>{this.minimize(),n.Z.close()};minimize=()=>{this.setState({fullscreen:!1,minimized:!0})};open=()=>{this.setState({minimized:!1}),this.state.fullscreen};fullscreenEnter=()=>{this.setState({fullscreen:!0,minimized:!1})};fullscreenExit=()=>{this.setState({fullscreen:!1,minimized:!1})};clean(){if(!this.state.title.trim().length)return I.Z.error(gettext("You have to enter thread title.")),!1;if(!this.state.post.trim().length)return I.Z.error(gettext("You have to enter a message.")),!1;const e=this.validate();return e.title?(I.Z.error(e.title[0]),!1):!e.post||(I.Z.error(e.post[0]),!1)}send(){return A.Z.post(this.props.submit,{title:this.state.title,category:this.state.category,post:this.state.post,attachments:P(this.state.attachments),close:this.state.close,hide:this.state.hide,pin:this.state.pin})}handleSuccess(e){this.setState({isLoading:!0}),this.close(),I.Z.success(pgettext("post thread","Your thread has been posted.")),window.location=e.url}handleError(e){if(400===e.status){const t=[].concat(e.non_field_errors||[],e.category||[],e.title||[],e.post||[],e.attachments||[]);I.Z.error(t[0])}else I.Z.apiError(e)}render(){const e={minimized:this.state.minimized,minimize:this.minimize,open:this.open,fullscreen:this.state.fullscreen,fullscreenEnter:this.fullscreenEnter,fullscreenExit:this.fullscreenExit,close:this.onCancel};if(this.state.error)return i.createElement(Jt,e,(0,o.Z)(At,{message:this.state.error,close:this.close}));if(!this.state.isReady)return i.createElement(Jt,e,(0,o.Z)("div",{className:"posting-loading ui-preview"},void 0,Wt||(Wt=(0,o.Z)(kt.o8,{className:"posting-dialog-toolbar"},void 0,(0,o.Z)(kt.Z2,{className:"posting-dialog-thread-title",auto:!0},void 0,(0,o.Z)(kt.Eg,{auto:!0},void 0,(0,o.Z)("input",{className:"form-control",disabled:!0,type:"text"}))),(0,o.Z)(kt.Z2,{className:"posting-dialog-category-select",auto:!0},void 0,(0,o.Z)(kt.Eg,{},void 0,(0,o.Z)("input",{className:"form-control",disabled:!0,type:"text"}))))),(0,o.Z)(wt,{attachments:[],value:"",submitText:pgettext("post thread submit","Post thread"),disabled:!0,onAttachmentsChange:()=>{},onChange:()=>{}})));const t=!!(this.state.options.close||this.state.options.hide||this.state.options.pin);return i.createElement(Jt,e,(0,o.Z)("form",{className:"posting-dialog-form",onSubmit:this.handleSubmit},void 0,(0,o.Z)(kt.o8,{className:"posting-dialog-toolbar"},void 0,(0,o.Z)(kt.Z2,{className:"posting-dialog-thread-title",auto:!0},void 0,(0,o.Z)(kt.Eg,{auto:!0},void 0,(0,o.Z)("input",{className:"form-control",disabled:this.state.isLoading,onChange:this.onTitleChange,placeholder:pgettext("post thread","Thread title"),type:"text",value:this.state.title}))),(0,o.Z)(kt.Z2,{className:"posting-dialog-category-select",auto:!0},void 0,(0,o.Z)(kt.Eg,{},void 0,(0,o.Z)(S.Z,{choices:this.state.categories,disabled:this.state.isLoading,onChange:this.onCategoryChange,value:this.state.category})),t&&(0,o.Z)(kt.Eg,{shrink:!0},void 0,(0,o.Z)(Qt,{isClosed:this.state.close,isHidden:this.state.hide,isPinned:this.state.pin,disabled:this.state.isLoading,options:this.state.options,close:this.onClose,open:this.onOpen,hide:this.onHide,unhide:this.onUnhide,pinGlobally:this.onPinGlobally,pinLocally:this.onPinLocally,unpin:this.onUnpin})))),(0,o.Z)(wt,{attachments:this.state.attachments,value:this.state.post,submitText:pgettext("post thread submit","Start thread"),disabled:this.state.isLoading,onAttachmentsChange:this.onAttachmentsChange,onChange:this.onPostChange})))}},Jt=e=>{let{children:t,close:s,minimized:a,minimize:i,open:n,fullscreen:r,fullscreenEnter:l,fullscreenExit:d}=e;return(0,o.Z)(Pt,{fullscreen:r,minimized:a},void 0,(0,o.Z)(Mt,{fullscreen:r,fullscreenEnter:l,fullscreenExit:d,minimized:a,minimize:i,open:n,close:s},void 0,pgettext("post thread","Start new thread")),(0,o.Z)(Ot,{},void 0,t))};function Xt(e){const t=e.split(",").map((e=>e.trim().toLowerCase())).filter((e=>e.length>0));return t.filter(((e,s)=>t.indexOf(e)==s))}const es=class extends E.Z{constructor(e){super(e);const t=(e.to||[]).map((e=>e.username)).join(", ");this.state={isLoading:!1,error:null,minimized:!1,fullscreen:!1,to:t,title:"",post:"",attachments:[],validators:{title:(0,R.jn)(),post:(0,R.Jh)()},errors:{}}}onCancel=()=>{window.confirm(pgettext("post thread","Are you sure you want to discard private thread?"))&&this.close()};onToChange=e=>{this.changeValue("to",e.target.value)};onTitleChange=e=>{this.changeValue("title",e.target.value)};onPostChange=e=>{this.changeValue("post",e.target.value)};onAttachmentsChange=e=>{this.setState(e)};clean(){if(!Xt(this.state.to).length)return I.Z.error(gettext("You have to enter at least one recipient.")),!1;if(!this.state.title.trim().length)return I.Z.error(gettext("You have to enter thread title.")),!1;if(!this.state.post.trim().length)return I.Z.error(gettext("You have to enter a message.")),!1;const e=this.validate();return e.title?(I.Z.error(e.title[0]),!1):!e.post||(I.Z.error(e.post[0]),!1)}send(){return A.Z.post(this.props.submit,{to:Xt(this.state.to),title:this.state.title,post:this.state.post,attachments:P(this.state.attachments)})}handleSuccess(e){this.setState({isLoading:!0}),this.close(),I.Z.success(pgettext("post thread","Your thread has been posted.")),window.location=e.url}handleError(e){if(400===e.status){const t=[].concat(e.non_field_errors||[],e.to||[],e.title||[],e.post||[],e.attachments||[]);I.Z.error(t[0])}else I.Z.apiError(e)}close=()=>{this.minimize(),n.Z.close()};minimize=()=>{this.setState({fullscreen:!1,minimized:!0})};open=()=>{this.setState({minimized:!1}),this.state.fullscreen};fullscreenEnter=()=>{this.setState({fullscreen:!0,minimized:!1})};fullscreenExit=()=>{this.setState({fullscreen:!1,minimized:!1})};render(){const e={minimized:this.state.minimized,minimize:this.minimize,open:this.open,fullscreen:this.state.fullscreen,fullscreenEnter:this.fullscreenEnter,fullscreenExit:this.fullscreenExit,close:this.onCancel};return i.createElement(ts,e,(0,o.Z)("form",{className:"posting-dialog-form",onSubmit:this.handleSubmit},void 0,(0,o.Z)(kt.o8,{className:"posting-dialog-toolbar"},void 0,(0,o.Z)(kt.Z2,{className:"posting-dialog-thread-recipients",auto:!0},void 0,(0,o.Z)(kt.Eg,{auto:!0},void 0,(0,o.Z)("input",{className:"form-control",disabled:this.state.isLoading,onChange:this.onToChange,placeholder:pgettext("post thread","Recipients, eg.: Danny, Lisa, Alice"),type:"text",value:this.state.to}))),(0,o.Z)(kt.Z2,{className:"posting-dialog-thread-title",auto:!0},void 0,(0,o.Z)(kt.Eg,{auto:!0},void 0,(0,o.Z)("input",{className:"form-control",disabled:this.state.isLoading,onChange:this.onTitleChange,placeholder:pgettext("post thread","Thread title"),type:"text",value:this.state.title})))),(0,o.Z)(wt,{attachments:this.state.attachments,value:this.state.post,submitText:pgettext("post thread submit","Start thread"),disabled:this.state.isLoading,onAttachmentsChange:this.onAttachmentsChange,onChange:this.onPostChange})))}},ts=e=>{let{children:t,close:s,minimized:a,minimize:i,open:n,fullscreen:r,fullscreenEnter:l,fullscreenExit:d}=e;return(0,o.Z)(Pt,{fullscreen:r,minimized:a},void 0,(0,o.Z)(Mt,{fullscreen:r,fullscreenEnter:l,fullscreenExit:d,minimized:a,minimize:i,open:n,close:s},void 0,pgettext("post thread","Start private thread")),(0,o.Z)(Ot,{},void 0,t))},ss=class extends E.Z{constructor(e){super(e),this.state={isReady:!1,isLoading:!1,error:null,minimized:!1,fullscreen:!1,post:this.props.default||"",attachments:[],validators:{post:(0,R.Jh)()},errors:{}}}componentDidMount(){A.Z.get(this.props.config,this.props.context||null).then(this.loadSuccess,this.loadError),k(!1,this.onQuote)}componentWillUnmount(){C()}componentWillReceiveProps(e){const t=this.props.context,s=e.context;t&&s&&t.reply===s.reply||A.Z.get(e.config,e.context||null).then(this.appendData,I.Z.apiError)}loadSuccess=e=>{this.setState({isReady:!0,post:e.post?'[quote="@'+e.poster+'"]\n'+e.post+"\n[/quote]":this.state.post})};loadError=e=>{this.setState({error:e.detail})};appendData=e=>{const t=e.post?'[quote="@'+e.poster+'"]\n'+e.post+"\n[/quote]\n\n":"";this.setState(((e,s)=>e.post.length>0?{post:e.post+"\n\n"+t}:{post:t})),this.open()};onCancel=()=>{window.confirm(pgettext("post reply","Are you sure you want to discard your reply?"))&&this.close()};onPostChange=e=>{this.changeValue("post",e.target.value)};onAttachmentsChange=e=>{this.setState(e)};onQuote=e=>{this.setState((t=>{let{post:s}=t;return s.length>0?{post:s.trim()+"\n\n"+e}:{post:e}})),this.open()};clean(){if(!this.state.post.trim().length)return I.Z.error(gettext("You have to enter a message.")),!1;const e=this.validate();return!e.post||(I.Z.error(e.post[0]),!1)}send(){return k(!0,this.onQuote),A.Z.post(this.props.submit,{post:this.state.post,attachments:P(this.state.attachments)})}handleSuccess(e){this.setState({isLoading:!0}),this.close(),k(!1,this.onQuote),I.Z.success(pgettext("post reply","Your reply has been posted.")),window.location=e.url.index}handleError(e){if(400===e.status){const t=[].concat(e.non_field_errors||[],e.post||[],e.attachments||[]);I.Z.error(t[0])}else I.Z.apiError(e);k(!1,this.onQuote)}close=()=>{this.minimize(),n.Z.close()};minimize=()=>{this.setState({fullscreen:!1,minimized:!0})};open=()=>{this.setState({minimized:!1}),this.state.fullscreen};fullscreenEnter=()=>{this.setState({fullscreen:!0,minimized:!1})};fullscreenExit=()=>{this.setState({fullscreen:!1,minimized:!1})};render(){const e={thread:this.props.thread,minimized:this.state.minimized,minimize:this.minimize,open:this.open,fullscreen:this.state.fullscreen,fullscreenEnter:this.fullscreenEnter,fullscreenExit:this.fullscreenExit,close:this.onCancel};return this.state.error?i.createElement(as,e,(0,o.Z)(At,{message:this.state.error,close:this.close})):this.state.isReady?i.createElement(as,e,(0,o.Z)("form",{className:"posting-dialog-form",method:"POST",onSubmit:this.handleSubmit},void 0,(0,o.Z)(wt,{attachments:this.state.attachments,value:this.state.post,submitText:pgettext("post reply submit","Post reply"),disabled:this.state.isLoading,onAttachmentsChange:this.onAttachmentsChange,onChange:this.onPostChange}))):i.createElement(as,e,(0,o.Z)("div",{className:"posting-loading ui-preview"},void 0,(0,o.Z)(wt,{attachments:[],value:"",submitText:pgettext("post reply submit","Post reply"),disabled:!0,onAttachmentsChange:()=>{},onChange:()=>{}})))}},as=e=>{let{children:t,close:s,minimized:a,minimize:i,open:n,fullscreen:r,fullscreenEnter:l,fullscreenExit:d,thread:c}=e;return(0,o.Z)(Pt,{fullscreen:r,minimized:a},void 0,(0,o.Z)(Mt,{fullscreen:r,fullscreenEnter:l,fullscreenExit:d,minimized:a,minimize:i,open:n,close:s},void 0,interpolate(pgettext("post reply","Reply to: %(thread)s"),{thread:c.title},!0)),(0,o.Z)(Ot,{},void 0,t))},is=class extends E.Z{constructor(e){super(e),this.state={isReady:!1,isLoading:!1,error:!1,minimized:!1,fullscreen:!1,post:"",attachments:[],protect:!1,canProtect:!1,validators:{post:(0,R.Jh)()},errors:{}}}componentDidMount(){A.Z.get(this.props.config).then(this.loadSuccess,this.loadError),k(!1,this.onQuote)}componentWillUnmount(){C()}componentWillReceiveProps(e){const t=this.props.context,s=e.context;t&&s&&t.reply===s.reply||A.Z.get(e.config,e.context||null).then(this.appendData,I.Z.apiError)}loadSuccess=e=>{var t;this.setState({isReady:!0,post:e.post,attachments:(t=e.attachments,t.map((e=>Object.assign({},e,{uploaded_on:T()(e.uploaded_on)})))),protect:e.is_protected,canProtect:e.can_protect})};loadError=e=>{this.setState({error:e.detail})};appendData=e=>{const t=e.post?'[quote="@'+e.poster+'"]\n'+e.post+"\n[/quote]\n\n":"";this.setState(((e,s)=>e.post.length>0?{post:e.post+"\n\n"+t}:{post:t})),this.open()};onCancel=()=>{window.confirm(gettext("Are you sure you want to discard changes?"))&&this.close()};onProtect=()=>{this.setState({protect:!0})};onUnprotect=()=>{this.setState({protect:!1})};onPostChange=e=>{this.changeValue("post",e.target.value)};onAttachmentsChange=e=>{this.setState(e)};onQuote=e=>{this.setState((t=>{let{post:s}=t;return s.length>0?{post:s.trim()+"\n\n"+e}:{post:e}})),this.open()};clean(){if(!this.state.post.trim().length)return I.Z.error(gettext("You have to enter a message.")),!1;const e=this.validate();return!e.post||(I.Z.error(e.post[0]),!1)}send(){return k(!0,this.onQuote),A.Z.put(this.props.submit,{post:this.state.post,attachments:P(this.state.attachments),protect:this.state.protect})}handleSuccess(e){this.setState({isLoading:!0}),this.close(),k(!1,this.onQuote),I.Z.success(gettext("Reply has been edited.")),window.location=e.url.index}handleError(e){if(400===e.status){const t=[].concat(e.non_field_errors||[],e.category||[],e.title||[],e.post||[],e.attachments||[]);I.Z.error(t[0])}else I.Z.apiError(e);k(!1,this.onQuote)}close=()=>{this.minimize(),n.Z.close()};minimize=()=>{this.setState({fullscreen:!1,minimized:!0})};open=()=>{this.setState({minimized:!1}),this.state.fullscreen};fullscreenEnter=()=>{this.setState({fullscreen:!0,minimized:!1})};fullscreenExit=()=>{this.setState({fullscreen:!1,minimized:!1})};render(){const e={post:this.props.post,minimized:this.state.minimized,minimize:this.minimize,open:this.open,fullscreen:this.state.fullscreen,fullscreenEnter:this.fullscreenEnter,fullscreenExit:this.fullscreenExit,close:this.onCancel};return this.state.error?i.createElement(os,e,(0,o.Z)(At,{message:this.state.error,close:this.close})):this.state.isReady?i.createElement(os,e,(0,o.Z)("form",{className:"posting-dialog-form",method:"POST",onSubmit:this.handleSubmit},void 0,(0,o.Z)(wt,{attachments:this.state.attachments,canProtect:this.state.canProtect,isProtected:this.state.protect,enableProtection:()=>this.setState({protect:!0}),disableProtection:()=>this.setState({protect:!1}),value:this.state.post,submitText:pgettext("edit reply submit","Edit reply"),disabled:this.state.isLoading,onAttachmentsChange:this.onAttachmentsChange,onChange:this.onPostChange}))):i.createElement(os,e,(0,o.Z)("div",{className:"posting-loading ui-preview"},void 0,(0,o.Z)(wt,{attachments:[],value:"",submitText:pgettext("edit reply submit","Edit reply"),disabled:!0,onAttachmentsChange:()=>{},onChange:()=>{}})))}},os=e=>{let{children:t,close:s,minimized:a,minimize:i,open:n,fullscreen:r,fullscreenEnter:l,fullscreenExit:d,post:c}=e;return(0,o.Z)(Pt,{fullscreen:r,minimized:a},void 0,(0,o.Z)(Mt,{fullscreen:r,fullscreenEnter:l,fullscreenExit:d,minimized:a,minimize:i,open:n,close:s},void 0,interpolate(pgettext("edit reply","Edit reply by %(poster)s from %(date)s"),{poster:c.poster?c.poster.username:c.poster_name,date:c.posted_on.fromNow()},!0)),(0,o.Z)(Ot,{},void 0,t))};function ns(e){switch(e.mode){case"START":return i.createElement(Kt,e);case"START_PRIVATE":return i.createElement(es,e);case"REPLY":return i.createElement(ss,e);case"EDIT":return i.createElement(is,e);default:return null}}},2891:(e,t,s)=>{"use strict";s.d(t,{Jh:()=>n,jn:()=>o});var a=s(5210),i=s(2233);function o(){return[(0,a.Ei)(i.Z.get("SETTINGS").thread_title_length_min,((e,t)=>{const s=ngettext("Thread title should be at least %(limit_value)s character long (it has %(show_value)s).","Thread title should be at least %(limit_value)s characters long (it has %(show_value)s).",e);return interpolate(s,{limit_value:e,show_value:t},!0)})),(0,a.BS)(i.Z.get("SETTINGS").thread_title_length_max,((e,t)=>{const s=ngettext("Thread title cannot be longer than %(limit_value)s character (it has %(show_value)s).","Thread title cannot be longer than %(limit_value)s characters (it has %(show_value)s).",e);return interpolate(s,{limit_value:e,show_value:t},!0)}))]}function n(){return i.Z.get("SETTINGS").post_length_max?[r(),(0,a.BS)(i.Z.get("SETTINGS").post_length_max||1e6,((e,t)=>{const s=ngettext("Posted message cannot be longer than %(limit_value)s character (it has %(show_value)s).","Posted message cannot be longer than %(limit_value)s characters (it has %(show_value)s).",e);return interpolate(s,{limit_value:e,show_value:t},!0)}))]:[r()]}function r(){return(0,a.Ei)(i.Z.get("SETTINGS").post_length_min,((e,t)=>{const s=ngettext("Posted message should be at least %(limit_value)s character long (it has %(show_value)s).","Posted message should be at least %(limit_value)s characters long (it has %(show_value)s).",e);return interpolate(s,{limit_value:e,show_value:t},!0)}))}},471:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var a=s(2928),i=s(7294);const o=class extends i.Component{getChoice(){let e=null;return this.props.choices.map((t=>{t.value===this.props.value&&(e=t)})),e}getIcon(){return this.getChoice().icon}getLabel(){return this.getChoice().label}change=e=>()=>{this.props.onChange({target:{value:e}})};render(){return(0,a.Z)("div",{className:"btn-group btn-select-group"},void 0,(0,a.Z)("button",{type:"button",className:"btn btn-select dropdown-toggle",id:this.props.id||null,"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false","aria-describedby":this.props["aria-describedby"]||null,disabled:this.props.disabled||!1},void 0,(0,a.Z)(n,{icon:this.getIcon()}),this.getLabel()),(0,a.Z)("ul",{className:"dropdown-menu"},void 0,this.props.choices.map(((e,t)=>(0,a.Z)("li",{},t,(0,a.Z)("button",{type:"button",className:"btn-link",onClick:this.change(e.value)},void 0,(0,a.Z)(n,{icon:e.icon}),e.label))))))}};function n(e){let{icon:t}=e;return t?(0,a.Z)("span",{className:"material-icon"},void 0,t):null}},4467:(e,t,s)=>{"use strict";s.d(t,{Z:()=>m});var a,i=s(2928),o=(s(7294),s(2233)),n=s(2211),r=s(3345),l=s(7235),d=s(8657),c=s(9801),p=s(3904),u=s(3051),h=s(9755);const m=class extends r.Z{constructor(e){super(e),this.state={isLoading:!1,showActivation:!1,username:"",password:"",validators:{username:[],password:[]}}}clean(){return!!this.isValid()||(p.Z.error(gettext("Fill out both fields.")),!1)}send(){return d.Z.post(o.Z.get("AUTH_API"),{username:this.state.username,password:this.state.password})}handleSuccess(){let e=h("#hidden-login-form");e.append('<input type="text" name="username" />'),e.append('<input type="password" name="password" />'),e.find('input[type="hidden"]').val(d.Z.getCsrfToken()),e.find('input[name="redirect_to"]').val(window.location.pathname),e.find('input[name="username"]').val(this.state.username),e.find('input[name="password"]').val(this.state.password),e.submit(),this.setState({isLoading:!0})}handleError(e){400===e.status?"inactive_admin"===e.code?p.Z.info(e.detail):"inactive_user"===e.code?(p.Z.info(e.detail),this.setState({showActivation:!0})):"banned"===e.code?((0,u.Z)(e.detail),c.Z.hide()):p.Z.error(e.detail):403===e.status&&e.ban?((0,u.Z)(e.ban),c.Z.hide()):p.Z.apiError(e)}getActivationButton(){return this.state.showActivation?(0,i.Z)("a",{className:"btn btn-success btn-block",href:o.Z.get("REQUEST_ACTIVATION_URL")},void 0,gettext("Activate account")):null}render(){return(0,i.Z)("div",{className:"modal-dialog modal-sm modal-sign-in",role:"document"},void 0,(0,i.Z)("div",{className:"modal-content"},void 0,(0,i.Z)("div",{className:"modal-header"},void 0,(0,i.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,a||(a=(0,i.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,i.Z)("h4",{className:"modal-title"},void 0,gettext("Sign in"))),(0,i.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,i.Z)("div",{className:"modal-body"},void 0,(0,i.Z)(l.Z,{buttonLabel:gettext("Sign in with %(site)s"),formLabel:gettext("Or use your forum account:"),labelClassName:"text-center"}),(0,i.Z)("div",{className:"form-group"},void 0,(0,i.Z)("div",{className:"control-input"},void 0,(0,i.Z)("input",{className:"form-control input-lg",disabled:this.state.isLoading,id:"id_username",onChange:this.bindInput("username"),placeholder:gettext("Username or e-mail"),type:"text",value:this.state.username}))),(0,i.Z)("div",{className:"form-group"},void 0,(0,i.Z)("div",{className:"control-input"},void 0,(0,i.Z)("input",{className:"form-control input-lg",disabled:this.state.isLoading,id:"id_password",onChange:this.bindInput("password"),placeholder:gettext("Password"),type:"password",value:this.state.password})))),(0,i.Z)("div",{className:"modal-footer"},void 0,this.getActivationButton(),(0,i.Z)(n.Z,{className:"btn-primary btn-block",loading:this.state.isLoading},void 0,gettext("Sign in")),(0,i.Z)("a",{className:"btn btn-default btn-block",href:o.Z.get("FORGOTTEN_PASSWORD_URL")},void 0,gettext("Forgot password?"))))))}}},4678:(e,t,s)=>{"use strict";s.d(t,{Jj:()=>n,ZP:()=>o,pg:()=>r});var a=s(2928),i=s(7294);const o=class extends i.Component{getClass(){return function(e){let t="";return e.is_banned?t="banned":e.is_hidden?t="offline":e.is_online_hidden?t="online":e.is_offline_hidden?t="offline":e.is_online?t="online":e.is_offline&&(t="offline"),"user-status user-"+t}(this.props.status)}render(){return(0,a.Z)("span",{className:this.getClass()},void 0,this.props.children)}};class n extends i.Component{getIcon(){return this.props.status.is_banned?"remove_circle_outline":this.props.status.is_hidden?"help_outline":this.props.status.is_online_hidden?"label":this.props.status.is_offline_hidden?"label_outline":this.props.status.is_online?"lens":this.props.status.is_offline?"panorama_fish_eye":void 0}render(){return(0,a.Z)("span",{className:"material-icon status-icon"},void 0,this.getIcon())}}class r extends i.Component{getHelp(){return e=this.props.user,(t=this.props.status).is_banned?t.banned_until?interpolate(gettext("%(username)s is banned until %(ban_expires)s"),{username:e.username,ban_expires:t.banned_until.format("LL, LT")},!0):interpolate(gettext("%(username)s is banned"),{username:e.username},!0):t.is_hidden?interpolate(gettext("%(username)s is hiding presence"),{username:e.username},!0):t.is_online_hidden?interpolate(gettext("%(username)s is online (hidden)"),{username:e.username},!0):t.is_offline_hidden?interpolate(gettext("%(username)s was last seen %(last_click)s (hidden)"),{username:e.username,last_click:t.last_click.fromNow()},!0):t.is_online?interpolate(gettext("%(username)s is online"),{username:e.username},!0):t.is_offline?interpolate(gettext("%(username)s was last seen %(last_click)s"),{username:e.username,last_click:t.last_click.fromNow()},!0):void 0;var e,t}getLabel(){return this.props.status.is_banned?gettext("Banned"):this.props.status.is_hidden?gettext("Hidden"):this.props.status.is_online_hidden?gettext("Online (hidden)"):this.props.status.is_offline_hidden?gettext("Offline (hidden)"):this.props.status.is_online?gettext("Online"):this.props.status.is_offline?gettext("Offline"):void 0}render(){return(0,a.Z)("span",{className:this.props.className||"status-label",title:this.getHelp()},void 0,this.getLabel())}}},7850:(e,t,s)=>{"use strict";s.d(t,{Z:()=>Z});var a=s(2928),i=s(7294);const o=class extends i.Component{getEmptyMessage(){return this.props.emptyMessage?this.props.emptyMessage:gettext("No name changes have been recorded for your account.")}render(){return(0,a.Z)("div",{className:"username-history ui-ready"},void 0,(0,a.Z)("ul",{className:"list-group"},void 0,(0,a.Z)("li",{className:"list-group-item empty-message"},void 0,this.getEmptyMessage())))}};var n,r,l=s(9605);const d=class extends i.Component{renderUserAvatar(){return this.props.change.changed_by?(0,a.Z)("a",{href:this.props.change.changed_by.url,className:"user-avatar-wrapper"},void 0,(0,a.Z)(l.ZP,{user:this.props.change.changed_by,size:"100"})):n||(n=(0,a.Z)("span",{className:"user-avatar-wrapper"},void 0,(0,a.Z)(l.ZP,{size:"100"})))}renderUsername(){return this.props.change.changed_by?(0,a.Z)("a",{href:this.props.change.changed_by.url,className:"item-title"},void 0,this.props.change.changed_by.username):(0,a.Z)("span",{className:"item-title"},void 0,this.props.change.changed_by_username)}render(){return(0,a.Z)("li",{className:"list-group-item"},this.props.change.id,(0,a.Z)("div",{className:"change-avatar"},void 0,this.renderUserAvatar()),(0,a.Z)("div",{className:"change-author"},void 0,this.renderUsername()),(0,a.Z)("div",{className:"change"},void 0,(0,a.Z)("span",{className:"old-username"},void 0,this.props.change.old_username),r||(r=(0,a.Z)("span",{className:"material-icon"},void 0,"arrow_forward")),(0,a.Z)("span",{className:"new-username"},void 0,this.props.change.new_username)),(0,a.Z)("div",{className:"change-date"},void 0,(0,a.Z)("abbr",{title:this.props.change.changed_on.format("LLL")},void 0,this.props.change.changed_on.fromNow())))}},c=class extends i.Component{render(){return(0,a.Z)("div",{className:"username-history ui-ready"},void 0,(0,a.Z)("ul",{className:"list-group"},void 0,this.props.changes.map((e=>(0,a.Z)(d,{change:e},e.id)))))}};var p,u,h=s(4039);const m=class extends i.Component{shouldComponentUpdate(){return!1}getClassName(){return this.props.hiddenOnMobile?"list-group-item hidden-xs hidden-sm":"list-group-item"}render(){return(0,a.Z)("li",{className:this.getClassName()},void 0,p||(p=(0,a.Z)("div",{className:"change-avatar"},void 0,(0,a.Z)("span",{className:"user-avatar"},void 0,(0,a.Z)(l.ZP,{size:"100"})))),(0,a.Z)("div",{className:"change-author"},void 0,(0,a.Z)("span",{className:"ui-preview-text",style:{width:h.e(30,100)+"px"}},void 0," ")),(0,a.Z)("div",{className:"change"},void 0,(0,a.Z)("span",{className:"ui-preview-text",style:{width:h.e(30,70)+"px"}},void 0," "),u||(u=(0,a.Z)("span",{className:"material-icon"},void 0,"arrow_forward")),(0,a.Z)("span",{className:"ui-preview-text",style:{width:h.e(30,70)+"px"}},void 0," ")),(0,a.Z)("div",{className:"change-date"},void 0,(0,a.Z)("span",{className:"ui-preview-text",style:{width:h.e(80,140)+"px"}},void 0," ")))}},v=class extends i.Component{shouldComponentUpdate(){return!1}render(){return(0,a.Z)("div",{className:"username-history ui-preview"},void 0,(0,a.Z)("ul",{className:"list-group"},void 0,[0,1,2].map((e=>(0,a.Z)(m,{hiddenOnMobile:e>0},e)))))}};var g;const Z=class extends i.Component{render(){return this.props.isLoaded?this.props.changes.length?(0,a.Z)(c,{changes:this.props.changes}):(0,a.Z)(o,{emptyMessage:this.props.emptyMessage}):g||(g=(0,a.Z)(v,{}))}}},429:(e,t,s)=>{"use strict";s.d(t,{Z:()=>w});var a,i=s(2928),o=s(7294),n=s(9605),r=s(4678);function l(e){let{showStatus:t,user:s}=e;return(0,i.Z)("ul",{className:"list-unstyled"},void 0,(0,i.Z)(d,{showStatus:t,user:s}),(0,i.Z)(c,{user:s}),a||(a=(0,i.Z)("li",{className:"user-stat-divider"})),(0,i.Z)(p,{user:s}),(0,i.Z)(u,{user:s}),(0,i.Z)(h,{user:s}))}function d(e){let{showStatus:t,user:s}=e;return t?(0,i.Z)("li",{className:"user-stat-status"},void 0,(0,i.Z)(r.ZP,{status:s.status},void 0,(0,i.Z)(r.pg,{status:s.status,user:s}))):null}function c(e){let{user:t}=e;const{joined_on:s}=t;let a=interpolate(gettext("Joined on %(joined_on)s"),{joined_on:s.format("LL, LT")},!0),o=interpolate(gettext("Joined %(joined_on)s"),{joined_on:s.fromNow()},!0);return(0,i.Z)("li",{className:"user-stat-join-date"},void 0,(0,i.Z)("abbr",{title:a},void 0,o))}function p(e){let{user:t}=e;const s=m("user-stat-posts",t.posts),a=ngettext("%(posts)s post","%(posts)s posts",t.posts);return(0,i.Z)("li",{className:s},void 0,interpolate(a,{posts:t.posts},!0))}function u(e){let{user:t}=e;const s=m("user-stat-threads",t.threads),a=ngettext("%(threads)s thread","%(threads)s threads",t.threads);return(0,i.Z)("li",{className:s},void 0,interpolate(a,{threads:t.threads},!0))}function h(e){let{user:t}=e;const s=m("user-stat-followers",t.followers),a=ngettext("%(followers)s follower","%(followers)s followers",t.followers);return(0,i.Z)("li",{className:s},void 0,interpolate(a,{followers:t.followers},!0))}function m(e,t){return 0===t?e+" user-stat-empty":e}function v(e){let{rank:t,title:s}=e,a=s||t.title||t.name,o="user-title";return t.css_class&&(o+=" user-title-"+t.css_class),t.is_tab?(0,i.Z)("a",{className:o,href:t.url},void 0,a):(0,i.Z)("span",{className:o},void 0,a)}function g(e){let{showStatus:t,user:s}=e;const{rank:a}=s;let o="panel user-card";return a.css_class&&(o+=" user-card-"+a.css_class),(0,i.Z)("div",{className:o},void 0,(0,i.Z)("div",{className:"panel-body"},void 0,(0,i.Z)("div",{className:"row"},void 0,(0,i.Z)("div",{className:"col-xs-3 user-card-left"},void 0,(0,i.Z)("div",{className:"user-card-small-avatar"},void 0,(0,i.Z)("a",{href:s.url},void 0,(0,i.Z)(n.ZP,{size:"50",size2x:"80",user:s})))),(0,i.Z)("div",{className:"col-xs-9 col-sm-12 user-card-body"},void 0,(0,i.Z)("div",{className:"user-card-avatar"},void 0,(0,i.Z)("a",{href:s.url},void 0,(0,i.Z)(n.ZP,{size:"150",size2x:"200",user:s}))),(0,i.Z)("div",{className:"user-card-username"},void 0,(0,i.Z)("a",{href:s.url},void 0,s.username)),(0,i.Z)("div",{className:"user-card-title"},void 0,(0,i.Z)(v,{rank:a,title:s.title})),(0,i.Z)("div",{className:"user-card-stats"},void 0,(0,i.Z)(l,{showStatus:t,user:s}))))))}var Z,b,_,f=s(4039);const N=class extends o.Component{shouldComponentUpdate(){return!1}render(){return(0,i.Z)("div",{className:"panel user-card user-card-preview"},void 0,(0,i.Z)("div",{className:"panel-body"},void 0,(0,i.Z)("div",{className:"row"},void 0,Z||(Z=(0,i.Z)("div",{className:"col-xs-3 user-card-left"},void 0,(0,i.Z)("div",{className:"user-card-small-avatar"},void 0,(0,i.Z)("span",{},void 0,(0,i.Z)(n.ZP,{size:"50",size2x:"80"}))))),(0,i.Z)("div",{className:"col-xs-9 col-sm-12 user-card-body"},void 0,b||(b=(0,i.Z)("div",{className:"user-card-avatar"},void 0,(0,i.Z)("span",{},void 0,(0,i.Z)(n.ZP,{size:"150",size2x:"200"})))),(0,i.Z)("div",{className:"user-card-username"},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:f.e(60,150)+"px"}},void 0," ")),(0,i.Z)("div",{className:"user-card-title"},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:f.e(60,150)+"px"}},void 0," ")),(0,i.Z)("div",{className:"user-card-stats"},void 0,(0,i.Z)("ul",{className:"list-unstyled"},void 0,(0,i.Z)("li",{},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:f.e(30,70)+"px"}},void 0," ")),(0,i.Z)("li",{},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:f.e(30,70)+"px"}},void 0," ")),_||(_=(0,i.Z)("li",{className:"user-stat-divider"})),(0,i.Z)("li",{},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:f.e(30,70)+"px"}},void 0," ")),(0,i.Z)("li",{},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:f.e(30,70)+"px"}},void 0," "))))))))}};var x;function y(e){let{colClassName:t,cols:s}=e;const a=Array.apply(null,{length:s}).map(Number.call,Number);return(0,i.Z)("div",{className:"users-cards-list ui-preview"},void 0,(0,i.Z)("div",{className:"row"},void 0,a.map((e=>{let s=t;return 0!==e&&(s+=" hidden-xs"),3===e&&(s+=" hidden-sm"),(0,i.Z)("div",{className:s},e,x||(x=(0,i.Z)(N,{})))}))))}function w(e){let{cols:t,isReady:s,showStatus:a,users:o}=e,n="col-xs-12 col-sm-4";return 4===t&&(n+=" col-md-3"),s?(0,i.Z)("div",{className:"users-cards-list ui-ready"},void 0,(0,i.Z)("div",{className:"row"},void 0,o.map((e=>(0,i.Z)("div",{className:n},e.id,(0,i.Z)(g,{showStatus:a,user:e})))))):(0,i.Z)(y,{colClassName:n,cols:t})}},2125:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});var a=s(7294);const i=class extends a.Component{constructor(e){super(e),this.state={dropdown:!1}}toggleNav=()=>{this.setState({dropdown:!this.state.dropdown})};hideNav=()=>{this.setState({dropdown:!1})};getCompactNavClassName(){return this.state.dropdown?"compact-nav open":"compact-nav"}}},7227:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var a=s(2928),i=s(7294);const o=class extends i.Component{getClassName(){return this.props.value?"btn btn-yes-no btn-yes-no-on":"btn btn-yes-no btn-yes-no-off"}getIcon(){return this.props.value?this.props.iconOn||"check_box":this.props.iconOff||"check_box_outline_blank"}getLabel(){return this.props.value?this.props.labelOn||gettext("yes"):this.props.labelOff||gettext("no")}toggle=()=>{this.props.onChange({target:{value:!this.props.value}})};render(){return(0,a.Z)("button",{type:"button",onClick:this.toggle,className:this.getClassName(),id:this.props.id||null,"aria-describedby":this.props["aria-describedby"]||null,disabled:this.props.disabled||!1},void 0,(0,a.Z)("span",{className:"material-icon"},void 0,this.getIcon()),(0,a.Z)("span",{className:"btn-text"},void 0,this.getLabel()))}}},2233:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i}),s(8294),s(5377),s(8852),s(9737),s(4316),s(3204),s(3511),s(7023);var a=new class{constructor(){this._initializers=[],this._context={}}addInitializer(e){this._initializers.push({key:e.name,item:e.initializer,after:e.after,before:e.before})}init(e){this._context=e,new class{constructor(e){this.isOrdered=!1,this._items=e||[]}add(e,t,s){this._items.push({key:e,item:t,after:s&&s.after||null,before:s&&s.before||null})}get(e,t){for(var s=0;s<this._items.length;s++)if(this._items[s].key===e)return this._items[s].item;return t}has(e){return void 0!==this.get(e)}values(){for(var e=[],t=0;t<this._items.length;t++)e.push(this._items[t].item);return e}order(e){return this.isOrdered||(this._items=this._order(this._items),this.isOrdered=!0),e||void 0===e?this.values():this._items}orderedValues(){return this.order(!0)}_order(e){var t=[];e.forEach((function(e){t.push(e.key)}));var s=[],a=[];function i(e){var t=-1;-1===a.indexOf(e.key)&&(e.after?-1!==(t=a.indexOf(e.after))&&(t+=1):e.before&&(t=a.indexOf(e.before)),-1!==t&&(s.splice(t,0,e),a.splice(t,0,e.key)))}e.forEach((function(e){e.after||e.before||(s.push(e),a.push(e.key))})),e.forEach((function(e){"_end"===e.before&&(s.push(e),a.push(e.key))}));for(var o=200;o>0&&t.length!==a.length;)o-=1,e.forEach(i);return s}}(this._initializers).orderedValues().forEach((e=>{e(this)}))}has(e){return!!this._context[e]}get(e,t){return this.has(e)?this._context[e]:t||void 0}pop(e){if(this.has(e)){let t=this._context[e];return this._context[e]=null,t}}};window.misago=a;const i=a},8339:(e,t,s)=>{"use strict";var a=s(2233),i=s(8657);a.Z.addInitializer({name:"ajax",initializer:function(){i.Z.init(a.Z.get("CSRF_COOKIE_NAME"))}})},4109:(e,t,s)=>{"use strict";var a=s(2233),i=s(5486),o=s(8657),n=s(3904),r=s(287);a.Z.addInitializer({name:"auth-sync",initializer:function(e){e.get("isAuthenticated")&&window.setInterval((function(){o.Z.get(e.get("AUTH_API")).then((function(e){r.Z.dispatch((0,i.r$)(e))}),(function(e){n.Z.apiError(e)}))}),45e3)},after:"auth"})},6226:(e,t,s)=>{"use strict";var a=s(2233),i=s(8274),o=s(9801),n=s(287),r=s(2833);a.Z.addInitializer({name:"auth",initializer:function(){i.Z.init(n.Z,r.Z,o.Z)},after:"store"})},3240:(e,t,s)=>{"use strict";var a=s(2233),i=s(8657),o=s(3825),n=s(6142),r=s(3904);a.Z.addInitializer({name:"captcha",initializer:function(e){o.ZP.init(e,i.Z,n.Z,r.Z)}})},5147:(e,t,s)=>{"use strict";var a=s(2928),i=s(7294),o=s(2233),n=s(8657);class r extends i.Component{constructor(e){super(e),this.state={submiting:!1}}handleDecline=()=>{this.state.submiting||window.confirm(gettext("Declining will result in immediate deactivation and deletion of your account. This action is not reversible."))&&(this.setState({submiting:!0}),n.Z.post(this.props.api,{accept:!1}).then((()=>{window.location.reload(!0)})))};handleAccept=()=>{this.state.submiting||(this.setState({submiting:!0}),n.Z.post(this.props.api,{accept:!0}).then((()=>{window.location.reload(!0)})))};render(){return(0,a.Z)("div",{},void 0,(0,a.Z)("button",{className:"btn btn-default",disabled:this.state.submiting,type:"buton",onClick:this.handleDecline},void 0,gettext("Decline")),(0,a.Z)("button",{className:"btn btn-primary",disabled:this.state.submiting,type:"buton",onClick:this.handleAccept},void 0,gettext("Accept and continue")))}}var l=s(4869);o.Z.addInitializer({name:"component:accept-agreement",initializer:function(e){document.getElementById("required-agreement-mount")&&(0,l.Z)((0,a.Z)(r,{api:e.get("REQUIRED_AGREEMENT_API")}),"required-agreement-mount",!1)},after:"store"})},4894:(e,t,s)=>{"use strict";var a=s(7785),i=s(2233),o=s(2928),n=s(7294);const r=class extends n.Component{refresh(){window.location.reload()}getMessage(){return this.props.signedIn?interpolate(gettext("You have signed in as %(username)s. Please refresh the page before continuing."),{username:this.props.signedIn.username},!0):this.props.signedOut?interpolate(gettext("%(username)s, you have been signed out. Please refresh the page before continuing."),{username:this.props.user.username},!0):void 0}render(){let e="auth-message";return(this.props.signedIn||this.props.signedOut)&&(e+=" show"),(0,o.Z)("div",{className:e},void 0,(0,o.Z)("div",{className:"container"},void 0,(0,o.Z)("p",{className:"lead"},void 0,this.getMessage()),(0,o.Z)("p",{},void 0,(0,o.Z)("button",{className:"btn btn-default",type:"button",onClick:this.refresh},void 0,gettext("Reload page")),(0,o.Z)("span",{className:"hidden-xs hidden-sm"},void 0," "+gettext("or press F5 key.")))))}};function l(e){return{user:e.auth.user,signedIn:e.auth.signedIn,signedOut:e.auth.signedOut}}var d=s(4869);i.Z.addInitializer({name:"component:auth-message",initializer:function(){(0,d.Z)((0,a.$j)(l)(r),"auth-message-mount")},after:"store"})},9223:(e,t,s)=>{"use strict";var a=s(2233),i=s(3051);a.Z.addInitializer({name:"component:banmed-page",initializer:function(e){e.has("BAN_MESSAGE")&&(0,i.Z)(e.get("BAN_MESSAGE"),!1)},after:"store"})},3026:(e,t,s)=>{"use strict";var a=s(7785),i=s(2928),o=s(381),n=s.n(o),r=s(7294);function l(e){return(0,i.Z)("div",{className:"categories-list"},void 0,(0,i.Z)("ul",{className:"list-group"},void 0,(0,i.Z)("li",{className:"list-group-item empty-message"},void 0,(0,i.Z)("p",{className:"lead"},void 0,gettext("No categories exist or you don't have permission to see them.")))))}function d(e){let{category:t}=e;return t.description?(0,i.Z)("div",{className:"category-description",dangerouslySetInnerHTML:{__html:t.description.html}}):null}function c(e){let{category:t}=e;return(0,i.Z)("div",{className:p(t),title:u(t)},void 0,(0,i.Z)("span",{className:"material-icon"},void 0,function(e){return e.is_closed?e.is_read?"lock_outline":"lock":e.is_read?"chat_bubble_outline":"chat_bubble"}(t)))}function p(e){return e.is_read?"read-status item-read":"read-status item-new"}function u(e){return e.is_closed?e.is_read?gettext("This category has no new posts. (closed)"):gettext("This category has new posts. (closed)"):e.is_read?gettext("This category has no new posts."):gettext("This category has new posts.")}function h(e){let{category:t}=e;return(0,i.Z)("div",{className:"col-xs-12 col-sm-6 col-md-6 category-main"},void 0,(0,i.Z)("div",{className:"media"},void 0,(0,i.Z)("div",{className:"media-left"},void 0,(0,i.Z)(c,{category:t})),(0,i.Z)("div",{className:"media-body"},void 0,(0,i.Z)("h4",{className:"media-heading"},void 0,(0,i.Z)("a",{href:t.url.index},void 0,t.name)),(0,i.Z)(d,{category:t}))))}var m,v,g,Z=s(9605);function b(e){let{category:t}=e;return(0,i.Z)("div",{className:"col-xs-12 col-sm-6 col-md-4 category-last-thread"},void 0,(0,i.Z)(_,{category:t}),(0,i.Z)(x,{category:t}),(0,i.Z)(y,{category:t}),(0,i.Z)(w,{category:t}))}function _(e){let{category:t}=e;return t.acl.can_browse&&t.acl.can_see_all_threads&&t.last_thread_title?(0,i.Z)("div",{className:"media"},void 0,(0,i.Z)("div",{className:"media-left hidden-xs"},void 0,(0,i.Z)(f,{category:t})),(0,i.Z)("div",{className:"media-body"},void 0,(0,i.Z)("div",{className:"media-heading"},void 0,(0,i.Z)("a",{className:"item-title thread-title",href:t.url.last_thread_new,title:t.last_thread_title},void 0,t.last_thread_title)),(0,i.Z)("ul",{className:"list-inline"},void 0,(0,i.Z)("li",{className:"category-last-thread-poster"},void 0,(0,i.Z)(N,{category:t})),m||(m=(0,i.Z)("li",{className:"divider"},void 0,"—")),(0,i.Z)("li",{className:"category-last-thread-date"},void 0,(0,i.Z)("a",{href:t.url.last_post},void 0,t.last_post_on.fromNow()))))):null}function f(e){let{category:t}=e;return t.last_poster?(0,i.Z)("a",{className:"last-poster-avatar",href:t.last_poster.url,title:t.last_poster_name},void 0,(0,i.Z)(Z.ZP,{className:"media-object",size:40,user:t.last_poster})):(0,i.Z)("span",{className:"last-poster-avatar",title:t.last_poster_name},void 0,v||(v=(0,i.Z)(Z.ZP,{className:"media-object",size:40})))}function N(e){let{category:t}=e;return t.last_poster?(0,i.Z)("a",{className:"item-title",href:t.last_poster.url},void 0,t.last_poster_name):(0,i.Z)("span",{className:"item-title"},void 0,t.last_poster_name)}function x(e){let{category:t}=e;return t.acl.can_browse&&t.acl.can_see_all_threads?t.last_thread_title?null:(0,i.Z)(k,{message:gettext("This category is empty. No threads were posted within it so far.")}):null}function y(e){let{category:t}=e;return t.acl.can_browse?t.acl.can_see_all_threads?null:(0,i.Z)(k,{message:gettext("This category is private. You can see only your own threads within it.")}):null}function w(e){let{category:t}=e;return t.acl.can_browse?null:(0,i.Z)(k,{message:gettext("This category is protected. You can't browse its contents.")})}function k(e){let{message:t}=e;return(0,i.Z)("div",{className:"media category-thread-message"},void 0,g||(g=(0,i.Z)("div",{className:"media-left"},void 0,(0,i.Z)("span",{className:"material-icon"},void 0,"info_outline"))),(0,i.Z)("div",{className:"media-body"},void 0,(0,i.Z)("p",{},void 0,t)))}function C(e){let{category:t}=e;return(0,i.Z)("div",{className:"col-md-2 hidden-xs hidden-sm"},void 0,(0,i.Z)("ul",{className:"list-unstyled category-stats"},void 0,(0,i.Z)(S,{threads:t.threads}),(0,i.Z)(E,{posts:t.posts})))}function S(e){let{threads:t}=e;const s=ngettext("%(threads)s thread","%(threads)s threads",t);return(0,i.Z)("li",{className:"category-stat-threads"},void 0,interpolate(s,{threads:t},!0))}function E(e){let{posts:t}=e;const s=ngettext("%(posts)s post","%(posts)s posts",t);return(0,i.Z)("li",{className:"category-stat-posts"},void 0,interpolate(s,{posts:t},!0))}function L(e){let{category:t}=e,s="btn btn-default btn-block btn-sm btn-subcategory";return t.is_read||(s+=" btn-subcategory-new"),(0,i.Z)("div",{className:"col-xs-12 col-sm-4 col-md-3"},void 0,(0,i.Z)("a",{className:s,href:t.url.index},void 0,(0,i.Z)("span",{className:"material-icon"},void 0,function(e){return e.is_closed?e.is_read?"lock_outline":"lock":e.is_read?"chat_bubble_outline":"chat_bubble"}(t)),(0,i.Z)("span",{className:"icon-text"},void 0,t.name)))}function T(e){let{category:t,isFirst:s}=e;return s||0===t.subcategories.length?null:(0,i.Z)("div",{className:"row subcategories-list"},void 0,t.subcategories.map((e=>(0,i.Z)(L,{category:e},e.id))))}function P(e){let{category:t,isFirst:s}=e,a="list-group-item";return t.description?a+=" list-group-category-has-description":a+=" list-group-category-no-description",s&&(a+=" list-group-item-first"),t.css_class&&(a+=" list-group-category-has-flavor",a+=" list-group-item-category-"+t.css_class),(0,i.Z)("li",{className:a},void 0,(0,i.Z)("div",{className:"row"},void 0,(0,i.Z)(h,{category:t}),(0,i.Z)(C,{category:t}),(0,i.Z)(b,{category:t})),(0,i.Z)(T,{category:t,isFirst:s}))}function O(e){let{category:t}=e,s="list-group list-group-category";return t.css_class&&(s+=" list-group-category-has-flavor",s+=" list-group-category-"+t.css_class),(0,i.Z)("ul",{className:s},void 0,(0,i.Z)(P,{category:t,isFirst:!0}),t.subcategories.map((e=>(0,i.Z)(P,{category:e,isFirst:!1},e.id))))}function R(e){let{categories:t}=e;return(0,i.Z)("div",{className:"categories-list"},void 0,t.map((e=>(0,i.Z)(O,{category:e},e.id))))}var A,I=s(2233),D=s(5547);const j=function(e){return Object.assign({},e,{last_post_on:e.last_post_on?n()(e.last_post_on):null,subcategories:e.subcategories.map(j)})},z=class extends r.Component{constructor(e){super(e),this.state={categories:I.Z.get("CATEGORIES").map(j)},this.startPolling(I.Z.get("CATEGORIES_API"))}startPolling(e){D.Z.start({poll:"categories",url:e,frequency:18e4,update:this.update})}update=e=>{this.setState({categories:e.map(j)})};render(){const{categories:e}=this.state;return 0===e.length?A||(A=(0,i.Z)(l,{})):(0,i.Z)(R,{categories:e})}};function U(e){return{tick:e.tick.tick}}var M=s(4869);I.Z.addInitializer({name:"component:categories",initializer:function(){document.getElementById("categories-mount")&&(0,M.Z)((0,a.$j)(U)(z),"categories-mount")},after:"store"})},4795:(e,t,s)=>{"use strict";var a=s(2928),i=s(7294),o=s(7785),n=s(9655),r=s(4417);function l(e){return(0,a.Z)("div",{className:"list-group nav-side"},void 0,e.options.map((t=>(0,a.Z)(n.rU,{to:e.baseUrl+t.component+"/",className:"list-group-item",activeClassName:"active"},t.component,(0,a.Z)("span",{className:"material-icon"},void 0,t.icon),t.name))))}function d(e){return(0,a.Z)("ul",{className:e.className||"dropdown-menu",role:"menu"},void 0,e.options.map((t=>(0,a.Z)(r.Z,{path:e.baseUrl+t.component+"/"},t.component,(0,a.Z)(n.rU,{to:e.baseUrl+t.component+"/",onClick:e.hideNav},void 0,(0,a.Z)("span",{className:"material-icon hidden-sm"},void 0,t.icon),t.name)))))}var c,p=s(2211),u=s(8657),h=s(3328),m=s(3904),v=s(287),g=s(2233);const Z=class extends i.Component{constructor(e){super(e),this.state={isLoading:!1,password:""}}componentDidMount(){h.Z.set({title:gettext("Delete account"),parent:gettext("Change your options")})}onPasswordChange=e=>{this.setState({password:e.target.value})};handleSubmit=e=>{e.preventDefault();const{isLoading:t,password:s}=this.state,{user:a}=this.props;return 0==s.length?(m.Z.error(gettext("Enter your password to confirm account deletion.")),!1):!t&&(this.setState({isLoading:!0}),void u.Z.post(a.api.delete,{password:s}).then((e=>{window.location.href=g.Z.get("MISAGO_PATH")}),(e=>{this.setState({isLoading:!1}),e.password?m.Z.error(e.password[0]):m.Z.apiError(e)})))};render(){return(0,a.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,a.Z)("div",{className:"panel panel-danger panel-form"},void 0,(0,a.Z)("div",{className:"panel-heading"},void 0,(0,a.Z)("h3",{className:"panel-title"},void 0,gettext("Delete account"))),(0,a.Z)("div",{className:"panel-body"},void 0,(0,a.Z)("p",{className:"lead"},void 0,gettext("You are going to delete your account. This action is nonreversible, and will result in following data being deleted:")),(0,a.Z)("p",{},void 0,"-"," ",gettext("Stored IP addresses associated with content that you have posted will be deleted.")),(0,a.Z)("p",{},void 0,"-"," ",gettext("Your username will become available for other user to rename to or for new user to register their account with.")),(0,a.Z)("p",{},void 0,"-"," ",gettext("Your e-mail will become available for use in new account registration.")),c||(c=(0,a.Z)("hr",{})),(0,a.Z)("p",{},void 0,gettext("All your posted content will NOT be deleted, but username associated with it will be changed to one shared by all deleted accounts."))),(0,a.Z)("div",{className:"panel-footer"},void 0,(0,a.Z)("div",{className:"input-group"},void 0,(0,a.Z)("input",{className:"form-control",disabled:this.state.isLoading,name:"password-confirmation",type:"password",placeholder:gettext("Enter your password to confirm account deletion."),value:this.state.password,onChange:this.onPasswordChange}),(0,a.Z)("span",{className:"input-group-btn"},void 0,(0,a.Z)(p.Z,{className:"btn-danger",loading:this.state.isLoading},void 0,gettext("Delete my account")))))))}};var b=s(5247);const _=class extends i.Component{componentDidMount(){h.Z.set({title:gettext("Edit details"),parent:gettext("Change your options")})}onSuccess=()=>{m.Z.info(gettext("Your details have been updated."))};render(){return(0,a.Z)(b.Z,{api:this.props.user.api.edit_details,onSuccess:this.onSuccess})}};var f=s(381),N=s.n(f);class x extends i.Component{constructor(e){super(e),this.state={isLoading:!1,isSubmiting:!1,downloads:[]}}componentDidMount(){h.Z.set({title:gettext("Download your data"),parent:gettext("Change your options")}),this.handleLoadDownloads()}handleLoadDownloads=()=>{u.Z.get(this.props.user.api.data_downloads).then((e=>{this.setState({isLoading:!1,downloads:e})}),(e=>{m.Z.apiError(e)}))};handleRequestDataDownload=()=>{this.setState({isSubmiting:!0}),u.Z.post(this.props.user.api.request_data_download).then((()=>{this.handleLoadDownloads(),m.Z.success(gettext("Your request for data download has been registered.")),this.setState({isSubmiting:!1})}),(e=>{m.Z.apiError(e),this.setState({isSubmiting:!1})}))};render(){return(0,a.Z)("div",{},void 0,(0,a.Z)("div",{className:"panel panel-default panel-form"},void 0,(0,a.Z)("div",{className:"panel-heading"},void 0,(0,a.Z)("h3",{className:"panel-title"},void 0,gettext("Download your data"))),(0,a.Z)("div",{className:"panel-body"},void 0,(0,a.Z)("p",{},void 0,gettext('To download your data from the site, click the "Request data download" button. Depending on amount of data to be archived and number of users wanting to download their data at same time it may take up to few days for your download to be prepared. An e-mail with notification will be sent to you when your data is ready to be downloaded.')),(0,a.Z)("p",{},void 0,gettext("The download will only be available for limited amount of time, after which it will be deleted from the site and marked as expired."))),(0,a.Z)("table",{className:"table"},void 0,(0,a.Z)("thead",{},void 0,(0,a.Z)("tr",{},void 0,(0,a.Z)("th",{},void 0,gettext("Requested on")),(0,a.Z)("th",{className:"col-md-4"},void 0,gettext("Download")))),(0,a.Z)("tbody",{},void 0,this.state.downloads.map((e=>(0,a.Z)("tr",{},e.id,(0,a.Z)("td",{style:y},void 0,N()(e.requested_on).fromNow()),(0,a.Z)("td",{},void 0,(0,a.Z)(w,{exportFile:e.file,status:e.status}))))),0==this.state.downloads.length?(0,a.Z)("tr",{},void 0,(0,a.Z)("td",{colSpan:"2"},void 0,gettext("You have no data downloads."))):null)),(0,a.Z)("div",{className:"panel-footer text-right"},void 0,(0,a.Z)(p.Z,{className:"btn-primary",loading:this.state.isSubmiting,type:"button",onClick:this.handleRequestDataDownload},void 0,gettext("Request data download")))))}}const y={verticalAlign:"middle"},w=e=>{let{exportFile:t,status:s}=e;return 0===s||1===s?(0,a.Z)(p.Z,{className:"btn-info btn-sm btn-block",disabled:!0,type:"button"},void 0,gettext("Download is being prepared")):t?(0,a.Z)("a",{className:"btn btn-success btn-sm btn-block",href:t},void 0,gettext("Download your data")):(0,a.Z)(p.Z,{className:"btn-default btn-sm btn-block",disabled:!0,type:"button"},void 0,gettext("Download is expired"))};var k=s(3345),C=s(6359),S=s(471),E=s(7227),L=s(5486);const T=class extends k.Z{constructor(e){super(e),this.state={isLoading:!1,is_hiding_presence:e.user.is_hiding_presence,limits_private_thread_invites_to:e.user.limits_private_thread_invites_to,subscribe_to_started_threads:e.user.subscribe_to_started_threads,subscribe_to_replied_threads:e.user.subscribe_to_replied_threads,errors:{}},this.privateThreadInvitesChoices=[{value:0,icon:"help_outline",label:gettext("Everybody")},{value:1,icon:"done_all",label:gettext("Users I follow")},{value:2,icon:"highlight_off",label:gettext("Nobody")}],this.subscribeToChoices=[{value:0,icon:"star_border",label:gettext("No")},{value:1,icon:"star_half",label:gettext("Notify")},{value:2,icon:"star",label:gettext("Notify with e-mail")}]}send(){return u.Z.post(this.props.user.api.options,{is_hiding_presence:this.state.is_hiding_presence,limits_private_thread_invites_to:this.state.limits_private_thread_invites_to,subscribe_to_started_threads:this.state.subscribe_to_started_threads,subscribe_to_replied_threads:this.state.subscribe_to_replied_threads})}handleSuccess(){v.Z.dispatch((0,L.r$)({is_hiding_presence:this.state.is_hiding_presence,limits_private_thread_invites_to:this.state.limits_private_thread_invites_to,subscribe_to_started_threads:this.state.subscribe_to_started_threads,subscribe_to_replied_threads:this.state.subscribe_to_replied_threads})),m.Z.success(gettext("Your forum options have been changed."))}handleError(e){400===e.status?m.Z.error(gettext("Please reload page and try again.")):m.Z.apiError(e)}componentDidMount(){h.Z.set({title:gettext("Forum options"),parent:gettext("Change your options")})}render(){return(0,a.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,a.Z)("div",{className:"panel panel-default panel-form"},void 0,(0,a.Z)("div",{className:"panel-heading"},void 0,(0,a.Z)("h3",{className:"panel-title"},void 0,gettext("Change forum options"))),(0,a.Z)("div",{className:"panel-body"},void 0,(0,a.Z)("fieldset",{},void 0,(0,a.Z)("legend",{},void 0,gettext("Privacy settings")),(0,a.Z)(C.Z,{label:gettext("Hide my presence"),helpText:gettext("If you hide your presence, only members with permission to see hidden users will see when you are online."),for:"id_is_hiding_presence"},void 0,(0,a.Z)(E.Z,{id:"id_is_hiding_presence",disabled:this.state.isLoading,iconOn:"visibility_off",iconOff:"visibility",labelOn:gettext("Hide my presence from other users"),labelOff:gettext("Show my presence to other users"),onChange:this.bindInput("is_hiding_presence"),value:this.state.is_hiding_presence})),(0,a.Z)(C.Z,{label:gettext("Private thread invitations"),for:"id_limits_private_thread_invites_to"},void 0,(0,a.Z)(S.Z,{id:"id_limits_private_thread_invites_to",disabled:this.state.isLoading,onChange:this.bindInput("limits_private_thread_invites_to"),value:this.state.limits_private_thread_invites_to,choices:this.privateThreadInvitesChoices}))),(0,a.Z)("fieldset",{},void 0,(0,a.Z)("legend",{},void 0,gettext("Automatic subscriptions")),(0,a.Z)(C.Z,{label:gettext("Threads I start"),for:"id_subscribe_to_started_threads"},void 0,(0,a.Z)(S.Z,{id:"id_subscribe_to_started_threads",disabled:this.state.isLoading,onChange:this.bindInput("subscribe_to_started_threads"),value:this.state.subscribe_to_started_threads,choices:this.subscribeToChoices})),(0,a.Z)(C.Z,{label:gettext("Threads I reply to"),for:"id_subscribe_to_replied_threads"},void 0,(0,a.Z)(S.Z,{id:"id_subscribe_to_replied_threads",disabled:this.state.isLoading,onChange:this.bindInput("subscribe_to_replied_threads"),value:this.state.subscribe_to_replied_threads,choices:this.subscribeToChoices})))),(0,a.Z)("div",{className:"panel-footer"},void 0,(0,a.Z)(p.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,gettext("Save changes")))))}};var P,O=s(5187);function R(){return(0,a.Z)("div",{className:"panel panel-default panel-form"},void 0,(0,a.Z)("div",{className:"panel-heading"},void 0,(0,a.Z)("h3",{className:"panel-title"},void 0,gettext("Change username"))),P||(P=(0,a.Z)(O.Z,{})))}var A=s(3556);const I=class extends i.Component{getHelpText(){return this.props.options.next_on?interpolate(gettext("You will be able to change your username %(next_change)s."),{next_change:this.props.options.next_on.fromNow()},!0):gettext("You have used up available name changes.")}render(){return(0,a.Z)("div",{className:"panel panel-default panel-form"},void 0,(0,a.Z)("div",{className:"panel-heading"},void 0,(0,a.Z)("h3",{className:"panel-title"},void 0,gettext("Change username"))),(0,a.Z)(A.Z,{helpText:this.getHelpText(),message:gettext("You can't change your username at the moment.")}))}};var D=s(5210);const j=class extends k.Z{constructor(e){super(e),this.state={username:"",validators:{username:[D.lG(),D.HR(e.options.length_min),D.gS(e.options.length_max)]},isLoading:!1}}getHelpText(){let e=[];if(this.props.options.changes_left>0){let t=ngettext("You can change your username %(changes_left)s more time.","You can change your username %(changes_left)s more times.",this.props.options.changes_left);e.push(interpolate(t,{changes_left:this.props.options.changes_left},!0))}if(this.props.user.acl.name_changes_expire>0){let t=ngettext("Used changes become available again after %(name_changes_expire)s day.","Used changes become available again after %(name_changes_expire)s days.",this.props.user.acl.name_changes_expire);e.push(interpolate(t,{name_changes_expire:this.props.user.acl.name_changes_expire},!0))}return e.length?e.join(" "):null}clean(){let e=this.validate();return e.username?(m.Z.error(e.username[0]),!1):this.state.username.trim()!==this.props.user.username||(m.Z.info(gettext("Your new username is same as current one.")),!1)}send(){return u.Z.post(this.props.user.api.username,{username:this.state.username})}handleSuccess(e){this.setState({username:""}),this.props.complete(e.username,e.slug,e.options)}handleError(e){m.Z.apiError(e)}render(){return(0,a.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,a.Z)("div",{className:"panel panel-default panel-form"},void 0,(0,a.Z)("div",{className:"panel-heading"},void 0,(0,a.Z)("h3",{className:"panel-title"},void 0,gettext("Change username"))),(0,a.Z)("div",{className:"panel-body"},void 0,(0,a.Z)(C.Z,{label:gettext("New username"),for:"id_username",helpText:this.getHelpText()},void 0,(0,a.Z)("input",{type:"text",id:"id_username",className:"form-control",disabled:this.state.isLoading,onChange:this.bindInput("username"),value:this.state.username}))),(0,a.Z)("div",{className:"panel-footer"},void 0,(0,a.Z)(p.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,gettext("Change username")))))}};var z,U=s(7850),M=s(8927),B=s(6935);const q=class extends i.Component{constructor(e){super(e),this.state={isLoaded:!1,options:null}}componentDidMount(){h.Z.set({title:gettext("Change username"),parent:gettext("Change your options")}),Promise.all([u.Z.get(this.props.user.api.username),u.Z.get(g.Z.get("USERNAME_CHANGES_API"),{user:this.props.user.id})]).then((e=>{v.Z.dispatch((0,M.ZB)(e[1].results)),this.setState({isLoaded:!0,options:{changes_left:e[0].changes_left,length_min:e[0].length_min,length_max:e[0].length_max,next_on:e[0].next_on?N()(e[0].next_on):null}})}))}onComplete=(e,t,s)=>{this.setState({options:s}),v.Z.dispatch((0,M.KP)({username:e,slug:t},this.props.user,this.props.user)),v.Z.dispatch((0,B._S)(this.props.user,e,t)),m.Z.success(gettext("Your username has been changed successfully."))};getChangeForm(){return this.state.isLoaded?0===this.state.options.changes_left?(0,a.Z)(I,{options:this.state.options}):(0,a.Z)(j,{complete:this.onComplete,options:this.state.options,user:this.props.user}):z||(z=(0,a.Z)(R,{}))}render(){return(0,a.Z)("div",{},void 0,this.getChangeForm(),(0,a.Z)(U.Z,{changes:this.props["username-history"],isLoaded:this.state.isLoaded}))}};var H;const F=class extends k.Z{constructor(e){super(e),this.state={new_email:"",password:"",validators:{new_email:[D.Do()],password:[]},isLoading:!1}}clean(){let e=this.validate();return-1!==[this.state.new_email.trim().length,this.state.password.trim().length].indexOf(0)?(m.Z.error(gettext("Fill out all fields.")),!1):!e.new_email||(m.Z.error(e.new_email[0]),!1)}send(){return u.Z.post(this.props.user.api.change_email,{new_email:this.state.new_email,password:this.state.password})}handleSuccess(e){this.setState({new_email:"",password:""}),m.Z.success(e.detail)}handleError(e){400===e.status?e.new_email?m.Z.error(e.new_email):m.Z.error(e.password):m.Z.apiError(e)}render(){return(0,a.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,a.Z)("input",{type:"type",style:{display:"none"}}),(0,a.Z)("input",{type:"password",style:{display:"none"}}),(0,a.Z)("div",{className:"panel panel-default panel-form"},void 0,(0,a.Z)("div",{className:"panel-heading"},void 0,(0,a.Z)("h3",{className:"panel-title"},void 0,gettext("Change e-mail address"))),(0,a.Z)("div",{className:"panel-body"},void 0,(0,a.Z)(C.Z,{label:gettext("New e-mail"),for:"id_new_email"},void 0,(0,a.Z)("input",{type:"text",id:"id_new_email",className:"form-control",disabled:this.state.isLoading,onChange:this.bindInput("new_email"),value:this.state.new_email})),H||(H=(0,a.Z)("hr",{})),(0,a.Z)(C.Z,{label:gettext("Your current password"),for:"id_confirm_email"},void 0,(0,a.Z)("input",{type:"password",id:"id_confirm_email",className:"form-control",disabled:this.state.isLoading,onChange:this.bindInput("password"),value:this.state.password}))),(0,a.Z)("div",{className:"panel-footer"},void 0,(0,a.Z)(p.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,gettext("Change e-mail")))))}};var Y;const V=class extends k.Z{constructor(e){super(e),this.state={new_password:"",repeat_password:"",password:"",validators:{new_password:[],repeat_password:[],password:[]},isLoading:!1}}clean(){let e=this.validate();return-1!==[this.state.new_password.trim().length,this.state.repeat_password.trim().length,this.state.password.trim().length].indexOf(0)?(m.Z.error(gettext("Fill out all fields.")),!1):e.new_password?(m.Z.error(e.new_password[0]),!1):this.state.new_password===this.state.repeat_password||(m.Z.error(gettext("New passwords are different.")),!1)}send(){return u.Z.post(this.props.user.api.change_password,{new_password:this.state.new_password,password:this.state.password})}handleSuccess(e){this.setState({new_password:"",repeat_password:"",password:""}),m.Z.success(e.detail)}handleError(e){400===e.status?e.new_password?m.Z.error(e.new_password):m.Z.error(e.password):m.Z.apiError(e)}render(){return(0,a.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,a.Z)("input",{type:"type",style:{display:"none"}}),(0,a.Z)("input",{type:"password",style:{display:"none"}}),(0,a.Z)("div",{className:"panel panel-default panel-form"},void 0,(0,a.Z)("div",{className:"panel-heading"},void 0,(0,a.Z)("h3",{className:"panel-title"},void 0,gettext("Change password"))),(0,a.Z)("div",{className:"panel-body"},void 0,(0,a.Z)(C.Z,{label:gettext("New password"),for:"id_new_password"},void 0,(0,a.Z)("input",{type:"password",id:"id_new_password",className:"form-control",disabled:this.state.isLoading,onChange:this.bindInput("new_password"),value:this.state.new_password})),(0,a.Z)(C.Z,{label:gettext("Repeat password"),for:"id_repeat_password"},void 0,(0,a.Z)("input",{type:"password",id:"id_repeat_password",className:"form-control",disabled:this.state.isLoading,onChange:this.bindInput("repeat_password"),value:this.state.repeat_password})),Y||(Y=(0,a.Z)("hr",{})),(0,a.Z)(C.Z,{label:gettext("Your current password"),for:"id_confirm_password"},void 0,(0,a.Z)("input",{type:"password",id:"id_confirm_password",className:"form-control",disabled:this.state.isLoading,onChange:this.bindInput("password"),value:this.state.password}))),(0,a.Z)("div",{className:"panel-footer"},void 0,(0,a.Z)(p.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,gettext("Change password")))))}};var G;const $=()=>(0,a.Z)("div",{className:"panel panel-default panel-form"},void 0,(0,a.Z)("div",{className:"panel-heading"},void 0,(0,a.Z)("h3",{className:"panel-title"},void 0,gettext("Change email or password"))),(0,a.Z)("div",{className:"panel-body panel-message-body"},void 0,G||(G=(0,a.Z)("div",{className:"message-icon"},void 0,(0,a.Z)("span",{className:"material-icon"},void 0,"info_outline"))),(0,a.Z)("div",{className:"message-body"},void 0,(0,a.Z)("p",{className:"lead"},void 0,gettext("You need to set a password for your account to be able to change your username or email.")),(0,a.Z)("p",{className:"help-block"},void 0,(0,a.Z)("a",{className:"btn btn-primary",href:g.Z.get("FORGOTTEN_PASSWORD_URL")},void 0,gettext("Set password"))))));var W,Q;const K=class extends i.Component{componentDidMount(){h.Z.set({title:gettext("Change email or password"),parent:gettext("Change your options")})}render(){return this.props.user.has_usable_password?(0,a.Z)("div",{},void 0,(0,a.Z)(F,{user:this.props.user}),(0,a.Z)(V,{user:this.props.user}),(0,a.Z)("p",{className:"message-line"},void 0,Q||(Q=(0,a.Z)("span",{className:"material-icon"},void 0,"warning")),(0,a.Z)("a",{href:g.Z.get("FORGOTTEN_PASSWORD_URL")},void 0,gettext("Change forgotten password")))):W||(W=(0,a.Z)($,{}))}};var J,X=s(2125),ee=s(8936),te=s(905),se=s(9145);const ae=class extends X.Z{render(){const e=g.Z.get("USER_OPTIONS").filter((e=>{const t=g.Z.get("USERCP_URL")+e.component+"/";return this.props.location.pathname.substr(0,t.length)===t}))[0];return(0,a.Z)("div",{className:"page page-options"},void 0,(0,a.Z)(se.sP,{},void 0,(0,a.Z)(se.mr,{styleName:"options"},void 0,(0,a.Z)(se.gC,{styleName:"options"},void 0,(0,a.Z)(ee.gq,{},void 0,(0,a.Z)(ee.kw,{auto:!0},void 0,(0,a.Z)(ee.Z6,{auto:!0},void 0,(0,a.Z)("h1",{},void 0,gettext("Change your options"))),(0,a.Z)(ee.Z6,{className:"hidden-xs hidden-md hidden-lg",shrink:!0},void 0,(0,a.Z)("div",{className:"dropdown"},void 0,(0,a.Z)("button",{type:"button",className:"btn btn-default btn-outline btn-icon dropdown-toggle",title:gettext("Menu"),"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},void 0,J||(J=(0,a.Z)("span",{className:"material-icon"},void 0,"menu"))),(0,a.Z)(d,{className:"dropdown-menu dropdown-menu-right",baseUrl:g.Z.get("USERCP_URL"),options:g.Z.get("USER_OPTIONS")})))),(0,a.Z)(ee.kw,{className:"hidden-sm hidden-md hidden-lg"},void 0,(0,a.Z)(ee.Z6,{},void 0,(0,a.Z)("div",{className:"dropdown"},void 0,(0,a.Z)("button",{type:"button",className:"btn btn-default btn-outline btn-block dropdown-toggle","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},void 0,(0,a.Z)("span",{className:"material-icon"},void 0,e.icon),e.name),(0,a.Z)(d,{className:"dropdown-menu",baseUrl:g.Z.get("USERCP_URL"),options:g.Z.get("USER_OPTIONS")})))))))),(0,a.Z)(te.Z,{},void 0,(0,a.Z)("div",{className:"row"},void 0,(0,a.Z)("div",{className:"col-md-3 hidden-xs hidden-sm"},void 0,(0,a.Z)(l,{baseUrl:g.Z.get("USERCP_URL"),options:g.Z.get("USER_OPTIONS")})),(0,a.Z)("div",{className:"col-md-9"},void 0,this.props.children))))}};function ie(e){return{tick:e.tick.tick,user:e.auth.user,"username-history":e["username-history"]}}function oe(){const e=[{path:g.Z.get("USERCP_URL")+"forum-options/",component:(0,o.$j)(ie)(T)},{path:g.Z.get("USERCP_URL")+"edit-details/",component:(0,o.$j)(ie)(_)}],t=g.Z.get("SETTINGS").DELEGATE_AUTH;return t||(e.push({path:g.Z.get("USERCP_URL")+"change-username/",component:(0,o.$j)(ie)(q)}),e.push({path:g.Z.get("USERCP_URL")+"sign-in-credentials/",component:(0,o.$j)(ie)(K)})),g.Z.get("ENABLE_DOWNLOAD_OWN_DATA")&&e.push({path:g.Z.get("USERCP_URL")+"download-data/",component:(0,o.$j)(ie)(x)}),!t&&g.Z.get("ENABLE_DELETE_OWN_ACCOUNT")&&e.push({path:g.Z.get("USERCP_URL")+"delete-account/",component:(0,o.$j)(ie)(Z)}),e}var ne=s(9633);g.Z.addInitializer({name:"component:options",initializer:function(e){e.has("USER_OPTIONS")&&(0,ne.Z)({basepath:g.Z.get("USERCP_URL"),component:ae,paths:oe()})},after:"store"})},5563:(e,t,s)=>{"use strict";var a,i=s(7785),o=s(2928),n=s(7294),r=s(381),l=s.n(r),d=s(5187),c=s(3556),p=s(2233),u=s(5547),h=s(3328);const m=class extends n.Component{constructor(e){super(e),p.Z.has("PROFILE_BAN")?this.initWithPreloadedData(p.Z.pop("PROFILE_BAN")):this.initWithoutPreloadedData(),this.startPolling(e.profile.api.ban)}initWithPreloadedData(e){e.expires_on&&(e.expires_on=l()(e.expires_on)),this.state={isLoaded:!0,ban:e}}initWithoutPreloadedData(){this.state={isLoaded:!1}}startPolling(e){u.Z.start({poll:"ban-details",url:e,frequency:9e4,update:this.update,error:this.error})}update=e=>{e.expires_on&&(e.expires_on=l()(e.expires_on)),this.setState({isLoaded:!0,error:null,ban:e})};error=e=>{this.setState({isLoaded:!0,error:e.detail,ban:null})};componentDidMount(){h.Z.set({title:gettext("Ban details"),parent:this.props.profile.username})}componentWillUnmount(){u.Z.stop("ban-details")}getUserMessage(){return this.state.ban.user_message?(0,o.Z)("div",{className:"panel-body ban-message ban-user-message"},void 0,(0,o.Z)("h4",{},void 0,gettext("User-shown ban message")),(0,o.Z)("div",{className:"lead",dangerouslySetInnerHTML:{__html:this.state.ban.user_message.html}})):null}getStaffMessage(){return this.state.ban.staff_message?(0,o.Z)("div",{className:"panel-body ban-message ban-staff-message"},void 0,(0,o.Z)("h4",{},void 0,gettext("Team-shown ban message")),(0,o.Z)("div",{className:"lead",dangerouslySetInnerHTML:{__html:this.state.ban.staff_message.html}})):null}getExpirationMessage(){if(this.state.ban.expires_on){if(this.state.ban.expires_on.isAfter(l()())){let e=interpolate(gettext("This ban expires on %(expires_on)s."),{expires_on:this.state.ban.expires_on.format("LL, LT")},!0),t=interpolate(gettext("This ban expires %(expires_on)s."),{expires_on:this.state.ban.expires_on.fromNow()},!0);return(0,o.Z)("abbr",{title:e},void 0,t)}return gettext("This ban has expired.")}return interpolate(gettext("%(username)s's ban is permanent."),{username:this.props.profile.username},!0)}getPanelBody(){return this.state.ban?Object.keys(this.state.ban).length?(0,o.Z)("div",{},void 0,this.getUserMessage(),this.getStaffMessage(),(0,o.Z)("div",{className:"panel-body ban-expires"},void 0,(0,o.Z)("h4",{},void 0,gettext("Ban expiration")),(0,o.Z)("p",{className:"lead"},void 0,this.getExpirationMessage()))):(0,o.Z)("div",{},void 0,(0,o.Z)(c.Z,{message:gettext("No ban is active at the moment.")})):this.state.error?(0,o.Z)("div",{},void 0,(0,o.Z)(c.Z,{icon:"error_outline",message:this.state.error})):a||(a=(0,o.Z)("div",{},void 0,(0,o.Z)(d.Z,{})))}render(){return(0,o.Z)("div",{className:"profile-ban-details"},void 0,(0,o.Z)("div",{className:"panel panel-default"},void 0,(0,o.Z)("div",{className:"panel-heading"},void 0,(0,o.Z)("h3",{className:"panel-title"},void 0,gettext("Ban details"))),this.getPanelBody()))}};var v=s(5247);function g(e){let{api:t,display:s,onCancel:a,onSuccess:i}=e;return s?(0,o.Z)(v.Z,{api:t,onCancel:a,onSuccess:i}):null}function Z(e){let{isAuthenticated:t,profile:s}=e,a=null;return a=t?gettext("You are not sharing any details with others."):interpolate(gettext("%(username)s is not sharing any details with others."),{username:s.username},!0),(0,o.Z)("div",{className:"panel panel-default"},void 0,(0,o.Z)("div",{className:"panel-body text-center lead"},void 0,a))}function b(e){let{html:t,text:s,url:a}=e;return t?(0,o.Z)("div",{className:"form-control-static col-md-9",dangerouslySetInnerHTML:{__html:t}}):(0,o.Z)("div",{className:"form-control-static col-md-9"},void 0,(0,o.Z)(_,{text:s,url:a}))}function _(e){let{text:t,url:s}=e;return s?(0,o.Z)("p",{},void 0,(0,o.Z)("a",{href:s,target:"_blank",rel:"nofollow"},void 0,t||s)):t?(0,o.Z)("p",{},void 0,t):null}function f(e){return(0,o.Z)("div",{className:"form-group"},void 0,(0,o.Z)("strong",{className:"control-label col-md-3"},void 0,e.name,":"),n.createElement(b,e))}function N(e){let{fields:t,name:s}=e;return(0,o.Z)("div",{className:"panel panel-default panel-profile-details-group"},void 0,(0,o.Z)("div",{className:"panel-heading"},void 0,(0,o.Z)("h3",{className:"panel-title"},void 0,s)),(0,o.Z)("div",{className:"panel-body"},void 0,(0,o.Z)("div",{className:"form-horizontal"},void 0,t.map((e=>{let{fieldname:t,html:s,name:a,text:i,url:n}=e;return(0,o.Z)(f,{name:a,html:s,text:i,url:n},t)})))))}var x,y=s(7848);function w(e){let{display:t,groups:s,isAuthenticated:a,loading:i,profile:n}=e;return t?i?x||(x=(0,o.Z)(y.Z,{})):s.length?(0,o.Z)("div",{},void 0,s.map(((e,t)=>(0,o.Z)(N,{fields:e.fields,name:e.name},t)))):(0,o.Z)(Z,{isAuthenticated:a,profile:n}):null}var k=s(2490);const C=e=>{let{onEdit:t,showEditButton:s}=e;return(0,o.Z)(k.o8,{},void 0,(0,o.Z)(k.Z2,{auto:!0},void 0,(0,o.Z)(k.Eg,{auto:!0},void 0,(0,o.Z)("h3",{},void 0,gettext("Details")))),s&&(0,o.Z)(k.Z2,{},void 0,(0,o.Z)(k.Eg,{},void 0,(0,o.Z)("button",{className:"btn btn-default btn-outline btn-block",onClick:t,type:"button"},void 0,gettext("Edit")))))};var S=s(8598),E=s(8657),L=s(3904);const T=class extends n.Component{componentDidMount(){const{data:e,dispatch:t,user:s}=this.props;e&&e.id===s.id||E.Z.get(this.props.user.api.details).then((e=>{t((0,S.zD)(e))}),(e=>{L.Z.apiError(e)}))}render(){return this.props.children}},P=class extends n.Component{constructor(e){super(e),this.state={editing:!1}}componentDidMount(){h.Z.set({title:gettext("Details"),parent:this.props.profile.username})}onCancel=()=>{this.setState({editing:!1})};onEdit=()=>{this.setState({editing:!0})};onSuccess=e=>{const{dispatch:t,isAuthenticated:s,profile:a}=this.props;let i=null;i=s?gettext("Your details have been updated."):interpolate(gettext("%(username)s's details have been updated."),{username:a.username},!0),L.Z.info(i),t((0,S.zD)(e)),this.setState({editing:!1})};render(){const{dispatch:e,isAuthenticated:t,profile:s,profileDetails:a}=this.props,i=a.id!==s.id;return(0,o.Z)(T,{data:a,dispatch:e,user:s},void 0,(0,o.Z)("div",{className:"profile-details"},void 0,(0,o.Z)(C,{onEdit:this.onEdit,showEditButton:!!a.edit&&!this.state.editing}),(0,o.Z)(w,{display:!this.state.editing,groups:a.groups,isAuthenticated:t,loading:i,profile:s}),(0,o.Z)(g,{api:s.api.edit_details,dispatch:e,display:this.state.editing,onCancel:this.onCancel,onSuccess:this.onSuccess})))}};var O=s(7462),R=s(1005),A=s(2211),I=s(1981),D=s(287);const j=class extends n.Component{constructor(e){super(e),this.state={isLoading:!1}}loadItems(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;E.Z.get(this.props.api,{start:e||0}).then((t=>{0===e?D.Z.dispatch(I.zD(t)):D.Z.dispatch(I.R3(t)),this.setState({isLoading:!1})}),(e=>{this.setState({isLoading:!1}),L.Z.apiError(e)}))}loadMore=()=>{this.setState({isLoading:!0}),this.loadItems(this.props.posts.next)};componentDidMount(){h.Z.set({title:this.props.title,parent:this.props.profile.username}),this.loadItems()}render(){return(0,o.Z)("div",{className:"profile-feed"},void 0,(0,o.Z)(k.o8,{},void 0,(0,o.Z)(k.Z2,{auto:!0},void 0,(0,o.Z)(k.Eg,{auto:!0},void 0,(0,o.Z)("h3",{},void 0,this.props.header)))),n.createElement(z,(0,O.Z)({isLoading:this.state.isLoading,loadMore:this.loadMore},this.props)))}};function z(e){return e.posts.isLoaded&&!e.posts.results.length?(0,o.Z)("p",{className:"lead"},void 0,e.emptyMessage):(0,o.Z)("div",{},void 0,(0,o.Z)(R.Z,{isReady:e.posts.isLoaded,posts:e.posts.results,poster:e.profile}),(0,o.Z)(U,{isLoading:e.isLoading,loadMore:e.loadMore,next:e.posts.next}))}function U(e){return e.next?(0,o.Z)("div",{className:"pager-more"},void 0,(0,o.Z)(A.Z,{className:"btn btn-default btn-outline",loading:e.isLoading,onClick:e.loadMore},void 0,gettext("Show older activity"))):null}var M;const B=class extends n.Component{getClassName(){return this.props.className?"form-search "+this.props.className:"form-search"}render(){return(0,o.Z)("div",{className:this.getClassName()},void 0,(0,o.Z)("input",{type:"text",className:"form-control",value:this.props.value,onChange:this.props.onChange,placeholder:this.props.placeholder||gettext("Search...")}),M||(M=(0,o.Z)("span",{className:"material-icon"},void 0,"search")))}};var q=s(429),H=s(6935);const F=class extends n.Component{constructor(e){super(e),this.setSpecialProps(),p.Z.has(this.PRELOADED_DATA_KEY)?this.initWithPreloadedData(p.Z.pop(this.PRELOADED_DATA_KEY)):this.initWithoutPreloadedData()}setSpecialProps(){this.PRELOADED_DATA_KEY="PROFILE_FOLLOWERS",this.TITLE=gettext("Followers"),this.API_FILTER="followers"}initWithPreloadedData(e){this.state={isLoaded:!0,isBusy:!1,search:"",count:e.count,more:e.more,page:e.page,pages:e.pages},D.Z.dispatch((0,H.ZB)(e.results))}initWithoutPreloadedData(){this.state={isLoaded:!1,isBusy:!1,search:"",count:0,more:0,page:1,pages:1},this.loadUsers()}loadUsers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const s=this.props.profile.api[this.API_FILTER];E.Z.get(s,{search:t,page:e||1},"user-"+this.API_FILTER).then((t=>{1===e?D.Z.dispatch((0,H.ZB)(t.results)):D.Z.dispatch((0,H.R3)(t.results)),this.setState({isLoaded:!0,isBusy:!1,count:t.count,more:t.more,page:t.page,pages:t.pages})}),(e=>{L.Z.apiError(e)}))}componentDidMount(){h.Z.set({title:this.TITLE,parent:this.props.profile.username})}loadMore=()=>{this.setState({isBusy:!0}),this.loadUsers(this.state.page+1,this.state.search)};search=e=>{this.setState({isLoaded:!1,isBusy:!0,search:e.target.value,count:0,more:0,page:1,pages:1}),this.loadUsers(1,e.target.value)};getLabel(){if(this.state.isLoaded){if(this.state.search){let e=ngettext("Found %(users)s user.","Found %(users)s users.",this.state.count);return interpolate(e,{users:this.state.count},!0)}if(this.props.profile.id===this.props.user.id){let e=ngettext("You have %(users)s follower.","You have %(users)s followers.",this.state.count);return interpolate(e,{users:this.state.count},!0)}{let e=ngettext("%(username)s has %(users)s follower.","%(username)s has %(users)s followers.",this.state.count);return interpolate(e,{username:this.props.profile.username,users:this.state.count},!0)}}return gettext("Loading...")}getEmptyMessage(){return this.state.search?gettext("Search returned no users matching specified criteria."):this.props.user.id===this.props.profile.id?gettext("You have no followers."):interpolate(gettext("%(username)s has no followers."),{username:this.props.profile.username},!0)}getMoreButton(){return this.state.more?(0,o.Z)("div",{className:"pager-more"},void 0,(0,o.Z)(A.Z,{className:"btn btn-default btn-outline",loading:this.state.isBusy,onClick:this.loadMore},void 0,interpolate(gettext("Show more (%(more)s)"),{more:this.state.more},!0))):null}getListBody(){return this.state.isLoaded&&0===this.state.count?(0,o.Z)("p",{className:"lead"},void 0,this.getEmptyMessage()):(0,o.Z)("div",{},void 0,(0,o.Z)(q.Z,{cols:3,isReady:this.state.isLoaded,users:this.props.users}),this.getMoreButton())}getClassName(){return"profile-"+this.API_FILTER}render(){return(0,o.Z)("div",{className:this.getClassName()},void 0,(0,o.Z)(k.o8,{},void 0,(0,o.Z)(k.Z2,{auto:!0},void 0,(0,o.Z)(k.Eg,{auto:!0},void 0,(0,o.Z)("h3",{},void 0,this.getLabel()))),(0,o.Z)(k.Z2,{},void 0,(0,o.Z)(k.Eg,{},void 0,(0,o.Z)(B,{value:this.state.search,onChange:this.search,placeholder:gettext("Search users...")})))),this.getListBody())}};var Y=s(7850),V=s(8927);const G=class extends n.Component{constructor(e){super(e),p.Z.has("PROFILE_NAME_HISTORY")?this.initWithPreloadedData(p.Z.pop("PROFILE_NAME_HISTORY")):this.initWithoutPreloadedData()}initWithPreloadedData(e){this.state={isLoaded:!0,isBusy:!1,search:"",count:e.count,more:e.more,page:e.page,pages:e.pages},D.Z.dispatch((0,V.ZB)(e.results))}initWithoutPreloadedData(){this.state={isLoaded:!1,isBusy:!1,search:"",count:0,more:0,page:1,pages:1},this.loadChanges()}loadChanges(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;E.Z.get(p.Z.get("USERNAME_CHANGES_API"),{user:this.props.profile.id,search:t,page:e||1},"search-username-history").then((t=>{1===e?D.Z.dispatch((0,V.ZB)(t.results)):D.Z.dispatch((0,V.R3)(t.results)),this.setState({isLoaded:!0,isBusy:!1,count:t.count,more:t.more,page:t.page,pages:t.pages})}),(e=>{L.Z.apiError(e)}))}componentDidMount(){h.Z.set({title:gettext("Username history"),parent:this.props.profile.username})}loadMore=()=>{this.setState({isBusy:!0}),this.loadChanges(this.state.page+1,this.state.search)};search=e=>{this.setState({isLoaded:!1,isBusy:!0,search:e.target.value,count:0,more:0,page:1,pages:1}),this.loadChanges(1,e.target.value)};getLabel(){if(this.state.isLoaded){if(this.state.search){let e=ngettext("Found %(changes)s username change.","Found %(changes)s username changes.",this.state.count);return interpolate(e,{changes:this.state.count},!0)}if(this.props.profile.id===this.props.user.id){let e=ngettext("Your username was changed %(changes)s time.","Your username was changed %(changes)s times.",this.state.count);return interpolate(e,{changes:this.state.count},!0)}{let e=ngettext("%(username)s's username was changed %(changes)s time.","%(username)s's username was changed %(changes)s times.",this.state.count);return interpolate(e,{username:this.props.profile.username,changes:this.state.count},!0)}}return gettext("Loading...")}getEmptyMessage(){return this.state.search?gettext("Search returned no username changes matching specified criteria."):this.props.user.id===this.props.profile.id?gettext("No name changes have been recorded for your account."):interpolate(gettext("%(username)s's username was never changed."),{username:this.props.profile.username},!0)}getMoreButton(){return this.state.more?(0,o.Z)("div",{className:"pager-more"},void 0,(0,o.Z)(A.Z,{className:"btn btn-default btn-outline",loading:this.state.isBusy,onClick:this.loadMore},void 0,interpolate(gettext("Show older (%(more)s)"),{more:this.state.more},!0))):null}render(){return(0,o.Z)("div",{className:"profile-username-history"},void 0,(0,o.Z)(k.o8,{},void 0,(0,o.Z)(k.Z2,{auto:!0},void 0,(0,o.Z)(k.Eg,{auto:!0},void 0,(0,o.Z)("h3",{},void 0,this.getLabel()))),(0,o.Z)(k.Z2,{},void 0,(0,o.Z)(k.Eg,{},void 0,(0,o.Z)(B,{value:this.state.search,onChange:this.search,placeholder:gettext("Search history...")})))),(0,o.Z)(Y.Z,{isLoaded:this.state.isLoaded,emptyMessage:this.getEmptyMessage(),changes:this.props["username-history"]}),this.getMoreButton())}};var $=s(2125),W=s(7519),Q=s(905),K=s(9605),J=s(8936),X=s(9145);const ee=class extends n.Component{constructor(e){super(e),this.state={isLoading:!1}}getClassName(){return this.props.profile.is_followed?this.props.className+" btn-default btn-following":this.props.className+" btn-default btn-follow"}getIcon(){return this.props.profile.is_followed?"favorite":"favorite_border"}getLabel(){return this.props.profile.is_followed?gettext("Following"):gettext("Follow")}action=()=>{this.setState({isLoading:!0}),this.props.profile.is_followed?D.Z.dispatch((0,W.r$)({is_followed:!1,followers:this.props.profile.followers-1})):D.Z.dispatch((0,W.r$)({is_followed:!0,followers:this.props.profile.followers+1})),E.Z.post(this.props.profile.api.follow).then((e=>{this.setState({isLoading:!1}),D.Z.dispatch((0,W.r$)(e))}),(e=>{this.setState({isLoading:!1}),L.Z.apiError(e)}))};render(){return(0,o.Z)(A.Z,{className:this.getClassName(),disabled:this.state.isLoading,onClick:this.action},void 0,(0,o.Z)("span",{className:"material-icon"},void 0,this.getIcon()),this.getLabel())}};var te,se=s(4646);const ae=class extends n.Component{onClick=()=>{se.Z.open({mode:"START_PRIVATE",submit:p.Z.get("PRIVATE_THREADS_API"),to:[this.props.profile]})};render(){const e=this.props.user.acl.can_start_private_threads,t=this.props.user.id===this.props.profile.id;return!e||t?null:(0,o.Z)("button",{className:this.props.className,onClick:this.onClick,type:"button"},void 0,te||(te=(0,o.Z)("span",{className:"material-icon"},void 0,"comment")),gettext("Message"))}};var ie,oe,ne=s(3345),re=s(6359),le=s(3784),de=s(7227),ce=s(337);const pe=class extends ne.Z{constructor(e){super(e),this.state={isLoaded:!1,isLoading:!1,error:null,is_avatar_locked:"",avatar_lock_user_message:"",avatar_lock_staff_message:""}}componentDidMount(){E.Z.get(this.props.profile.api.moderate_avatar).then((e=>{this.setState({isLoaded:!0,is_avatar_locked:e.is_avatar_locked,avatar_lock_user_message:e.avatar_lock_user_message||"",avatar_lock_staff_message:e.avatar_lock_staff_message||""})}),(e=>{this.setState({isLoaded:!0,error:e.detail})}))}clean(){return!!this.isValid()||(L.Z.error(this.validate().username[0]),!1)}send(){return E.Z.post(this.props.profile.api.moderate_avatar,{is_avatar_locked:this.state.is_avatar_locked,avatar_lock_user_message:this.state.avatar_lock_user_message,avatar_lock_staff_message:this.state.avatar_lock_staff_message})}handleSuccess(e){D.Z.dispatch((0,H.n1)(this.props.profile,e.avatar_hash)),L.Z.success(gettext("Avatar controls have been changed."))}getFormBody(){return(0,o.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,o.Z)("div",{className:"modal-body"},void 0,(0,o.Z)(re.Z,{label:gettext("Lock avatar"),helpText:gettext("Locking user avatar will prohibit user from changing his avatar and will reset his/her avatar to default one."),for:"id_is_avatar_locked"},void 0,(0,o.Z)(de.Z,{id:"id_is_avatar_locked",disabled:this.state.isLoading,iconOn:"lock_outline",iconOff:"lock_open",labelOn:gettext("Disallow user from changing avatar"),labelOff:gettext("Allow user to change avatar"),onChange:this.bindInput("is_avatar_locked"),value:this.state.is_avatar_locked})),(0,o.Z)(re.Z,{label:gettext("User message"),helpText:gettext("Optional message for user explaining why he/she is prohibited form changing avatar."),for:"id_avatar_lock_user_message"},void 0,(0,o.Z)("textarea",{id:"id_avatar_lock_user_message",className:"form-control",rows:"4",disabled:this.state.isLoading,onChange:this.bindInput("avatar_lock_user_message"),value:this.state.avatar_lock_user_message})),(0,o.Z)(re.Z,{label:gettext("Staff message"),helpText:gettext("Optional message for forum team members explaining why user is prohibited form changing avatar."),for:"id_avatar_lock_staff_message"},void 0,(0,o.Z)("textarea",{id:"id_avatar_lock_staff_message",className:"form-control",rows:"4",disabled:this.state.isLoading,onChange:this.bindInput("avatar_lock_staff_message"),value:this.state.avatar_lock_staff_message}))),(0,o.Z)("div",{className:"modal-footer"},void 0,(0,o.Z)("button",{type:"button",className:"btn btn-default","data-dismiss":"modal"},void 0,gettext("Close")),(0,o.Z)(A.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,gettext("Save changes"))))}getModalBody(){return this.state.error?(0,o.Z)(ce.Z,{icon:"remove_circle_outline",message:this.state.error}):this.state.isLoaded?this.getFormBody():ie||(ie=(0,o.Z)(le.Z,{}))}getClassName(){return this.state.error?"modal-dialog modal-message modal-avatar-controls":"modal-dialog modal-avatar-controls"}render(){return(0,o.Z)("div",{className:this.getClassName(),role:"document"},void 0,(0,o.Z)("div",{className:"modal-content"},void 0,(0,o.Z)("div",{className:"modal-header"},void 0,(0,o.Z)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":pgettext("modal","Close")},void 0,oe||(oe=(0,o.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,o.Z)("h4",{className:"modal-title"},void 0,gettext("Avatar controls"))),this.getModalBody()))}};var ue,he,me=s(5210);const ve=class extends ne.Z{constructor(e){super(e),this.state={isLoaded:!1,isLoading:!1,error:null,username:"",validators:{username:[me.lG()]}}}componentDidMount(){E.Z.get(this.props.profile.api.moderate_username).then((()=>{this.setState({isLoaded:!0})}),(e=>{this.setState({isLoaded:!0,error:e.detail})}))}clean(){return!!this.isValid()||(L.Z.error(this.validate().username[0]),!1)}send(){return E.Z.post(this.props.profile.api.moderate_username,{username:this.state.username})}handleSuccess(e){this.setState({username:""}),D.Z.dispatch((0,V.KP)(e,this.props.profile,this.props.user)),D.Z.dispatch((0,H._S)(this.props.profile,e.username,e.slug)),L.Z.success(gettext("Username has been changed."))}getFormBody(){return(0,o.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,o.Z)("div",{className:"modal-body"},void 0,(0,o.Z)(re.Z,{label:gettext("New username"),for:"id_username"},void 0,(0,o.Z)("input",{type:"text",id:"id_username",className:"form-control",disabled:this.state.isLoading,onChange:this.bindInput("username"),value:this.state.username}))),(0,o.Z)("div",{className:"modal-footer"},void 0,(0,o.Z)("button",{className:"btn btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,gettext("Cancel")),(0,o.Z)(A.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,gettext("Change username"))))}getModalBody(){return this.state.error?(0,o.Z)(ce.Z,{icon:"remove_circle_outline",message:this.state.error}):this.state.isLoaded?this.getFormBody():ue||(ue=(0,o.Z)(le.Z,{}))}getClassName(){return this.state.error?"modal-dialog modal-message modal-rename-user":"modal-dialog modal-rename-user"}render(){return(0,o.Z)("div",{className:this.getClassName(),role:"document"},void 0,(0,o.Z)("div",{className:"modal-content"},void 0,(0,o.Z)("div",{className:"modal-header"},void 0,(0,o.Z)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":pgettext("modal","Close")},void 0,he||(he=(0,o.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,o.Z)("h4",{className:"modal-title"},void 0,gettext("Change username"))),this.getModalBody()))}};var ge,Ze,be;const _e=class extends ne.Z{constructor(e){super(e),this.state={isLoaded:!1,isLoading:!1,isDeleted:!1,error:null,countdown:5,confirm:!1,with_content:!1}}componentDidMount(){E.Z.get(this.props.profile.api.delete).then((()=>{this.setState({isLoaded:!0}),this.countdown()}),(e=>{this.setState({isLoaded:!0,error:e.detail})}))}countdown=()=>{window.setTimeout((()=>{this.state.countdown>1?(this.setState({countdown:this.state.countdown-1}),this.countdown()):this.state.confirm||this.setState({confirm:!0})}),1e3)};send(){return E.Z.post(this.props.profile.api.delete,{with_content:this.state.with_content})}handleSuccess(){u.Z.stop("user-profile"),this.state.with_content?this.setState({isDeleted:interpolate(gettext("%(username)s's account, threads, posts and other content has been deleted."),{username:this.props.profile.username},!0)}):this.setState({isDeleted:interpolate(gettext("%(username)s's account has been deleted and other content has been hidden."),{username:this.props.profile.username},!0)})}getButtonLabel(){return this.state.confirm?interpolate(gettext("Delete %(username)s"),{username:this.props.profile.username},!0):interpolate(gettext("Please wait... (%(countdown)ss)"),{countdown:this.state.countdown},!0)}getForm(){return(0,o.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,o.Z)("div",{className:"modal-body"},void 0,(0,o.Z)(re.Z,{label:gettext("User content"),for:"id_with_content"},void 0,(0,o.Z)(de.Z,{id:"id_with_content",disabled:this.state.isLoading,labelOn:gettext("Delete together with user's account"),labelOff:gettext("Hide after deleting user's account"),onChange:this.bindInput("with_content"),value:this.state.with_content}))),(0,o.Z)("div",{className:"modal-footer"},void 0,(0,o.Z)("button",{type:"button",className:"btn btn-default","data-dismiss":"modal"},void 0,gettext("Cancel")),(0,o.Z)(A.Z,{className:"btn-danger",loading:this.state.isLoading,disabled:!this.state.confirm},void 0,this.getButtonLabel())))}getDeletedBody(){return(0,o.Z)("div",{className:"modal-body"},void 0,ge||(ge=(0,o.Z)("div",{className:"message-icon"},void 0,(0,o.Z)("span",{className:"material-icon"},void 0,"info_outline"))),(0,o.Z)("div",{className:"message-body"},void 0,(0,o.Z)("p",{className:"lead"},void 0,this.state.isDeleted),(0,o.Z)("p",{},void 0,(0,o.Z)("a",{href:p.Z.get("USERS_LIST_URL")},void 0,gettext("Return to users list")))))}getModalBody(){return this.state.error?(0,o.Z)(ce.Z,{icon:"remove_circle_outline",message:this.state.error}):this.state.isLoaded?this.state.isDeleted?this.getDeletedBody():this.getForm():Ze||(Ze=(0,o.Z)(le.Z,{}))}getClassName(){return this.state.error||this.state.isDeleted?"modal-dialog modal-message modal-delete-account":"modal-dialog modal-delete-account"}render(){return(0,o.Z)("div",{className:this.getClassName(),role:"document"},void 0,(0,o.Z)("div",{className:"modal-content"},void 0,(0,o.Z)("div",{className:"modal-header"},void 0,(0,o.Z)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":pgettext("modal","Close")},void 0,be||(be=(0,o.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,o.Z)("h4",{className:"modal-title"},void 0,gettext("Delete user account"))),this.getModalBody()))}};var fe,Ne,xe,ye=s(9801);let we=function(e){return{tick:e.tick,user:e.auth,profile:e.profile}};const ke=class extends n.Component{showAvatarDialog=()=>{ye.Z.show((0,i.$j)(we)(pe))};showRenameDialog=()=>{ye.Z.show((0,i.$j)(we)(ve))};showDeleteDialog=()=>{ye.Z.show((0,i.$j)(we)(_e))};render(){const{moderation:e}=this.props;return(0,o.Z)("ul",{className:"dropdown-menu dropdown-menu-right",role:"menu"},void 0,!!e.avatar&&(0,o.Z)("li",{},void 0,(0,o.Z)("button",{type:"button",className:"btn btn-link",onClick:this.showAvatarDialog},void 0,fe||(fe=(0,o.Z)("span",{className:"material-icon"},void 0,"portrait")),gettext("Avatar controls"))),!!e.rename&&(0,o.Z)("li",{},void 0,(0,o.Z)("button",{type:"button",className:"btn btn-link",onClick:this.showRenameDialog},void 0,Ne||(Ne=(0,o.Z)("span",{className:"material-icon"},void 0,"credit_card")),gettext("Change username"))),!!e.delete&&(0,o.Z)("li",{},void 0,(0,o.Z)("button",{type:"button",className:"btn btn-link",onClick:this.showDeleteDialog},void 0,xe||(xe=(0,o.Z)("span",{className:"material-icon"},void 0,"clear")),gettext("Delete account"))))}};var Ce=s(4678);const Se=e=>{let{profile:t}=e;return(0,o.Z)("ul",{className:"profile-data-list"},void 0,!1===t.is_active&&(0,o.Z)("li",{className:"user-account-disabled"},void 0,(0,o.Z)("abbr",{title:gettext("This user's account has been disabled by administrator.")},void 0,gettext("Account disabled"))),(0,o.Z)("li",{className:"user-status-display"},void 0,(0,o.Z)(Ce.ZP,{user:t,status:t.status},void 0,(0,o.Z)(Ce.Jj,{user:t,status:t.status}),(0,o.Z)(Ce.pg,{user:t,status:t.status,className:"status-label"}))),t.rank.is_tab?(0,o.Z)("li",{className:"user-rank"},void 0,(0,o.Z)("a",{href:t.rank.url,className:"item-title"},void 0,t.rank.name)):(0,o.Z)("li",{className:"user-rank"},void 0,(0,o.Z)("span",{className:"item-title"},void 0,t.rank.name)),(t.title||t.rank.title)&&(0,o.Z)("li",{className:"user-title"},void 0,t.title||t.rank.title),(0,o.Z)("li",{className:"user-joined-on"},void 0,(0,o.Z)("abbr",{title:interpolate(gettext("Joined on %(joined_on)s"),{joined_on:t.joined_on.format("LL, LT")},!0)},void 0,interpolate(gettext("Joined %(joined_on)s"),{joined_on:t.joined_on.fromNow()},!0))),t.email&&(0,o.Z)("li",{className:"user-email"},void 0,(0,o.Z)("a",{href:"mailto:"+t.email,className:"item-title"},void 0,t.email)))};var Ee,Le,Te,Pe,Oe;const Re=()=>(0,o.Z)("button",{className:"btn btn-default btn-icon btn-outline dropdown-toggle",type:"button",title:gettext("Options"),"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},void 0,Oe||(Oe=(0,o.Z)("span",{className:"material-icon"},void 0,"settings"))),Ae=e=>{let{profile:t,user:s,moderation:a,message:i,follow:n}=e;return(0,o.Z)(X.sP,{},void 0,(0,o.Z)(X.mr,{styleName:t.rank.css_class?"rank-"+t.rank.css_class:"profile"},void 0,(0,o.Z)(X.gC,{styleName:t.rank.css_class?"rank-"+t.rank.css_class:"profile"},void 0,(0,o.Z)("div",{className:"profile-page-header"},void 0,(0,o.Z)("div",{className:"profile-page-header-avatar"},void 0,(0,o.Z)(K.ZP,{className:"user-avatar hidden-sm hidden-md hidden-lg",user:t,size:200,size2x:400}),(0,o.Z)(K.ZP,{className:"user-avatar hidden-xs hidden-md hidden-lg",user:t,size:64,size2x:128}),(0,o.Z)(K.ZP,{className:"user-avatar hidden-xs hidden-sm",user:t,size:128,size2x:256})),(0,o.Z)("h1",{},void 0,t.username))),(0,o.Z)(X.eA,{className:"profile-page-header-details"},void 0,(0,o.Z)(J.gq,{},void 0,(0,o.Z)(J.kw,{auto:!0},void 0,(0,o.Z)(J.Z6,{},void 0,(0,o.Z)(Se,{profile:t}))),i&&(0,o.Z)(J.kw,{},void 0,(0,o.Z)(J.Z6,{},void 0,(0,o.Z)(ae,{className:"btn btn-default btn-block btn-outline",profile:t,user:s})),a.available&&!n&&(0,o.Z)(J.Z6,{shrink:!0},void 0,(0,o.Z)("div",{className:"dropdown"},void 0,Ee||(Ee=(0,o.Z)(Re,{})),(0,o.Z)(ke,{profile:t,moderation:a})))),n&&(0,o.Z)(J.kw,{},void 0,(0,o.Z)(J.Z6,{},void 0,(0,o.Z)(ee,{className:"btn btn-block btn-outline",profile:t})),a.available&&(0,o.Z)(J.Z6,{shrink:!0},void 0,(0,o.Z)("div",{className:"dropdown"},void 0,Le||(Le=(0,o.Z)(Re,{})),(0,o.Z)(ke,{profile:t,moderation:a})))),a.available&&!n&&!i&&(0,o.Z)(J.kw,{},void 0,(0,o.Z)(J.Z6,{className:"hidden-xs",shrink:!0},void 0,(0,o.Z)("div",{className:"dropdown"},void 0,Te||(Te=(0,o.Z)(Re,{})),(0,o.Z)(ke,{profile:t,moderation:a}))),(0,o.Z)(J.Z6,{className:"hidden-sm hidden-md hidden-lg"},void 0,(0,o.Z)("div",{className:"dropdown"},void 0,(0,o.Z)("button",{className:"btn btn-default btn-block btn-outline dropdown-toggle",type:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},void 0,Pe||(Pe=(0,o.Z)("span",{className:"material-icon"},void 0,"settings")),gettext("Options")),(0,o.Z)(ke,{profile:t,moderation:a}))))))))};var Ie=s(9655),De=s(4417);const je=e=>{let{baseUrl:t,page:s,pages:a}=e;return(0,o.Z)("div",{className:"nav-container"},void 0,(0,o.Z)("div",{className:"dropdown hidden-sm hidden-md hidden-lg"},void 0,(0,o.Z)("button",{className:"btn btn-default btn-block btn-outline dropdown-toggle",type:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},void 0,(0,o.Z)("span",{className:"material-icon"},void 0,s.icon),s.name),(0,o.Z)("ul",{className:"dropdown-menu stick-to-bottom"},void 0,a.map((e=>(0,o.Z)("li",{},e.component,(0,o.Z)(Ie.rU,{to:t+e.component+"/"},void 0,(0,o.Z)("span",{className:"material-icon"},void 0,e.icon),e.name)))))),(0,o.Z)("ul",{className:"nav nav-pills hidden-xs",role:"menu"},void 0,a.map((e=>(0,o.Z)(De.Z,{path:t+e.component+"/"},e.component,(0,o.Z)(Ie.rU,{to:t+e.component+"/"},void 0,(0,o.Z)("span",{className:"material-icon"},void 0,e.icon),e.name))))))},ze=class extends $.Z{constructor(e){super(e),this.startPolling(e.profile.api.index)}startPolling(e){u.Z.start({poll:"user-profile",url:e,frequency:9e4,update:this.update})}update=e=>{D.Z.dispatch((0,W.ZB)(e))};render(){const e=p.Z.get("PROFILE").url,t=p.Z.get("PROFILE_PAGES"),s=t.filter((t=>{const s=e+t.component+"/";return this.props.location.pathname===s}))[0],{profile:a,user:i}=this.props,n=Ue(a,i),r=!!i.acl.can_start_private_threads&&a.id!==i.id,l=!!a.acl.can_follow&&a.id!==i.id;return(0,o.Z)("div",{className:"page page-user-profile"},void 0,(0,o.Z)(Ae,{profile:this.props.profile,user:this.props.user,moderation:n,message:r,follow:l}),(0,o.Z)(Q.Z,{},void 0,(0,o.Z)(je,{baseUrl:e,page:s,pages:t}),this.props.children))}},Ue=(e,t)=>{const s={available:!1,rename:!1,avatar:!1,delete:!1};return t.is_anonymous||(s.rename=e.acl.can_rename,s.avatar=e.acl.can_moderate_avatar,s.delete=e.acl.can_delete,s.available=!!(s.rename||s.avatar||s.delete)),s};function Me(e){return{isAuthenticated:e.auth.user.id===e.profile.id,tick:e.tick.tick,user:e.auth.user,users:e.users,posts:e.posts,profile:e.profile,profileDetails:e["profile-details"],"username-history":e["username-history"]}}const Be={posts:function(e){let t=null;t=e.user.id===e.profile.id?gettext("You have posted no messages."):interpolate(gettext("%(username)s posted no messages."),{username:e.profile.username},!0);let s=null;if(e.posts.isLoaded)if(e.profile.id===e.user.id){const t=ngettext("You have posted %(posts)s message.","You have posted %(posts)s messages.",e.profile.posts);s=interpolate(t,{posts:e.profile.posts},!0)}else{const t=ngettext("%(username)s has posted %(posts)s message.","%(username)s has posted %(posts)s messages.",e.profile.posts);s=interpolate(t,{username:e.profile.username,posts:e.profile.posts},!0)}else s=gettext("Loading...");return n.createElement(j,(0,O.Z)({api:e.profile.api.posts,emptyMessage:t,header:s,title:gettext("Posts")},e))},threads:function(e){let t=null;t=e.user.id===e.profile.id?gettext("You have no started threads."):interpolate(gettext("%(username)s started no threads."),{username:e.profile.username},!0);let s=null;if(e.posts.isLoaded)if(e.profile.id===e.user.id){const t=ngettext("You have started %(threads)s thread.","You have started %(threads)s threads.",e.profile.threads);s=interpolate(t,{threads:e.profile.threads},!0)}else{const t=ngettext("%(username)s has started %(threads)s thread.","%(username)s has started %(threads)s threads.",e.profile.threads);s=interpolate(t,{username:e.profile.username,threads:e.profile.threads},!0)}else s=gettext("Loading...");return n.createElement(j,(0,O.Z)({api:e.profile.api.threads,emptyMessage:t,header:s,title:gettext("Threads")},e))},followers:F,follows:class extends F{setSpecialProps(){this.PRELOADED_DATA_KEY="PROFILE_FOLLOWS",this.TITLE=gettext("Follows"),this.API_FILTER="follows"}getLabel(){if(this.state.isLoaded){if(this.state.search){let e=ngettext("Found %(users)s user.","Found %(users)s users.",this.state.count);return interpolate(e,{users:this.state.count},!0)}if(this.props.profile.id===this.props.user.id){let e=ngettext("You are following %(users)s user.","You are following %(users)s users.",this.state.count);return interpolate(e,{users:this.state.count},!0)}{let e=ngettext("%(username)s is following %(users)s user.","%(username)s is following %(users)s users.",this.state.count);return interpolate(e,{username:this.props.profile.username,users:this.state.count},!0)}}return gettext("Loading...")}getEmptyMessage(){return this.state.search?gettext("Search returned no users matching specified criteria."):this.props.user.id===this.props.profile.id?gettext("You are not following any users."):interpolate(gettext("%(username)s is not following any users."),{username:this.props.profile.username},!0)}},details:P,"username-history":G,"ban-details":m};function qe(){let e=[];return p.Z.get("PROFILE_PAGES").forEach((function(t){e.push(Object.assign({},t,{path:p.Z.get("PROFILE").url+t.component+"/",component:(0,i.$j)(Me)(Be[t.component])}))})),e}var He=s(9633);p.Z.addInitializer({name:"component:profile",initializer:function(e){e.has("PROFILE")&&e.has("PROFILE_PAGES")&&(0,He.Z)({basepath:p.Z.get("PROFILE").url,component:(0,i.$j)(Me)(ze),paths:qe()})},after:"reducer:profile-hydrate"})},2488:(e,t,s)=>{"use strict";var a,i=s(2233),o=s(2928),n=s(7294),r=s(2211),l=s(3345),d=s(8657),c=s(3904),p=s(5210),u=s(3051);class h extends l.Z{constructor(e){super(e),this.state={isLoading:!1,email:"",validators:{email:[p.Do()]}}}clean(){return!!this.isValid()||(c.Z.error(gettext("Enter a valid email address.")),!1)}send(){return d.Z.post(i.Z.get("SEND_ACTIVATION_API"),{email:this.state.email})}handleSuccess(e){this.props.callback(e)}handleError(e){["already_active","inactive_admin"].indexOf(e.code)>-1?c.Z.info(e.detail):403===e.status&&e.ban?(0,u.Z)(e.ban):c.Z.apiError(e)}render(){return(0,o.Z)("div",{className:"well well-form well-form-request-activation-link"},void 0,(0,o.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,o.Z)("div",{className:"form-group"},void 0,(0,o.Z)("div",{className:"control-input"},void 0,(0,o.Z)("input",{type:"text",className:"form-control",placeholder:gettext("Your e-mail address"),disabled:this.state.isLoading,onChange:this.bindInput("email"),value:this.state.email}))),(0,o.Z)(r.Z,{className:"btn-primary btn-block",loading:this.state.isLoading},void 0,gettext("Send link"))))}}class m extends n.Component{getMessage(){return interpolate(gettext("Activation link was sent to %(email)s"),{email:this.props.user.email},!0)}render(){return(0,o.Z)("div",{className:"well well-form well-form-request-activation-link well-done"},void 0,(0,o.Z)("div",{className:"done-message"},void 0,a||(a=(0,o.Z)("div",{className:"message-icon"},void 0,(0,o.Z)("span",{className:"material-icon"},void 0,"check"))),(0,o.Z)("div",{className:"message-body"},void 0,(0,o.Z)("p",{},void 0,this.getMessage())),(0,o.Z)("button",{className:"btn btn-primary btn-block",type:"button",onClick:this.props.callback},void 0,gettext("Request another link"))))}}const v=class extends n.Component{constructor(e){super(e),this.state={complete:!1}}complete=e=>{this.setState({complete:e})};reset=()=>{this.setState({complete:!1})};render(){return this.state.complete?(0,o.Z)(m,{user:this.state.complete,callback:this.reset}):(0,o.Z)(h,{callback:this.complete})}};var g=s(4869);i.Z.addInitializer({name:"component:request-activation-link",initializer:function(){document.getElementById("request-activation-link-mount")&&(0,g.Z)(v,"request-activation-link-mount",!1)},after:"store"})},1768:(e,t,s)=>{"use strict";var a,i,o=s(2233),n=s(2928),r=s(7294),l=s(3935),d=s(2211),c=s(3345),p=s(8657),u=s(3904),h=s(5210),m=s(3051);class v extends c.Z{constructor(e){super(e),this.state={isLoading:!1,email:"",validators:{email:[h.Do()]}}}clean(){return!!this.isValid()||(u.Z.error(gettext("Enter a valid email address.")),!1)}send(){return p.Z.post(o.Z.get("SEND_PASSWORD_RESET_API"),{email:this.state.email})}handleSuccess(e){this.props.callback(e)}handleError(e){["inactive_user","inactive_admin"].indexOf(e.code)>-1?this.props.showInactivePage(e):403===e.status&&e.ban?(0,m.Z)(e.ban):u.Z.apiError(e)}render(){return(0,n.Z)("div",{className:"well well-form well-form-request-password-reset"},void 0,(0,n.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,n.Z)("div",{className:"form-group"},void 0,(0,n.Z)("div",{className:"control-input"},void 0,(0,n.Z)("input",{type:"text",className:"form-control",placeholder:gettext("Your e-mail address"),disabled:this.state.isLoading,onChange:this.bindInput("email"),value:this.state.email}))),(0,n.Z)(d.Z,{className:"btn-primary btn-block",loading:this.state.isLoading},void 0,gettext("Send link"))))}}class g extends r.Component{getMessage(){return interpolate(gettext("Reset password link was sent to %(email)s"),{email:this.props.user.email},!0)}render(){return(0,n.Z)("div",{className:"well well-form well-form-request-password-reset well-done"},void 0,(0,n.Z)("div",{className:"done-message"},void 0,a||(a=(0,n.Z)("div",{className:"message-icon"},void 0,(0,n.Z)("span",{className:"material-icon"},void 0,"check"))),(0,n.Z)("div",{className:"message-body"},void 0,(0,n.Z)("p",{},void 0,this.getMessage())),(0,n.Z)("button",{type:"button",className:"btn btn-primary btn-block",onClick:this.props.callback},void 0,gettext("Request another link"))))}}class Z extends r.Component{getActivateButton(){return"inactive_user"===this.props.activation?(0,n.Z)("p",{},void 0,(0,n.Z)("a",{href:o.Z.get("REQUEST_ACTIVATION_URL")},void 0,gettext("Activate your account."))):null}render(){return(0,n.Z)("div",{className:"page page-message page-message-info page-forgotten-password-inactive"},void 0,(0,n.Z)("div",{className:"container"},void 0,(0,n.Z)("div",{className:"message-panel"},void 0,i||(i=(0,n.Z)("div",{className:"message-icon"},void 0,(0,n.Z)("span",{className:"material-icon"},void 0,"info_outline"))),(0,n.Z)("div",{className:"message-body"},void 0,(0,n.Z)("p",{className:"lead"},void 0,gettext("Your account is inactive.")),(0,n.Z)("p",{},void 0,this.props.message),this.getActivateButton()))))}}const b=class extends r.Component{constructor(e){super(e),this.state={complete:!1}}complete=e=>{this.setState({complete:e})};reset=()=>{this.setState({complete:!1})};showInactivePage(e){l.render((0,n.Z)(Z,{activation:e.code,message:e.detail}),document.getElementById("page-mount"))}render(){return this.state.complete?(0,n.Z)(g,{callback:this.reset,user:this.state.complete}):(0,n.Z)(v,{callback:this.complete,showInactivePage:this.showInactivePage})}};var _=s(4869);o.Z.addInitializer({name:"component:request-password-reset",initializer:function(){document.getElementById("request-password-reset-mount")&&(0,_.Z)(b,"request-password-reset-mount",!1)},after:"store"})},1323:(e,t,s)=>{"use strict";var a,i=s(2233),o=s(2928),n=s(7294),r=s(3935),l=s(2211),d=s(3345),c=s(4467),p=s(8657),u=s(8274),h=s(9801),m=s(3904),v=s(3051),g=s(9755);class Z extends d.Z{constructor(e){super(e),this.state={isLoading:!1,password:""}}clean(){return!!this.state.password.trim().length||(m.Z.error(gettext("Enter new password.")),!1)}send(){return p.Z.post(i.Z.get("CHANGE_PASSWORD_API"),{password:this.state.password})}handleSuccess(e){this.props.callback(e)}handleError(e){403===e.status&&e.ban?(0,v.Z)(e.ban):m.Z.apiError(e)}render(){return(0,o.Z)("div",{className:"well well-form well-form-reset-password"},void 0,(0,o.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,o.Z)("div",{className:"form-group"},void 0,(0,o.Z)("div",{className:"control-input"},void 0,(0,o.Z)("input",{type:"password",className:"form-control",placeholder:gettext("Enter new password"),disabled:this.state.isLoading,onChange:this.bindInput("password"),value:this.state.password}))),(0,o.Z)(l.Z,{className:"btn-primary btn-block",loading:this.state.isLoading},void 0,gettext("Change password"))))}}class b extends n.Component{getMessage(){return interpolate(gettext("%(username)s, your password has been changed successfully."),{username:this.props.user.username},!0)}showSignIn(){h.Z.show(c.Z)}render(){return(0,o.Z)("div",{className:"page page-message page-message-success page-forgotten-password-changed"},void 0,(0,o.Z)("div",{className:"container"},void 0,(0,o.Z)("div",{className:"message-panel"},void 0,a||(a=(0,o.Z)("div",{className:"message-icon"},void 0,(0,o.Z)("span",{className:"material-icon"},void 0,"check"))),(0,o.Z)("div",{className:"message-body"},void 0,(0,o.Z)("p",{className:"lead"},void 0,this.getMessage()),(0,o.Z)("p",{},void 0,gettext("You will have to sign in using new password before continuing.")),(0,o.Z)("p",{},void 0,(0,o.Z)("button",{type:"button",className:"btn btn-primary",onClick:this.showSignIn},void 0,gettext("Sign in")))))))}}const _=class extends n.Component{complete=e=>{u.Z.softSignOut(),g('#hidden-login-form input[name="redirect_to"]').remove(),r.render((0,o.Z)(b,{user:e}),document.getElementById("page-mount"))};render(){return(0,o.Z)(Z,{callback:this.complete})}};var f=s(4869);i.Z.addInitializer({name:"component:reset-password-form",initializer:function(){document.getElementById("reset-password-form-mount")&&(0,f.Z)(_,"reset-password-form-mount",!1)},after:"store"})},5049:(e,t,s)=>{"use strict";var a,i=s(7785),o=s(2928),n=s(7462),r=s(7294),l=s(905),d=s(2233),c=s(3345),p=s(1981),u=s(6427),h=s(6935),m=s(8657),v=s(3904),g=s(287),Z=s(8936),b=s(9145);const _=class extends c.Z{constructor(e){super(e),this.state={isLoading:!1,query:e.search.query}}componentDidMount(){this.state.query.length&&this.handleSubmit()}onQueryChange=e=>{this.changeValue("query",e.target.value)};clean(){return!!this.state.query.trim().length||(v.Z.error(gettext("You have to enter search query.")),!1)}send(){g.Z.dispatch((0,u.Vx)({isLoading:!0}));const e=this.state.query.trim();let t=window.location.href;const s=t.indexOf("?q=");return s>0&&(t=t.substring(0,s+3)),window.history.pushState({},"",t+encodeURIComponent(e)),m.Z.get(d.Z.get("SEARCH_API"),{q:e})}handleSuccess(e){g.Z.dispatch((0,u.Vx)({query:this.state.query.trim(),isLoading:!1,providers:e})),e.forEach((e=>{"users"===e.id?g.Z.dispatch((0,h.ZB)(e.results.results)):"threads"===e.id&&g.Z.dispatch((0,p.zD)(e.results))}))}handleError(e){v.Z.apiError(e),g.Z.dispatch((0,u.Vx)({isLoading:!1}))}render(){return(0,o.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,o.Z)(b.sP,{},void 0,(0,o.Z)(b.mr,{styleName:"site-search"},void 0,(0,o.Z)(b.gC,{styleName:"site-search"},void 0,(0,o.Z)("h1",{},void 0,gettext("Search"))),(0,o.Z)(b.eA,{className:"page-header-search-form"},void 0,(0,o.Z)(Z.gq,{},void 0,(0,o.Z)(Z.kw,{auto:!0},void 0,(0,o.Z)(Z.Z6,{},void 0,(0,o.Z)("input",{className:"form-control",disabled:this.state.isLoading,type:"text",value:this.state.query,placeholder:gettext("Search"),onChange:this.onQueryChange})),(0,o.Z)(Z.Z6,{shrink:!0},void 0,(0,o.Z)("button",{className:"btn btn-secondary btn-icon btn-outline",disabled:this.state.isLoading},void 0,a||(a=(0,o.Z)("span",{className:"material-icon"},void 0,"search"))))))))))}};var f=s(9655);function N(e){return(0,o.Z)("div",{className:"list-group nav-side"},void 0,e.providers.map((e=>(0,o.Z)(f.rU,{activeClassName:"active",className:"list-group-item",to:e.url},e.id,(0,o.Z)("span",{className:"material-icon"},void 0,e.icon),e.name,(0,o.Z)(x,{results:e.results})))))}function x(e){if(!e.results)return null;let t=e.results.count;return t>1e6?t=Math.ceil(t/1e6)+"KK":t>1e3&&(t=Math.ceil(t/1e3)+"K"),(0,o.Z)("span",{className:"badge"},void 0,t)}function y(e){return(0,o.Z)("div",{className:"page page-search"},void 0,(0,o.Z)(_,{provider:e.provider,search:e.search}),(0,o.Z)(l.Z,{},void 0,(0,o.Z)("div",{className:"row"},void 0,(0,o.Z)("div",{className:"col-md-3"},void 0,(0,o.Z)(N,{providers:e.search.providers})),(0,o.Z)("div",{className:"col-md-9"},void 0,e.children,(0,o.Z)(w,{provider:e.provider,search:e.search})))))}function w(e){let t=null;if(e.search.providers.forEach((s=>{s.id===e.provider.id&&(t=s.time)})),null===t)return null;const s=gettext("Search took %(time)s s to complete");return(0,o.Z)("footer",{className:"search-footer"},void 0,(0,o.Z)("p",{},void 0,interpolate(s,{time:t},!0)))}var k=s(1005),C=s(2211);function S(e){return(0,o.Z)("div",{},void 0,(0,o.Z)(k.Z,{isReady:!0,posts:e.results}),r.createElement(E,e))}s(9092);class E extends r.Component{onClick=()=>{g.Z.dispatch((0,p.Vx)({isBusy:!0})),m.Z.get(this.props.provider.api,{q:this.props.query,page:this.props.next}).then((e=>{e.forEach((e=>{"threads"===e.id&&(g.Z.dispatch((0,p.R3)(e.results)),g.Z.dispatch((0,u.P0)(e)))})),g.Z.dispatch((0,p.Vx)({isBusy:!1}))}),(e=>{v.Z.apiError(e),g.Z.dispatch((0,p.Vx)({isBusy:!1}))}))};render(){return this.props.more?(0,o.Z)("div",{className:"pager-more"},void 0,(0,o.Z)(C.Z,{className:"btn btn-default btn-outline",loading:this.props.isBusy,onClick:this.onClick},void 0,gettext("Show more"))):null}}function L(e){let{children:t,loading:s,posts:a,query:i}=e;return a&&a.count?t:i.length?(0,o.Z)("p",{className:"lead"},void 0,s?gettext("Loading results..."):gettext("No threads matching search query have been found.")):(0,o.Z)("p",{className:"lead"},void 0,gettext("Enter at least two characters to search threads."))}var T=s(429);function P(e){let{children:t,loading:s,query:a,users:i}=e;return i.length?t:a.length?(0,o.Z)("p",{className:"lead"},void 0,s?gettext("Loading results..."):gettext("No users matching search query have been found.")):(0,o.Z)("p",{className:"lead"},void 0,gettext("Enter at least two characters to search users."))}const O={threads:function(e){return(0,o.Z)(y,{provider:e.route.provider,search:e.search},void 0,(0,o.Z)(L,{loading:e.search.isLoading,query:e.search.query,posts:e.posts},void 0,r.createElement(S,(0,n.Z)({provider:e.route.provider,query:e.search.query},e.posts))))},users:function(e){return(0,o.Z)(y,{provider:e.route.provider,search:e.search},void 0,(0,o.Z)(P,{loading:e.search.isLoading,query:e.search.query,users:e.users},void 0,(0,o.Z)(T.Z,{cols:3,isReady:!e.search.isLoading,users:e.users})))}};function R(e){return{posts:e.posts,search:e.search,tick:e.tick.tick,user:e.auth.user,users:e.users}}var A=s(9633);d.Z.addInitializer({name:"component:search",initializer:function(e){var t;"misago:search"===e.get("CURRENT_LINK")&&(0,A.Z)({paths:(t=d.Z.get("SEARCH_PROVIDERS"),t.map((e=>({path:e.url,component:(0,i.$j)(R)(O[e.id]),provider:e}))))})},after:"store"})},1814:(e,t,s)=>{"use strict";var a=s(7785),i=s(2233),o=s(2928),n=s(7294);const r={info:"alert-info",success:"alert-success",warning:"alert-warning",error:"alert-danger"};class l extends n.Component{getSnackbarClass(){let e="alerts-snackbar";return this.props.isVisible?e+=" in":e+=" out",e}render(){return(0,o.Z)("div",{className:this.getSnackbarClass()},void 0,(0,o.Z)("p",{className:"alert "+r[this.props.type]},void 0,this.props.message))}}function d(e){return e.snackbar}var c=s(4869);i.Z.addInitializer({name:"component:snackbar",initializer:function(){(0,c.Z)((0,a.$j)(d)(l),"snackbar-mount")},after:"snackbar"})},5920:(e,t,s)=>{"use strict";var a=s(7294),i=s(2928),o=s(2233),n=s(6106),r=s(2211),l=s(3345),d=s(6359),c=s(8657),p=s(3904),u=s(5210),h=s(905),m=s(9145);const v=e=>{let{backendName:t}=e;const s=gettext("Sign in with %(backend)s"),a=interpolate(s,{backend:t},!0);return(0,i.Z)(m.sP,{},void 0,(0,i.Z)(m.mr,{styleName:"social-auth"},void 0,(0,i.Z)(m.gC,{styleName:"social-auth"},void 0,(0,i.Z)("h1",{},void 0,a))))};class g extends l.Z{constructor(e){super(e);const t={email:[u.Do()],username:[u.lG()]};o.Z.get("TERMS_OF_SERVICE_ID")&&(t.termsOfService=[u.fT()]),o.Z.get("PRIVACY_POLICY_ID")&&(t.privacyPolicy=[u.jA()]),this.state={email:e.email||"",emailProtected:!!e.email,username:e.username||"",termsOfService:null,privacyPolicy:null,validators:t,errors:{},isLoading:!1}}clean(){if(this.validate(),-1!==[this.state.email.trim().length,this.state.username.trim().length].indexOf(0))return p.Z.error(gettext("Fill out all fields.")),!1;const{validators:e}=this.state;return o.Z.get("TERMS_OF_SERVICE_ID")&&null===this.state.termsOfService?(p.Z.error(e.termsOfService[0](null)),!1):!o.Z.get("PRIVACY_POLICY_ID")||null!==this.state.privacyPolicy||(p.Z.error(e.privacyPolicy[0](null)),p.Z.error(gettext("You need to accept the privacy policy.")),!1)}send(){return c.Z.post(this.props.url,{email:this.state.email,username:this.state.username,terms_of_service:this.state.termsOfService,privacy_policy:this.state.privacyPolicy})}handleSuccess(e){const{onRegistrationComplete:t}=this.props;t(e)}handleError(e){if(200===e.status){const{onRegistrationComplete:e}=this.props,{username:t}=this.state;e({activation:"active",step:"done",username:t})}else if(400===e.status){const t={errors:e};e.email&&(t.emailProtected=!1),this.setState(t)}else p.Z.apiError(e)}handlePrivacyPolicyChange=e=>{const t=e.target.value;this.handleToggleAgreement("privacyPolicy",t)};handleTermsOfServiceChange=e=>{const t=e.target.value;this.handleToggleAgreement("termsOfService",t)};handleToggleAgreement=(e,t)=>{this.setState(((s,a)=>{if(null===s[e])return{errors:{...s.errors,[e]:null},[e]:t};const i=this.state.validators[e][0];return{errors:{...s.errors,[e]:[i(null)]},[e]:null}}))};render(){const{backend_name:e}=this.props,{email:t,emailProtected:s,username:a,isLoading:o}=this.state;let l=null;if(s){const t=gettext("Your e-mail address has been verified by %(backend)s.");l=interpolate(t,{backend:e},!0)}return(0,i.Z)("div",{className:"page page-social-auth page-social-auth-register"},void 0,(0,i.Z)(v,{backendName:e}),(0,i.Z)(h.Z,{},void 0,(0,i.Z)("div",{className:"row"},void 0,(0,i.Z)("div",{className:"col-md-6 col-md-offset-3"},void 0,(0,i.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,i.Z)("div",{className:"panel panel-default panel-form"},void 0,(0,i.Z)("div",{className:"panel-heading"},void 0,(0,i.Z)("h3",{className:"panel-title"},void 0,gettext("Complete your details"))),(0,i.Z)("div",{className:"panel-body"},void 0,(0,i.Z)(d.Z,{for:"id_username",label:gettext("Username"),validation:this.state.errors.username},void 0,(0,i.Z)("input",{type:"text",id:"id_username",className:"form-control",disabled:o,onChange:this.bindInput("username"),value:a})),(0,i.Z)(d.Z,{for:"id_email",label:gettext("E-mail address"),helpText:l,validation:s?null:this.state.errors.email},void 0,(0,i.Z)("input",{type:"email",id:"id_email",className:"form-control",disabled:o||s,onChange:this.bindInput("email"),value:t})),(0,i.Z)(n.Z,{errors:this.state.errors,privacyPolicy:this.state.privacyPolicy,termsOfService:this.state.termsOfService,onPrivacyPolicyChange:this.handlePrivacyPolicyChange,onTermsOfServiceChange:this.handleTermsOfServiceChange})),(0,i.Z)("div",{className:"panel-footer"},void 0,(0,i.Z)(r.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,gettext("Sign in")))))))))}}const Z=e=>{let{activation:t,backend_name:s,username:a}=e,n="",r="";return r="user"===t?gettext("%(username)s, your account has been created but you need to activate it before you will be able to sign in."):"admin"===t?gettext("%(username)s, your account has been created but board administrator will have to activate it before you will be able to sign in."):gettext("%(username)s, your account has been created and you have been signed in to it."),n="active"===t?"check":"info_outline",(0,i.Z)("div",{className:"page page-social-auth page-social-auth-register"},void 0,(0,i.Z)(v,{backendName:s}),(0,i.Z)(h.Z,{},void 0,(0,i.Z)("div",{className:"row"},void 0,(0,i.Z)("div",{className:"col-md-6 col-md-offset-3"},void 0,(0,i.Z)("div",{className:"panel panel-default panel-form"},void 0,(0,i.Z)("div",{className:"panel-heading"},void 0,(0,i.Z)("h3",{className:"panel-title"},void 0,gettext("Registration completed!"))),(0,i.Z)("div",{className:"panel-body panel-message-body"},void 0,(0,i.Z)("div",{className:"message-icon"},void 0,(0,i.Z)("span",{className:"material-icon"},void 0,n)),(0,i.Z)("div",{className:"message-body"},void 0,(0,i.Z)("p",{className:"lead"},void 0,interpolate(r,{username:a},!0)),(0,i.Z)("p",{className:"help-block"},void 0,(0,i.Z)("a",{className:"btn btn-default",href:o.Z.get("MISAGO_PATH")},void 0,gettext("Return to forum index"))))))))))};class b extends a.Component{constructor(e){super(e),this.state={step:e.step,activation:e.activation||"",email:e.email||"",username:e.username||""}}handleRegistrationComplete=e=>{let{activation:t,email:s,step:a,username:i}=e;this.setState({activation:t,email:s,step:a,username:i})};render(){const{backend_name:e,url:t}=this.props,{activation:s,email:a,step:o,username:n}=this.state;return"register"===o?(0,i.Z)(g,{backend_name:e,email:a,url:t,username:n,onRegistrationComplete:this.handleRegistrationComplete}):(0,i.Z)(Z,{activation:s,backend_name:e,email:a,url:t,username:n})}}var _=s(4869);o.Z.addInitializer({name:"component:social-auth",initializer:function(e){if("misago:social-complete"===e.get("CURRENT_LINK")){const t=e.get("SOCIAL_AUTH_FORM");(0,_.Z)(a.createElement(b,t),"page-mount")}},after:"store"})},630:(e,t,s)=>{"use strict";var a,i,o=s(7785),n=s(2928),r=s(7294),l=s(7462),d=s(3345),c=s(6359),p=s(8154),u=s(7738),h=s(8657),m=s(9801),v=s(3904),g=s(287);const Z=class extends d.Z{constructor(e){super(e),this.state={isLoading:!1,username:""}}onUsernameChange=e=>{this.changeValue("username",e.target.value)};clean(){return!!this.state.username.trim().length||(v.Z.error(gettext("You have to enter user name.")),!1)}send(){return h.Z.patch(this.props.thread.api.index,[{op:"add",path:"participants",value:this.state.username},{op:"add",path:"acl",value:1}])}handleSuccess(e){g.Z.dispatch((0,u.y8)(e)),g.Z.dispatch(p.gx(e.participants)),v.Z.success(gettext("New participant has been added to thread.")),m.Z.hide()}render(){return(0,n.Z)("div",{className:"modal-dialog modal-sm",role:"document"},void 0,(0,n.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,n.Z)("div",{className:"modal-content"},void 0,a||(a=(0,n.Z)(b,{})),(0,n.Z)("div",{className:"modal-body"},void 0,(0,n.Z)(c.Z,{for:"id_username",label:gettext("User to add")},void 0,(0,n.Z)("input",{id:"id_username",className:"form-control",disabled:this.state.isLoading,onChange:this.onUsernameChange,type:"text",value:this.state.username}))),(0,n.Z)("div",{className:"modal-footer"},void 0,(0,n.Z)("button",{className:"btn btn-block btn-primary",disabled:this.state.isLoading},void 0,gettext("Add participant")),(0,n.Z)("button",{className:"btn btn-block btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,gettext("Cancel"))))))}};function b(e){return(0,n.Z)("div",{className:"modal-header"},void 0,(0,n.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,i||(i=(0,n.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,n.Z)("h4",{className:"modal-title"},void 0,gettext("Add participant")))}var _;const f=class extends r.Component{onClick=()=>{m.Z.show((0,n.Z)(Z,{thread:this.props.thread}))};render(){return this.props.thread.acl.can_add_participants?(0,n.Z)("div",{className:"col-xs-12 col-sm-3"},void 0,(0,n.Z)("button",{className:"btn btn-default btn-block",onClick:this.onClick,type:"button"},void 0,_||(_=(0,n.Z)("span",{className:"material-icon"},void 0,"person_add")),gettext("Add participant"))):null}};var N=s(2233);const x=class extends r.Component{constructor(e){super(e),this.isUser=e.participant.id===e.user.id}onClick=()=>{let e=!1;if(this.isUser)e=window.confirm(gettext("Are you sure you want to take over this thread?"));else{const t=gettext("Are you sure you want to change thread owner to %(user)s?");e=window.confirm(interpolate(t,{user:this.props.participant.username},!0))}var t,s;e&&(t=this.props.thread,s=this.props.participant,h.Z.patch(t.api.index,[{op:"replace",path:"owner",value:s.id},{op:"add",path:"acl",value:1}]).then((e=>{g.Z.dispatch((0,u.y8)(e)),g.Z.dispatch(p.gx(e.participants));const t=gettext("%(user)s has been made new thread owner.");v.Z.success(interpolate(t,{user:s.username},!0))}),(e=>{v.Z.apiError(e)})))};render(){return this.props.participant.is_owner?null:this.props.thread.acl.can_change_owner?(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,gettext("Make owner"))):null}},y=class extends r.Component{constructor(e){super(e),this.isUser=e.participant.id===e.user.id}onClick=()=>{let e=!1;if(this.isUser)e=window.confirm(gettext("Are you sure you want to leave this thread?"));else{const t=gettext("Are you sure you want to remove %(user)s from this thread?");e=window.confirm(interpolate(t,{user:this.props.participant.username},!0))}var t,s;e&&(this.isUser?(t=this.props.thread,s=this.props.participant,h.Z.patch(t.api.index,[{op:"remove",path:"participants",value:s.id}]).then((()=>{v.Z.success(gettext("You have left this thread.")),window.setTimeout((()=>{window.location=N.Z.get("PRIVATE_THREADS_URL")}),3e3)}),(e=>{v.Z.apiError(e)}))):function(e,t){h.Z.patch(e.api.index,[{op:"remove",path:"participants",value:t.id},{op:"add",path:"acl",value:1}]).then((e=>{g.Z.dispatch((0,u.y8)(e)),g.Z.dispatch(p.gx(e.participants));const s=gettext("%(user)s has been removed from this thread.");v.Z.success(interpolate(s,{user:t.username},!0))}),(e=>{v.Z.apiError(e)}))}(this.props.thread,this.props.participant))};render(){const e=this.props.user.acl.can_moderate_private_threads;return this.props.userIsOwner||this.isUser||e?(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,this.isUser?gettext("Leave thread"):gettext("Remove"))):null}};var w,k,C,S=s(9605);function E(e){const t=e.participant;let s="btn btn-default";return t.is_owner&&(s="btn btn-primary"),s+=" btn-user btn-block",(0,n.Z)("div",{className:"col-xs-12 col-sm-3 col-md-2 participant-card"},void 0,(0,n.Z)("div",{className:"dropdown"},void 0,(0,n.Z)("button",{"aria-haspopup":"true","aria-expanded":"false",className:s,"data-toggle":"dropdown",type:"button"},void 0,(0,n.Z)(S.ZP,{size:"34",user:t}),(0,n.Z)("span",{className:"btn-text"},void 0,t.username)),(0,n.Z)("ul",{className:"dropdown-menu stick-to-bottom"},void 0,(0,n.Z)(L,{isOwner:t.is_owner}),w||(w=(0,n.Z)("li",{className:"dropdown-header"})),(0,n.Z)("li",{},void 0,(0,n.Z)("a",{href:t.url},void 0,gettext("See profile"))),k||(k=(0,n.Z)("li",{role:"separator",className:"divider"})),r.createElement(x,e),r.createElement(y,e))))}function L(e){let{isOwner:t}=e;return t?(0,n.Z)("li",{className:"dropdown-header dropdown-header-owner"},void 0,C||(C=(0,n.Z)("span",{className:"material-icon"},void 0,"start")),(0,n.Z)("span",{className:"icon-text"},void 0,gettext("Thread owner"))):null}function T(e){let{participants:t,thread:s,user:a,userIsOwner:i}=e;return(0,n.Z)("div",{className:"participants-cards"},void 0,(0,n.Z)("div",{className:"row"},void 0,t.map((e=>(0,n.Z)(E,{participant:e,thread:s,user:a,userIsOwner:i},e.id)))))}function P(e){return e.participants.length?(0,n.Z)("div",{className:"panel panel-default panel-participants"},void 0,(0,n.Z)("div",{className:"panel-body"},void 0,r.createElement(T,(0,l.Z)({userIsOwner:O(e.user,e.participants)},e)),(0,n.Z)("div",{className:"row"},void 0,(0,n.Z)(f,{thread:e.thread}),(0,n.Z)("div",{className:"col-xs-12 col-sm-9"},void 0,(0,n.Z)("p",{},void 0,function(e){const t=e.length,s=ngettext("This thread has %(users)s participant.","This thread has %(users)s participants.",t);return interpolate(s,{users:t},!0)}(e.participants)))))):null}function O(e,t){return t[0].id===e.id}var R,A=s(381),I=s.n(A);function D(e){return(0,n.Z)("div",{className:"poll-choices-bars"},void 0,e.poll.choices.map((t=>(0,n.Z)(j,{choice:t,poll:e.poll},t.hash))))}function j(e){let t=0;return e.choice.votes&&e.poll.votes&&(t=Math.ceil(100*e.choice.votes/e.poll.votes)),(0,n.Z)("dl",{className:"dl-horizontal"},void 0,(0,n.Z)("dt",{},void 0,e.choice.label),(0,n.Z)("dd",{},void 0,(0,n.Z)("div",{className:"progress"},void 0,(0,n.Z)("div",{className:"progress-bar",role:"progressbar","aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100",style:{width:t+"%"}},void 0,(0,n.Z)("span",{className:"sr-only"},void 0,U(e.votes,e.proc)))),(0,n.Z)("ul",{className:"list-unstyled list-inline poll-chart"},void 0,(0,n.Z)(z,{proc:t,votes:e.choice.votes}),(0,n.Z)(M,{selected:e.choice.selected}))))}function z(e){return(0,n.Z)("li",{className:"poll-chart-votes"},void 0,U(e.votes,e.proc))}function U(e,t){const s=npgettext("thread poll","%(votes)s vote, %(proc)s% of total.","%(votes)s votes, %(proc)s% of total.",e);return interpolate(s,{votes:e,proc:t},!0)}function M(e){return e.selected?(0,n.Z)("li",{className:"poll-chart-selected"},void 0,R||(R=(0,n.Z)("span",{className:"material-icon"},void 0,"check_box")),pgettext("thread poll","You've voted on this choice.")):null}var B,q,H,F=s(337),Y=s(3784);const V=class extends r.Component{constructor(e){super(e),this.state={isLoading:!0,error:null,data:[]}}componentDidMount(){h.Z.get(this.props.poll.api.votes).then((e=>{const t=e.map((e=>Object.assign({},e,{voters:e.voters.map((e=>Object.assign({},e,{voted_on:I()(e.voted_on)})))})));this.setState({isLoading:!1,data:t})}),(e=>{this.setState({isLoading:!1,error:e.detail})}))}render(){return(0,n.Z)("div",{className:"modal-dialog"+(this.state.error?" modal-message":" modal-sm"),role:"document"},void 0,(0,n.Z)("div",{className:"modal-content"},void 0,(0,n.Z)("div",{className:"modal-header"},void 0,(0,n.Z)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":pgettext("modal","Close")},void 0,B||(B=(0,n.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,n.Z)("h4",{className:"modal-title"},void 0,pgettext("thread poll","Poll votes"))),(0,n.Z)(G,{data:this.state.data,error:this.state.error,isLoading:this.state.isLoading})))}};function G(e){return e.isLoading?q||(q=(0,n.Z)(Y.Z,{})):e.error?(0,n.Z)(F.Z,{icon:"error_outline",message:e.error}):(0,n.Z)($,{data:e.data})}function $(e){return(0,n.Z)("div",{className:"modal-body modal-poll-votes"},void 0,(0,n.Z)("ul",{className:"list-unstyled votes-details"},void 0,e.data.map((e=>r.createElement(W,(0,l.Z)({key:e.hash},e))))))}function W(e){return(0,n.Z)("li",{},void 0,(0,n.Z)("h4",{},void 0,e.label),(0,n.Z)(Q,{votes:e.votes}),(0,n.Z)(K,{voters:e.voters}),H||(H=(0,n.Z)("hr",{})))}function Q(e){const t=npgettext("thread poll","%(votes)s user has voted for this choice.","%(votes)s users have voted for this choice.",e.votes),s=interpolate(t,{votes:e.votes},!0);return(0,n.Z)("p",{},void 0,s)}function K(e){return e.voters.length?(0,n.Z)("ul",{className:"list-unstyled"},void 0,e.voters.map((e=>r.createElement(J,(0,l.Z)({key:e.username},e))))):null}function J(e){return e.url?(0,n.Z)("li",{},void 0,(0,n.Z)("a",{className:"item-title",href:e.url},void 0,e.username)," ",(0,n.Z)(X,{voted_on:e.voted_on})):(0,n.Z)("li",{},void 0,(0,n.Z)("strong",{},void 0,e.username)," ",(0,n.Z)(X,{voted_on:e.voted_on}))}function X(e){return(0,n.Z)("abbr",{className:"text-muted",title:e.voted_on.format("LLL")},void 0,e.voted_on.fromNow())}var ee=s(9752),te=s(4646);function se(e){const{isPollOver:t,poll:s,showVoting:a,thread:i}=e;if(!function(e,t,s){return s.is_public||t.can_delete||t.can_edit||t.can_see_votes||t.can_vote&&!e&&(!s.hasSelectedChoices||s.allow_revotes)}(t,s.acl,s))return null;const o=[],r=s.acl.can_vote,l=!s.hasSelectedChoices||s.allow_revotes;return r&&l&&o.push(0),(s.is_public||s.acl.can_see_votes)&&o.push(1),s.acl.can_edit&&o.push(2),s.acl.can_delete&&o.push(3),(0,n.Z)("div",{className:"row poll-options"},void 0,(0,n.Z)(ie,{controls:o,isPollOver:t,poll:s,showVoting:a}),(0,n.Z)(oe,{controls:o,poll:s}),(0,n.Z)(ne,{controls:o,poll:s,thread:i,onClick:e.edit}),(0,n.Z)(re,{controls:o,poll:s}))}function ae(e,t){let s="col-xs-6";return 1===e.length&&(s="col-xs-12"),3===e.length&&e[0]===t&&(s="col-xs-12"),s+" col-sm-3 col-md-2"}function ie(e){const t=e.poll.acl.can_vote,s=!e.poll.hasSelectedChoices||e.poll.allow_revotes;return t&&s?(0,n.Z)("div",{className:ae(e.controls,0)},void 0,(0,n.Z)("button",{className:"btn btn-default btn-block btn-sm",disabled:e.poll.isBusy,onClick:e.showVoting,type:"button"},void 0,pgettext("thread poll","Vote"))):null}class oe extends r.Component{onClick=()=>{m.Z.show((0,n.Z)(V,{poll:this.props.poll}))};render(){return this.props.poll.is_public||this.props.poll.acl.can_see_votes?(0,n.Z)("div",{className:ae(this.props.controls,1)},void 0,(0,n.Z)("button",{className:"btn btn-default btn-block btn-sm",disabled:this.props.poll.isBusy,onClick:this.onClick,type:"button"},void 0,pgettext("thread poll","See votes"))):null}}function ne(e){return e.poll.acl.can_edit?(0,n.Z)("div",{className:ae(e.controls,2)},void 0,(0,n.Z)("button",{className:"btn btn-default btn-block btn-sm",disabled:e.poll.isBusy,onClick:e.onClick,type:"button"},void 0,pgettext("thread poll","Edit"))):null}class re extends r.Component{onClick=()=>{if(!window.confirm(pgettext("thread poll","Are you sure you want to delete this poll? This action is not reversible.")))return!1;g.Z.dispatch(ee.n6()),h.Z.delete(this.props.poll.api.index).then(this.handleSuccess,this.handleError)};handleSuccess=e=>{v.Z.success(pgettext("thread poll","Poll has been deleted")),g.Z.dispatch(ee.Od()),g.Z.dispatch(u.y8(e))};handleError=e=>{v.Z.apiError(e),g.Z.dispatch(ee.Ar())};render(){return this.props.poll.acl.can_delete?(0,n.Z)("div",{className:ae(this.props.controls,3)},void 0,(0,n.Z)("button",{className:"btn btn-default btn-block btn-sm",disabled:this.props.poll.isBusy,onClick:this.onClick,type:"button"},void 0,pgettext("thread poll","Delete"))):null}}var le=s(9627);const de='<abbr title="%(absolute)s">%(relative)s</abbr>',ce='<span class="item-title">%(user)s</span>',pe='<a href="%(url)s" class="item-title">%(user)s</a>';function ue(e){return(0,n.Z)("ul",{className:"list-unstyled list-inline poll-details"},void 0,(0,n.Z)(be,{votes:e.poll.votes}),(0,n.Z)(ge,{poll:e.poll}),(0,n.Z)(_e,{poll:e.poll}),(0,n.Z)(he,{poll:e.poll}))}function he(e){const t=interpolate((0,le.Z)(pgettext("thread poll","Started by %(poster)s %(posted_on)s.")),{poster:me(e.poll),posted_on:ve(e.poll)},!0);return(0,n.Z)("li",{className:"poll-info-creation",dangerouslySetInnerHTML:{__html:t}})}function me(e){return e.url.poster?interpolate(pe,{url:(0,le.Z)(e.url.poster),user:(0,le.Z)(e.poster_name)},!0):interpolate(ce,{user:(0,le.Z)(e.poster_name)},!0)}function ve(e){return interpolate(de,{absolute:(0,le.Z)(e.posted_on.format("LLL")),relative:(0,le.Z)(e.posted_on.fromNow())},!0)}function ge(e){if(!e.poll.length)return null;const t=interpolate((0,le.Z)(pgettext("thread poll","Voting ends %(ends_on)s.")),{ends_on:Ze(e.poll)},!0);return(0,n.Z)("li",{className:"poll-info-ends-on",dangerouslySetInnerHTML:{__html:t}})}function Ze(e){return interpolate(de,{absolute:(0,le.Z)(e.endsOn.format("LLL")),relative:(0,le.Z)(e.endsOn.fromNow())},!0)}function be(e){const t=npgettext("thread poll","%(votes)s vote.","%(votes)s votes.",e.votes),s=interpolate(t,{votes:e.votes},!0);return(0,n.Z)("li",{className:"poll-info-votes"},void 0,s)}function _e(e){return e.poll.is_public?(0,n.Z)("li",{className:"poll-info-public"},void 0,pgettext("thread poll","Voting is public.")):null}function fe(e){return(0,n.Z)("div",{className:"panel panel-default panel-poll"},void 0,(0,n.Z)("div",{className:"panel-body"},void 0,(0,n.Z)("h2",{},void 0,e.poll.question),(0,n.Z)(ue,{poll:e.poll}),(0,n.Z)(D,{poll:e.poll}),(0,n.Z)(se,{isPollOver:e.isPollOver,poll:e.poll,showVoting:e.showVoting,thread:e.thread})))}function Ne(e){return(0,n.Z)("ul",{className:"list-unstyled list-inline poll-help"},void 0,(0,n.Z)(xe,{choicesLeft:e.choicesLeft}),(0,n.Z)(ye,{poll:e.poll}))}function xe(e){let{choicesLeft:t}=e;if(0===t)return(0,n.Z)("li",{className:"poll-help-choices-left"},void 0,pgettext("thread poll","You can't select any more choices."));const s=npgettext("thread poll","You can select %(choices)s more choice.","You can select %(choices)s more choices.",t),a=interpolate(s,{choices:t},!0);return(0,n.Z)("li",{className:"poll-help-choices-left"},void 0,a)}function ye(e){return e.poll.allow_revotes?(0,n.Z)("li",{className:"poll-help-allow-revotes"},void 0,pgettext("thread poll","You can change your vote later.")):(0,n.Z)("li",{className:"poll-help-no-revotes"},void 0,pgettext("thread poll","Votes are final."))}function we(e){return(0,n.Z)("ul",{className:"list-unstyled poll-select-choices"},void 0,e.choices.map((t=>(0,n.Z)(ke,{choice:t,toggleChoice:e.toggleChoice},t.hash))))}class ke extends r.Component{onClick=()=>{this.props.toggleChoice(this.props.choice.hash)};render(){return(0,n.Z)("li",{className:"poll-select-choice"},void 0,(0,n.Z)("button",{className:this.props.choice.selected?"btn btn-selected":"btn",onClick:this.onClick,type:"button"},void 0,(0,n.Z)("span",{className:"material-icon"},void 0,this.props.choice.selected?"check_box":"check_box_outline_blank"),(0,n.Z)("strong",{},void 0,this.props.choice.label)))}}function Ce(e,t){let s=[];for(const e in t){const a=t[e];a.selected&&s.push(a)}return e.allowed_choices-s.length}var Se=s(2211);const Ee=class extends d.Z{constructor(e){super(e),this.state={isLoading:!1,choices:e.poll.choices,choicesLeft:Ce(e.poll,e.poll.choices)}}toggleChoice=e=>{const t=function(e,t){for(const s in e){const a=e[s];if(a.hash===t)return a}return null}(this.state.choices,e);let s=null;s=t.selected?this.deselectChoice(t,e):this.selectChoice(t,e),this.setState({choices:s,choicesLeft:Ce(this.props.poll,s)})};selectChoice=(e,t)=>{if(!Ce(this.props.poll,this.state.choices))for(const e in this.state.choices.slice()){const s=this.state.choices[e];if(s.selected&&s.hash!=t){s.selected=!1;break}}return this.state.choices.map((e=>Object.assign({},e,{selected:e.hash==t||e.selected})))};deselectChoice=(e,t)=>this.state.choices.map((e=>Object.assign({},e,{selected:e.hash!=t&&e.selected})));clean(){return this.state.choicesLeft!==this.props.poll.allowed_choices||(v.Z.error(gettext("You need to select at least one choice")),!1)}send(){let e=[];for(const t in this.state.choices.slice()){const s=this.state.choices[t];s.selected&&e.push(s.hash)}return h.Z.post(this.props.poll.api.votes,e)}handleSuccess(e){g.Z.dispatch(ee.gx(e)),v.Z.success(gettext("Your vote has been saved.")),this.props.showResults()}handleError(e){400===e.status?v.Z.error(e.detail):v.Z.apiError(e)}render(){const e=[];return this.props.poll.acl.can_vote&&e.push(0),(this.props.poll.is_public||this.props.poll.acl.can_see_votes)&&e.push(1),this.props.poll.acl.can_edit&&e.push(2),this.props.poll.acl.can_delete&&e.push(3),(0,n.Z)("div",{className:"panel panel-default panel-poll"},void 0,(0,n.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,n.Z)("div",{className:"panel-body"},void 0,(0,n.Z)("h2",{},void 0,this.props.poll.question),(0,n.Z)(ue,{poll:this.props.poll}),(0,n.Z)(we,{choices:this.state.choices,toggleChoice:this.toggleChoice}),(0,n.Z)(Ne,{choicesLeft:this.state.choicesLeft,poll:this.props.poll})),(0,n.Z)("div",{className:"panel-footer"},void 0,(0,n.Z)("div",{className:"row"},void 0,(0,n.Z)("div",{className:ae(e,0)},void 0,(0,n.Z)(Se.Z,{className:"btn-primary btn-block btn-sm",loading:this.state.isLoading},void 0,gettext("Save your vote"))),(0,n.Z)("div",{className:ae(e,1)},void 0,(0,n.Z)("button",{className:"btn btn-default btn-block btn-sm",disabled:this.state.isLoading,onClick:this.props.showResults,type:"button"},void 0,gettext("See results"))),(0,n.Z)(ne,{controls:e,poll:this.props.poll,thread:this.props.thread,onClick:this.props.edit}),(0,n.Z)(re,{controls:e,poll:this.props.poll})))))}},Le=class extends r.Component{constructor(e){super(e);let t=!0;e.user.id&&!e.poll.hasSelectedChoices&&(t=!1),this.state={showResults:t}}showResults=()=>{this.setState({showResults:!0})};showVoting=()=>{this.setState({showResults:!1})};render(){if(!this.props.thread.poll)return null;const e=function(e){return!!e.length&&I()().isAfter(e.endsOn)}(this.props.poll);return e||!this.props.poll.acl.can_vote||this.state.showResults?r.createElement(fe,(0,l.Z)({isPollOver:e,showVoting:this.showVoting},this.props)):r.createElement(Ee,(0,l.Z)({showResults:this.showResults},this.props))}};var Te;const Pe=class extends r.Component{onAdd=()=>{let e=this.props.choices.slice();e.push({hash:Re(),label:""}),this.props.setChoices(e)};onChange=(e,t)=>{const s=this.props.choices.map((s=>(s.hash===e&&(s.label=t),s)));this.props.setChoices(s)};onDelete=e=>{const t=this.props.choices.filter((t=>t.hash!==e));this.props.setChoices(t)};render(){return(0,n.Z)("div",{className:"poll-choices-control"},void 0,(0,n.Z)("ul",{className:"list-group"},void 0,this.props.choices.map((e=>(0,n.Z)(Oe,{canDelete:this.props.choices.length>2,choice:e,disabled:this.props.disabled,onChange:this.onChange,onDelete:this.onDelete},e.hash)))),(0,n.Z)("button",{className:"btn btn-default btn-sm",disabled:this.props.disabled,onClick:this.onAdd,type:"button"},void 0,pgettext("thread poll","Add choice")))}};class Oe extends r.Component{onChange=e=>{this.props.onChange(this.props.choice.hash,e.target.value)};onDelete=()=>{window.confirm(pgettext("thread poll","Are you sure you want to remove this choice?"))&&this.props.onDelete(this.props.choice.hash)};render(){return(0,n.Z)("li",{className:"list-group-item"},void 0,(0,n.Z)("button",{className:"btn",disabled:!this.props.canDelete||this.props.disabled,onClick:this.onDelete,title:pgettext("thread poll","Remove this choice"),type:"button"},void 0,Te||(Te=(0,n.Z)("span",{className:"material-icon"},void 0,"close"))),(0,n.Z)("input",{disabled:this.props.disabled,maxLength:"255",placeholder:pgettext("thread poll","Poll choice"),type:"text",onChange:this.onChange,value:this.props.choice.label}))}}function Re(){let e="";for(;12!=e.length;)e=Math.random().toString(36).replace(/[^a-zA-Z0-9]+/g,"").substr(1,12);return e}var Ae=s(7227);const Ie=class extends d.Z{constructor(e){super(e);const t=e.poll.id?e.poll:{question:"",choices:[{hash:"choice-10000",label:""},{hash:"choice-20000",label:""}],length:0,allowed_choices:1,allow_revotes:0,is_public:0};this.state={isLoading:!1,isEdit:!!t.id,question:t.question,choices:t.choices,length:t.length,allowed_choices:t.allowed_choices,allow_revotes:t.allow_revotes,is_public:t.is_public,validators:{question:[],choices:[],length:[],allowed_choices:[]},errors:{}}}setChoices=e=>{const t=Object.assign({},t,{choices:null});this.setState({choices:e,errors:t})};onCancel=()=>{let e=!1;e=this.props.poll?window.confirm(pgettext("thread poll","Are you sure you want to discard changes?")):window.confirm(pgettext("thread poll","Are you sure you want to discard new poll?")),e&&this.props.close()};send(){const e={question:this.state.question,choices:this.state.choices,length:this.state.length,allowed_choices:this.state.allowed_choices,allow_revotes:this.state.allow_revotes,is_public:this.state.is_public};return this.state.isEdit?h.Z.put(this.props.poll.api.index,e):h.Z.post(this.props.thread.api.poll,e)}handleSuccess(e){g.Z.dispatch(ee.gx(e)),this.state.isEdit?v.Z.success(pgettext("thread poll","Poll has been edited.")):v.Z.success(pgettext("thread poll","Poll has been posted.")),this.props.close()}handleError(e){400===e.status?(e.non_field_errors&&(e.allowed_choices=e.non_field_errors),this.setState({errors:Object.assign({},e)}),v.Z.error(gettext("Form contains errors."))):v.Z.apiError(e)}render(){return(0,n.Z)("div",{className:"poll-form"},void 0,(0,n.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,n.Z)("div",{className:"panel panel-default panel-form"},void 0,(0,n.Z)("div",{className:"panel-heading"},void 0,(0,n.Z)("h3",{className:"panel-title"},void 0,this.state.isEdit?pgettext("thread poll","Edit poll"):pgettext("thread poll","Add poll"))),(0,n.Z)("div",{className:"panel-body"},void 0,(0,n.Z)("fieldset",{},void 0,(0,n.Z)("legend",{},void 0,pgettext("thread poll","Question and choices")),(0,n.Z)(c.Z,{label:pgettext("thread poll","Poll question"),for:"id_questions",validation:this.state.errors.question},void 0,(0,n.Z)("input",{className:"form-control",disabled:this.state.isLoading,id:"id_questions",onChange:this.bindInput("question"),type:"text",maxLength:"255",value:this.state.question})),(0,n.Z)(c.Z,{label:pgettext("thread poll","Available choices"),validation:this.state.errors.choices},void 0,(0,n.Z)(Pe,{choices:this.state.choices,disabled:this.state.isLoading,setChoices:this.setChoices}))),(0,n.Z)("fieldset",{},void 0,(0,n.Z)("legend",{},void 0,pgettext("thread poll","Voting")),(0,n.Z)("div",{className:"row"},void 0,(0,n.Z)("div",{className:"col-xs-12 col-sm-6"},void 0,(0,n.Z)(c.Z,{label:pgettext("thread poll","Poll length"),helpText:pgettext("thread poll","Enter number of days for which voting in this poll should be possible or zero to run this poll indefinitely."),for:"id_length",validation:this.state.errors.length},void 0,(0,n.Z)("input",{className:"form-control",disabled:this.state.isLoading,id:"id_length",onChange:this.bindInput("length"),type:"text",value:this.state.length}))),(0,n.Z)("div",{className:"col-xs-12 col-sm-6"},void 0,(0,n.Z)(c.Z,{label:pgettext("thread poll","Allowed choices"),for:"id_allowed_choices",validation:this.state.errors.allowed_choices},void 0,(0,n.Z)("input",{className:"form-control",disabled:this.state.isLoading,id:"id_allowed_choices",onChange:this.bindInput("allowed_choices"),type:"text",maxLength:"255",value:this.state.allowed_choices})))),(0,n.Z)("div",{className:"row"},void 0,(0,n.Z)(De,{bindInput:this.bindInput,disabled:this.state.isLoading,isEdit:this.state.isEdit,value:this.state.is_public}),(0,n.Z)("div",{className:"col-xs-12 col-sm-6"},void 0,(0,n.Z)(c.Z,{label:pgettext("thread poll","Allow vote changes"),for:"id_allow_revotes"},void 0,(0,n.Z)(Ae.Z,{id:"id_allow_revotes",disabled:this.state.isLoading,iconOn:"check",iconOff:"close",labelOn:pgettext("thread poll","Allow participants to change their vote"),labelOff:pgettext("thread poll","Don't allow participants to change their vote"),onChange:this.bindInput("allow_revotes"),value:this.state.allow_revotes})))))),(0,n.Z)("div",{className:"panel-footer text-right"},void 0,(0,n.Z)("button",{className:"btn btn-default",disabled:this.state.isLoading,onClick:this.onCancel,type:"button"},void 0,pgettext("thread poll","Cancel"))," ",(0,n.Z)(Se.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,this.state.isEdit?pgettext("thread poll","Save changes"):pgettext("thread poll","Post poll"))))))}};function De(e){return e.isEdit?null:(0,n.Z)("div",{className:"col-xs-12 col-sm-6"},void 0,(0,n.Z)(c.Z,{label:pgettext("thread poll","Make voting public"),helpText:pgettext("thread poll","Making voting public will allow everyone to access detailed list of votes, showing which users voted for which choices and at which times. This option can't be changed after poll's creation. Moderators may see voting details for all polls."),for:"id_is_public"},void 0,(0,n.Z)(Ae.Z,{id:"id_is_public",disabled:e.disabled,iconOn:"visibility",iconOff:"visibility_off",labelOn:pgettext("thread poll","Votes are public"),labelOff:pgettext("thread poll","Votes are hidden"),onChange:e.bindInput("is_public"),value:e.value})))}const je={changed_title:"edit",pinned_globally:"bookmark",pinned_locally:"bookmark_border",unpinned:"panorama_fish_eye",moved:"arrow_forward",merged:"call_merge",approved:"done",opened:"lock_open",closed:"lock_outline",unhid:"visibility",hid:"visibility_off",changed_owner:"grade",tookover:"grade",added_participant:"person_add",owner_left:"person_outline",participant_left:"person_outline",removed_participant:"remove_circle_outline"},ze=e=>(0,n.Z)("span",{className:"event-icon-bg"},void 0,(0,n.Z)("span",{className:"material-icon"},void 0,je[e.post.event_type]));var Ue=s(2747);function Me(e){return e.post.acl.can_hide?(0,n.Z)("li",{className:"event-controls"},void 0,r.createElement(Be,e),r.createElement(qe,e),r.createElement(He,e)):null}class Be extends r.Component{onClick=()=>{g.Z.dispatch(Ue.r$(this.props.post,{is_hidden:!0,hidden_on:I()(),hidden_by_name:this.props.user.username,url:Object.assign(this.props.post.url,{hidden_by:this.props.user.url})})),h.Z.patch(this.props.post.api.index,[{op:"replace",path:"is-hidden",value:!0}]).then((e=>{g.Z.dispatch(Ue.r$(this.props.post,e))}),(e=>{400===e.status?v.Z.error(e.detail[0]):v.Z.apiError(e),g.Z.dispatch(Ue.r$(this.props.post,{is_hidden:!1}))}))};render(){return this.props.post.is_hidden?null:(0,n.Z)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,gettext("Hide"))}}class qe extends r.Component{onClick=()=>{g.Z.dispatch(Ue.r$(this.props.post,{is_hidden:!1})),h.Z.patch(this.props.post.api.index,[{op:"replace",path:"is-hidden",value:!1}]).then((e=>{g.Z.dispatch(Ue.r$(this.props.post,e))}),(e=>{400===e.status?v.Z.error(e.detail[0]):v.Z.apiError(e),g.Z.dispatch(Ue.r$(this.props.post,{is_hidden:!0}))}))};render(){return this.props.post.is_hidden?(0,n.Z)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,gettext("Unhide")):null}}class He extends r.Component{onClick=()=>{window.confirm(gettext("Are you sure you wish to delete this event? This action is not reversible!"))&&this.delete()};delete=()=>{g.Z.dispatch(Ue.r$(this.props.post,{isDeleted:!0})),h.Z.delete(this.props.post.api.index).then((()=>{v.Z.success(gettext("Event has been deleted."))}),(e=>{400===e.status?v.Z.error(e.detail[0]):v.Z.apiError(e),g.Z.dispatch(Ue.r$(this.props.post,{isDeleted:!1}))}))};render(){return(0,n.Z)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,gettext("Delete"))}}const Fe='<abbr title="%(absolute)s">%(relative)s</abbr>',Ye='<a href="%(url)s" title="%(absolute)s">%(relative)s</a>',Ve='<span class="item-title">%(user)s</span>',Ge='<a href="%(url)s" class="item-title">%(user)s</a>';function $e(e){return(0,n.Z)("ul",{className:"list-inline event-info"},void 0,r.createElement(We,e),r.createElement(Qe,e),r.createElement(Me,e))}function We(e){if(e.post.is_hidden){let t=null;t=e.post.url.hidden_by?interpolate(Ge,{url:(0,le.Z)(e.post.url.hidden_by),user:(0,le.Z)(e.post.hidden_by_name)},!0):interpolate(Ve,{user:(0,le.Z)(e.post.hidden_by_name)},!0);const s=interpolate(Fe,{absolute:(0,le.Z)(e.post.hidden_on.format("LLL")),relative:(0,le.Z)(e.post.hidden_on.fromNow())},!0),a=interpolate((0,le.Z)(gettext("Hidden by %(event_by)s %(event_on)s.")),{event_by:t,event_on:s},!0);return(0,n.Z)("li",{className:"event-hidden-message",dangerouslySetInnerHTML:{__html:a}})}return null}function Qe(e){let t=null;t=e.post.poster?interpolate(Ge,{url:(0,le.Z)(e.post.poster.url),user:(0,le.Z)(e.post.poster_name)},!0):interpolate(Ve,{user:(0,le.Z)(e.post.poster_name)},!0);const s=interpolate(Ye,{url:(0,le.Z)(e.post.url.index),absolute:(0,le.Z)(e.post.posted_on.format("LLL")),relative:(0,le.Z)(e.post.posted_on.fromNow())},!0),a=interpolate((0,le.Z)(gettext("By %(event_by)s %(event_on)s.")),{event_by:t,event_on:s},!0);return(0,n.Z)("li",{className:"event-posters",dangerouslySetInnerHTML:{__html:a}})}const Ke={pinned_globally:gettext("Thread has been pinned globally."),pinned_locally:gettext("Thread has been pinned locally."),unpinned:gettext("Thread has been unpinned."),approved:gettext("Thread has been approved."),opened:gettext("Thread has been opened."),closed:gettext("Thread has been closed."),unhid:gettext("Thread has been revealed."),hid:gettext("Thread has been made hidden."),tookover:gettext("Took thread over."),owner_left:gettext("Owner has left thread. This thread is now closed."),participant_left:gettext("Participant has left thread.")},Je='<a href="%(url)s" class="item-title">%(name)s</a>',Xe='<span class="item-title">%(name)s</span>';function et(e){return Ke[e.post.event_type]?(0,n.Z)("p",{className:"event-message"},void 0,Ke[e.post.event_type]):"changed_title"===e.post.event_type?r.createElement(tt,e):"moved"===e.post.event_type?r.createElement(st,e):"merged"===e.post.event_type?r.createElement(at,e):"changed_owner"===e.post.event_type?r.createElement(it,e):"added_participant"===e.post.event_type?r.createElement(ot,e):"removed_participant"===e.post.event_type?r.createElement(nt,e):null}function tt(e){const t=(0,le.Z)(gettext("Thread title has been changed from %(old_title)s.")),s=interpolate(Xe,{name:(0,le.Z)(e.post.event_context.old_title)},!0),a=interpolate(t,{old_title:s},!0);return(0,n.Z)("p",{className:"event-message",dangerouslySetInnerHTML:{__html:a}})}function st(e){const t=(0,le.Z)(gettext("Thread has been moved from %(from_category)s.")),s=interpolate(Je,{url:(0,le.Z)(e.post.event_context.from_category.url),name:(0,le.Z)(e.post.event_context.from_category.name)},!0),a=interpolate(t,{from_category:s},!0);return(0,n.Z)("p",{className:"event-message",dangerouslySetInnerHTML:{__html:a}})}function at(e){const t=(0,le.Z)(gettext("The %(merged_thread)s thread has been merged into this thread.")),s=interpolate(Xe,{name:(0,le.Z)(e.post.event_context.merged_thread)},!0),a=interpolate(t,{merged_thread:s},!0);return(0,n.Z)("p",{className:"event-message",dangerouslySetInnerHTML:{__html:a}})}function it(e){const t=(0,le.Z)(gettext("Changed thread owner to %(user)s.")),s=interpolate(Je,{url:(0,le.Z)(e.post.event_context.user.url),name:(0,le.Z)(e.post.event_context.user.username)},!0),a=interpolate(t,{user:s},!0);return(0,n.Z)("p",{className:"event-message",dangerouslySetInnerHTML:{__html:a}})}function ot(e){const t=(0,le.Z)(gettext("Added %(user)s to thread.")),s=interpolate(Je,{url:(0,le.Z)(e.post.event_context.user.url),name:(0,le.Z)(e.post.event_context.user.username)},!0),a=interpolate(t,{user:s},!0);return(0,n.Z)("p",{className:"event-message",dangerouslySetInnerHTML:{__html:a}})}function nt(e){const t=(0,le.Z)(gettext("Removed %(user)s from thread.")),s=interpolate(Je,{url:(0,le.Z)(e.post.event_context.user.url),name:(0,le.Z)(e.post.event_context.user.username)},!0),a=interpolate(t,{user:s},!0);return(0,n.Z)("p",{className:"event-message",dangerouslySetInnerHTML:{__html:a}})}function rt(e){let{post:t}=e;return t.is_read?null:(0,n.Z)("div",{className:"event-label"},void 0,(0,n.Z)("span",{className:"label label-unread"},void 0,gettext("New event")))}var lt=s(9755);const dt=class extends r.Component{componentDidMount(){this.props.post.is_read||lt(this.element).waypoint({handler:e=>{"down"!==e||this.props.post.is_read||window.setTimeout((()=>{const e=this.element.getBoundingClientRect(),t=e.height+e.top,s=document.documentElement.clientHeight;t<5||t>s||(g.Z.dispatch(Ue.r$(this.props.post,{is_read:!0})),h.Z.post(this.props.post.api.read).then((e=>{g.Z.dispatch(u.Vx(this.props.thread,{is_read:e.thread_is_read}))}),(e=>{v.Z.apiError(e)})))}),1e3)},offset:"bottom-in-view"})}render(){return r.createElement("div",{className:this.props.className,ref:e=>{e&&(this.element=e)}},this.props.children)}};function ct(e){let t="event";return e.post.isDeleted?t="hide":e.post.is_hidden&&(t="event post-hidden"),(0,n.Z)("li",{id:"post-"+e.post.id,className:t},void 0,(0,n.Z)(rt,{post:e.post}),(0,n.Z)("div",{className:"event-body"},void 0,(0,n.Z)("div",{className:"event-icon"},void 0,r.createElement(ze,e)),(0,n.Z)(dt,{className:"event-content",post:e.post},void 0,r.createElement(et,e),r.createElement($e,e))))}var pt=s(9130),ut=s(8772);const ht='<abbr title="%(absolute)s">%(relative)s</abbr>',mt='<span class="item-title">%(user)s</span>',vt='<a href="%(url)s" class="item-title">%(user)s</a>';function gt(e){return(0,n.Z)("div",{className:"col-xs-12 col-md-6"},void 0,r.createElement(Zt,e),(0,n.Z)("div",{className:"post-attachment"},void 0,(0,n.Z)("a",{href:e.attachment.url.index,className:"attachment-name item-title",target:"_blank"},void 0,e.attachment.filename),r.createElement(ft,e)))}function Zt(e){return e.attachment.is_image?(0,n.Z)("div",{className:"post-attachment-preview"},void 0,r.createElement(_t,e)):(0,n.Z)("div",{className:"post-attachment-preview"},void 0,r.createElement(bt,e))}function bt(e){return(0,n.Z)("a",{href:e.attachment.url.index,className:"material-icon"},void 0,"insert_drive_file")}function _t(e){const t=e.attachment.url.thumb||e.attachment.url.index;return(0,n.Z)("a",{className:"post-thumbnail",href:e.attachment.url.index,target:"_blank",style:{backgroundImage:'url("'+(0,le.Z)(t)+'")'}})}function ft(e){let t=null;t=e.attachment.url.uploader?interpolate(vt,{url:(0,le.Z)(e.attachment.url.uploader),user:(0,le.Z)(e.attachment.uploader_name)},!0):interpolate(mt,{user:(0,le.Z)(e.attachment.uploader_name)},!0);const s=interpolate(ht,{absolute:(0,le.Z)(e.attachment.uploaded_on.format("LLL")),relative:(0,le.Z)(e.attachment.uploaded_on.fromNow())},!0),a=interpolate((0,le.Z)(gettext("%(filetype)s, %(size)s, uploaded by %(uploader)s %(uploaded_on)s.")),{filetype:e.attachment.filetype,size:(0,ut.Z)(e.attachment.size),uploader:t,uploaded_on:s},!0);return(0,n.Z)("p",{className:"post-attachment-description",dangerouslySetInnerHTML:{__html:a}})}function Nt(e){return function(e){return(!e.is_hidden||e.acl.can_see_hidden)&&e.attachments}(e.post)?(0,n.Z)("div",{className:"post-attachments"},void 0,(0,pt.Z)(e.post.attachments,2).map((e=>{const t=e.map((e=>e?e.id:0)).join("_");return(0,n.Z)(xt,{row:e},t)}))):null}function xt(e){return(0,n.Z)("div",{className:"row"},void 0,e.row.map((e=>(0,n.Z)(gt,{attachment:e},e?e.id:0))))}var yt=s(9092);const wt='<a href="%(url)s" class="item-title">%(user)s</a>',kt='<span class="item-title">%(user)s</span>',Ct='<abbr class="last-title" title="%(absolute)s">%(relative)s</abbr>';function St(e){return e.post.is_hidden&&!e.post.acl.can_see_hidden?r.createElement(Lt,e):e.post.content?r.createElement(Et,e):r.createElement(Tt,e)}function Et(e){let{post:t}=e;const s="@"+(t.poster?t.poster.username:t.poster_name);return(0,n.Z)(dt,{className:"post-body",post:t},void 0,(0,n.Z)(yt.Z,{author:s,markup:t.content}))}function Lt(e){let t=null;t=e.post.hidden_by?interpolate(wt,{url:(0,le.Z)(e.post.url.hidden_by),user:(0,le.Z)(e.post.hidden_by_name)},!0):interpolate(kt,{user:(0,le.Z)(e.post.hidden_by_name)},!0);const s=interpolate(Ct,{absolute:(0,le.Z)(e.post.hidden_on.format("LLL")),relative:(0,le.Z)(e.post.hidden_on.fromNow())},!0),a=interpolate((0,le.Z)(gettext("Hidden by %(hidden_by)s %(hidden_on)s.")),{hidden_by:t,hidden_on:s},!0);return(0,n.Z)(dt,{className:"post-body post-body-hidden",post:e.post},void 0,(0,n.Z)("p",{className:"lead"},void 0,gettext("This post is hidden. You cannot see its contents.")),(0,n.Z)("p",{className:"text-muted",dangerouslySetInnerHTML:{__html:a}}))}function Tt(e){return(0,n.Z)(dt,{className:"post-body post-body-invalid",post:e.post},void 0,(0,n.Z)("p",{className:"lead"},void 0,gettext("This post's contents cannot be displayed.")),(0,n.Z)("p",{className:"text-muted"},void 0,gettext("This error is caused by invalid post content manipulation.")))}var Pt,Ot,Rt,At,It,Dt,jt;function zt(e){let{post:t,thread:s,user:a}=e;if(!qt(t)||t.id!==s.best_answer)return null;let i=null;return i=a.id&&s.best_answer_marked_by===a.id?interpolate(gettext("Marked as best answer by you %(marked_on)s."),{marked_on:s.best_answer_marked_on.fromNow()},!0):interpolate(gettext("Marked as best answer by %(marked_by)s %(marked_on)s."),{marked_by:s.best_answer_marked_by_name,marked_on:s.best_answer_marked_on.fromNow()},!0),(0,n.Z)("div",{className:"post-status-message post-status-best-answer"},void 0,Pt||(Pt=(0,n.Z)("span",{className:"material-icon"},void 0,"check_box")),(0,n.Z)("p",{},void 0,i))}function Ut(e){return qt(e.post)&&e.post.is_hidden?(0,n.Z)("div",{className:"post-status-message post-status-hidden"},void 0,Ot||(Ot=(0,n.Z)("span",{className:"material-icon"},void 0,"visibility_off")),(0,n.Z)("p",{},void 0,gettext("This post is hidden. Only users with permission may see its contents."))):null}function Mt(e){return qt(e.post)&&e.post.is_unapproved?(0,n.Z)("div",{className:"post-status-message post-status-unapproved"},void 0,Rt||(Rt=(0,n.Z)("span",{className:"material-icon"},void 0,"remove_circle_outline")),(0,n.Z)("p",{},void 0,gettext("This post is unapproved. Only users with permission to approve posts and its author may see its contents."))):null}function Bt(e){return qt(e.post)&&e.post.is_protected?(0,n.Z)("div",{className:"post-status-message post-status-protected visible-xs-block"},void 0,At||(At=(0,n.Z)("span",{className:"material-icon"},void 0,"lock_outline")),(0,n.Z)("p",{},void 0,gettext("This post is protected. Only moderators may change it."))):null}function qt(e){return!e.is_hidden||e.acl.can_see_hidden}function Ht(e,t,s){h.Z.patch(e.post.api.index,t).then((t=>{g.Z.dispatch(Ue.r$(e.post,t))}),(t=>{400===t.status?v.Z.error(t.detail[0]):v.Z.apiError(t),g.Z.dispatch(Ue.r$(e.post,s))}))}function Ft(e){const{post:t,user:s}=e;g.Z.dispatch(u.Vx({best_answer:t.id,best_answer_is_protected:t.is_protected,best_answer_marked_on:I()(),best_answer_marked_by:s.id,best_answer_marked_by_name:s.username,best_answer_marked_by_slug:s.slug})),Yt(e,[{op:"replace",path:"best-answer",value:t.id},{op:"add",path:"acl",value:!0}],{best_answer:e.thread.best_answer,best_answer_is_protected:e.thread.best_answer_is_protected,best_answer_marked_on:e.thread.best_answer_marked_on,best_answer_marked_by:e.thread.best_answer_marked_by,best_answer_marked_by_name:e.thread.best_answer_marked_by_name,best_answer_marked_by_slug:e.thread.best_answer_marked_by_slug})}function Yt(e,t,s){h.Z.patch(e.thread.api.index,t).then((e=>{e.best_answer_marked_on&&(e.best_answer_marked_on=I()(e.best_answer_marked_on)),g.Z.dispatch(u.Vx(e))}),(e=>{400===e.status?v.Z.error(e.detail[0]):v.Z.apiError(e),g.Z.dispatch(u.Vx(s))}))}const Vt=class extends r.Component{constructor(e){super(e),this.state={isReady:!1,error:null,likes:[]}}componentDidMount(){h.Z.get(this.props.post.api.likes).then((e=>{this.setState({isReady:!0,likes:e.map(Gt)})}),(e=>{this.setState({isReady:!0,error:e.detail})}))}render(){return this.state.error?(0,n.Z)($t,{className:"modal-message"},void 0,(0,n.Z)(F.Z,{message:this.state.error})):this.state.isReady?this.state.likes.length?(0,n.Z)($t,{className:"modal-sm",likes:this.state.likes},void 0,(0,n.Z)(Wt,{likes:this.state.likes})):(0,n.Z)($t,{className:"modal-message"},void 0,(0,n.Z)(F.Z,{message:gettext("No users have liked this post.")})):It||(It=(0,n.Z)($t,{className:"modal-sm"},void 0,(0,n.Z)(Y.Z,{})))}};function Gt(e){return Object.assign({},e,{liked_on:I()(e.liked_on)})}function $t(e){let{className:t,children:s,likes:a}=e,i=gettext("Post Likes");if(a){const e=a.length,t=ngettext("%(likes)s like","%(likes)s likes",e);i=interpolate(t,{likes:e},!0)}return(0,n.Z)("div",{className:"modal-dialog "+(t||""),role:"document"},void 0,(0,n.Z)("div",{className:"modal-content"},void 0,(0,n.Z)("div",{className:"modal-header"},void 0,(0,n.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,Dt||(Dt=(0,n.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,n.Z)("h4",{className:"modal-title"},void 0,i)),s))}function Wt(e){return(0,n.Z)("div",{className:"modal-body modal-post-likers"},void 0,(0,n.Z)("ul",{className:"media-list"},void 0,e.likes.map((e=>r.createElement(Qt,(0,l.Z)({key:e.id},e))))))}function Qt(e){if(e.url){const t={id:e.liker_id,avatars:e.avatars};return(0,n.Z)("li",{className:"media"},void 0,(0,n.Z)("div",{className:"media-left"},void 0,(0,n.Z)("a",{className:"user-avatar",href:e.url},void 0,(0,n.Z)(S.ZP,{size:"50",user:t}))),(0,n.Z)("div",{className:"media-body"},void 0,(0,n.Z)("a",{className:"item-title",href:e.url},void 0,e.username)," ",(0,n.Z)(Kt,{likedOn:e.liked_on})))}return(0,n.Z)("li",{className:"media"},void 0,jt||(jt=(0,n.Z)("div",{className:"media-left"},void 0,(0,n.Z)("span",{className:"user-avatar"},void 0,(0,n.Z)(S.ZP,{size:"50"})))),(0,n.Z)("div",{className:"media-body"},void 0,(0,n.Z)("strong",{},void 0,e.username)," ",(0,n.Z)(Kt,{likedOn:e.liked_on})))}function Kt(e){return(0,n.Z)("span",{className:"text-muted",title:e.likedOn.format("LLL")},void 0,e.likedOn.fromNow())}var Jt,Xt,es,ts,ss,as;function is(e){return function(e){return(!e.is_hidden||e.acl.can_see_hidden)&&(e.acl.can_reply||e.acl.can_edit||e.acl.can_see_likes&&(e.last_likes||[]).length||e.acl.can_like)}(e.post)?(0,n.Z)("div",{className:"post-footer"},void 0,r.createElement(os,e),r.createElement(ns,e),r.createElement(rs,e),r.createElement(ls,(0,l.Z)({lastLikes:e.post.last_likes,likes:e.post.likes},e)),r.createElement(ds,(0,l.Z)({likes:e.post.likes},e)),r.createElement(ps,e),r.createElement(us,e)):null}class os extends r.Component{onClick=()=>{Ft(this.props)};render(){const{post:e,thread:t}=this.props;return t.acl.can_mark_best_answer&&e.acl.can_mark_as_best_answer?t.best_answer&&!t.acl.can_change_best_answer?null:(0,n.Z)("button",{className:"hidden-xs btn btn-default btn-sm pull-left",disabled:this.props.post.isBusy||e.id===t.best_answer,onClick:this.onClick,type:"button"},void 0,Jt||(Jt=(0,n.Z)("span",{className:"material-icon"},void 0,"check_box")),gettext("Best answer")):null}}class ns extends r.Component{onClick=()=>{Ft(this.props)};render(){const{post:e,thread:t}=this.props;return t.acl.can_mark_best_answer&&e.acl.can_mark_as_best_answer?t.best_answer&&!t.acl.can_change_best_answer?null:(0,n.Z)("button",{className:"visible-xs-inline-block btn btn-default btn-sm pull-left",disabled:this.props.post.isBusy||e.id===t.best_answer,onClick:this.onClick,type:"button"},void 0,Xt||(Xt=(0,n.Z)("span",{className:"material-icon"},void 0,"check_box"))):null}}class rs extends r.Component{onClick=()=>{this.props.post.is_liked?function(e){g.Z.dispatch(Ue.r$(e.post,{is_liked:!1,likes:e.post.likes-1,last_likes:e.post.last_likes.filter((t=>!t.id||t.id!==e.user.id))}));const t={is_liked:e.post.is_liked,likes:e.post.likes,last_likes:e.post.last_likes};Ht(e,[{op:"replace",path:"is-liked",value:!1}],t)}(this.props):function(e){const t=e.post.last_likes||[],s=[e.user].concat(t),a=s.length>3?s.slice(0,-1):s;g.Z.dispatch(Ue.r$(e.post,{is_liked:!0,likes:e.post.likes+1,last_likes:a})),Ht(e,[{op:"replace",path:"is-liked",value:!0}],{is_liked:e.post.is_liked,likes:e.post.likes,last_likes:e.post.last_likes})}(this.props)};render(){if(!this.props.post.acl.can_like)return null;let e="btn btn-default btn-sm pull-left";return this.props.post.is_liked&&(e="btn btn-success btn-sm pull-left"),(0,n.Z)("button",{className:e,disabled:this.props.post.isBusy,onClick:this.onClick,type:"button"},void 0,this.props.post.is_liked?gettext("Liked"):gettext("Like"))}}class ls extends r.Component{onClick=()=>{m.Z.show((0,n.Z)(Vt,{post:this.props.post}))};render(){const e=(this.props.post.last_likes||[]).length>0;return this.props.post.acl.can_see_likes&&e?2===this.props.post.acl.can_see_likes?(0,n.Z)("button",{className:"btn btn-link btn-sm pull-left hidden-xs",onClick:this.onClick,type:"button"},void 0,cs(this.props.likes,this.props.lastLikes)):(0,n.Z)("p",{className:"pull-left hidden-xs"},void 0,cs(this.props.likes,this.props.lastLikes)):null}}class ds extends ls{render(){const e=(this.props.post.last_likes||[]).length>0;return this.props.post.acl.can_see_likes&&e?2===this.props.post.acl.can_see_likes?(0,n.Z)("button",{className:"btn btn-link btn-sm likes-compact pull-left visible-xs-block",onClick:this.onClick,type:"button"},void 0,es||(es=(0,n.Z)("span",{className:"material-icon"},void 0,"favorite")),this.props.likes):(0,n.Z)("p",{className:"likes-compact pull-left visible-xs-block"},void 0,ts||(ts=(0,n.Z)("span",{className:"material-icon"},void 0,"favorite")),this.props.likes):null}}function cs(e,t){const s=t.slice(0,3).map((e=>e.username));if(1==s.length)return interpolate(gettext("%(user)s likes this."),{user:s[0]},!0);const a=e-s.length,i=s.slice(0,-1).join(", "),o=s.slice(-1)[0],n=interpolate(gettext("%(users)s and %(last_user)s"),{users:i,last_user:o},!0);if(0===a)return interpolate(gettext("%(users)s like this."),{users:n},!0);const r=ngettext("%(users)s and %(likes)s other user like this.","%(users)s and %(likes)s other users like this.",a);return interpolate(r,{users:s.join(", "),likes:a},!0)}class ps extends r.Component{onClick=()=>{te.Z.open({mode:"REPLY",thread:this.props.thread,config:this.props.thread.api.editor,submit:this.props.thread.api.posts.index,context:{reply:this.props.post.id}})};render(){return this.props.post.acl.can_reply?(0,n.Z)("button",{className:"btn btn-primary btn-sm pull-right",type:"button",onClick:this.onClick},void 0,gettext("Reply")):null}}class us extends r.Component{onClick=()=>{te.Z.open({mode:"EDIT",thread:this.props.thread,post:this.props.post,config:this.props.post.api.editor,submit:this.props.post.api.index})};render(){return this.props.post.acl.can_edit?(0,n.Z)("button",{className:"hidden-xs btn btn-default btn-sm pull-right",type:"button",onClick:this.onClick},void 0,gettext("Edit")):null}}const hs=class extends d.Z{constructor(e){super(e),this.state={isLoading:!1,url:"",validators:{url:[]},errors:{}}}clean(){return!!this.state.url.trim().length||(v.Z.error(gettext("You have to enter link to the other thread.")),!1)}send(){return h.Z.post(this.props.thread.api.posts.move,{new_thread:this.state.url,posts:[this.props.post.id]})}handleSuccess(e){g.Z.dispatch(Ue.r$(this.props.post,{isDeleted:!0})),m.Z.hide(),v.Z.success(gettext("Selected post was moved to the other thread."))}handleError(e){400===e.status?v.Z.error(e.detail):v.Z.apiError(e)}onUrlChange=e=>{this.changeValue("url",e.target.value)};render(){return(0,n.Z)("div",{className:"modal-dialog",role:"document"},void 0,(0,n.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,n.Z)("div",{className:"modal-content"},void 0,ss||(ss=(0,n.Z)(ms,{})),(0,n.Z)("div",{className:"modal-body"},void 0,(0,n.Z)(c.Z,{for:"id_url",label:gettext("Link to thread you want to move post to")},void 0,(0,n.Z)("input",{className:"form-control",disabled:this.state.isLoading,id:"id_url",onChange:this.onUrlChange,value:this.state.url}))),(0,n.Z)("div",{className:"modal-footer"},void 0,(0,n.Z)("button",{className:"btn btn-primary",disabled:this.state.isLoading},void 0,gettext("Move post"))))))}};function ms(e){return(0,n.Z)("div",{className:"modal-header"},void 0,(0,n.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,as||(as=(0,n.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,n.Z)("h4",{className:"modal-title"},void 0,gettext("Move post")))}function vs(e){return(0,n.Z)("div",{className:"modal-body post-changelog-diff"},void 0,(0,n.Z)("ul",{className:"list-unstyled"},void 0,e.diff.map(((e,t)=>(0,n.Z)(gs,{item:e},t)))))}function gs(e){return"?"===e.item[0]?null:(0,n.Z)("li",{className:Zs(e.item)},void 0,e.item.substr(2))}function Zs(e){let t="diff-item";return"-"===e[0]?t+=" diff-item-sub":"+"===e[0]&&(t+=" diff-item-add"),t}const bs=class extends r.Component{onClick=()=>{this.props.revertEdit(this.props.edit.id)};render(){return this.props.canRevert?(0,n.Z)("div",{className:"modal-footer visible-xs-block"},void 0,(0,n.Z)(Se.Z,{className:"btn-default btn-sm btn-block",disabled:this.props.disabled,onClick:this.onClick,title:gettext("Revert post to state from before this edit.")},void 0,gettext("Revert"))):null}};var _s,fs,Ns;const xs=class extends r.Component{goLast=()=>{this.props.goToEdit()};goForward=()=>{this.props.goToEdit(this.props.edit.next)};goBack=()=>{this.props.goToEdit(this.props.edit.previous)};revertEdit=()=>{this.props.revertEdit(this.props.edit.id)};render(){return(0,n.Z)("div",{className:"modal-toolbar post-changelog-toolbar"},void 0,(0,n.Z)("div",{className:"row"},void 0,(0,n.Z)("div",{className:"col-xs-12 col-sm-4"},void 0,(0,n.Z)("div",{className:"row"},void 0,(0,n.Z)("div",{className:"col-xs-4"},void 0,(0,n.Z)(ys,{disabled:this.props.disabled,edit:this.props.edit,onClick:this.goBack})),(0,n.Z)("div",{className:"col-xs-4"},void 0,(0,n.Z)(ws,{disabled:this.props.disabled,edit:this.props.edit,onClick:this.goForward})),(0,n.Z)("div",{className:"col-xs-4"},void 0,(0,n.Z)(ks,{disabled:this.props.disabled,edit:this.props.edit,onClick:this.goLast})))),(0,n.Z)("div",{className:"col-xs-12 col-sm-5 xs-margin-top-half post-change-label"},void 0,(0,n.Z)(Ss,{edit:this.props.edit})),(0,n.Z)(Cs,{canRevert:this.props.canRevert,disabled:this.props.disabled,onClick:this.revertEdit})))}};function ys(e){return(0,n.Z)(Se.Z,{className:"btn-default btn-block btn-icon btn-sm",disabled:e.disabled||!e.edit.previous,onClick:e.onClick,title:gettext("See previous change")},void 0,_s||(_s=(0,n.Z)("span",{className:"material-icon"},void 0,"chevron_left")))}function ws(e){return(0,n.Z)(Se.Z,{className:"btn-default btn-block btn-icon btn-sm",disabled:e.disabled||!e.edit.next,onClick:e.onClick,title:gettext("See next change")},void 0,fs||(fs=(0,n.Z)("span",{className:"material-icon"},void 0,"chevron_right")))}function ks(e){return(0,n.Z)(Se.Z,{className:"btn-default btn-block btn-icon btn-sm",disabled:e.disabled||!e.edit.next,onClick:e.onClick,title:gettext("See previous change")},void 0,Ns||(Ns=(0,n.Z)("span",{className:"material-icon"},void 0,"last_page")))}function Cs(e){return e.canRevert?(0,n.Z)("div",{className:"col-sm-3 hidden-xs"},void 0,(0,n.Z)(Se.Z,{className:"btn-default btn-sm btn-block",disabled:e.disabled,onClick:e.onClick,title:gettext("Revert post to state from before this edit.")},void 0,gettext("Revert"))):null}function Ss(e){let t=null;t=e.edit.url.editor?interpolate('<a href="%(url)s" class="item-title">%(user)s</a>',{url:(0,le.Z)(e.edit.url.editor),user:(0,le.Z)(e.edit.editor_name)},!0):interpolate('<span class="item-title">%(user)s</span>',{user:(0,le.Z)(e.edit.editor_name)},!0);const s=interpolate('<abbr title="%(absolute)s">%(relative)s</abbr>',{absolute:(0,le.Z)(e.edit.edited_on.format("LLL")),relative:(0,le.Z)(e.edit.edited_on.fromNow())},!0),a=interpolate((0,le.Z)(gettext("By %(edited_by)s %(edited_on)s.")),{edited_by:t,edited_on:s},!0);return(0,n.Z)("p",{dangerouslySetInnerHTML:{__html:a}})}var Es,Ls;const Ts=class extends r.Component{constructor(e){super(e),this.state={isReady:!1,isBusy:!0,canRevert:e.post.acl.can_edit,error:null,edit:null}}componentDidMount(){this.goToEdit()}goToEdit=(()=>{var e=this;return function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e.setState({isBusy:!0});let s=e.props.post.api.edits;null!==t&&(s+="?edit="+t),h.Z.get(s).then((t=>{var s;e.setState({isReady:!0,isBusy:!1,edit:(s=t,Object.assign({},s,{edited_on:I()(s.edited_on)}))})}),(t=>{e.setState({isReady:!0,isBusy:!1,error:t.detail})}))}})();revertEdit=e=>{if(this.state.isBusy)return;if(!window.confirm(gettext("Are you sure you with to revert this post to the state from before this edit?")))return;this.setState({isBusy:!0});const t=this.props.post.api.edits+"?edit="+e;h.Z.post(t).then((e=>{const t=Ue.ZB(e);g.Z.dispatch(Ue.r$(e,t)),v.Z.success(gettext("Post has been reverted to previous state.")),m.Z.hide()}),(e=>{v.Z.apiError(e),this.setState({isBusy:!1})}))};render(){return this.state.error?(0,n.Z)(Ps,{className:"modal-dialog modal-message"},void 0,(0,n.Z)(F.Z,{message:this.state.error})):this.state.isReady?(0,n.Z)(Ps,{},void 0,(0,n.Z)(xs,{canRevert:this.state.canRevert,disabled:this.state.isBusy,edit:this.state.edit,goToEdit:this.goToEdit,revertEdit:this.revertEdit}),(0,n.Z)(vs,{diff:this.state.edit.diff}),(0,n.Z)(bs,{canRevert:this.state.canRevert,disabled:this.state.isBusy,edit:this.state.edit,revertEdit:this.revertEdit})):Es||(Es=(0,n.Z)(Ps,{},void 0,(0,n.Z)(Y.Z,{})))}};function Ps(e){return(0,n.Z)("div",{className:e.className||"modal-dialog",role:"document"},void 0,(0,n.Z)("div",{className:"modal-content"},void 0,(0,n.Z)("div",{className:"modal-header"},void 0,(0,n.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,Ls||(Ls=(0,n.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,n.Z)("h4",{className:"modal-title"},void 0,gettext("Post edits history"))),e.children))}var Os,Rs,As,Is,Ds,js,zs,Us,Ms,Bs,qs,Hs,Fs,Ys,Vs,Gs,$s,Ws,Qs,Ks,Js=s(7026),Xs=s(471),ea=s(5210);function ta(e){return r.createElement(sa,(0,l.Z)({},e,{Form:aa}))}class sa extends r.Component{constructor(e){super(e),this.state={isLoaded:!1,isError:!1,categories:[]}}componentDidMount(){h.Z.get(misago.get("THREAD_EDITOR_API")).then((e=>{const t=e.map((e=>Object.assign(e,{disabled:!1===e.post,label:e.name,value:e.id,post:e.post})));this.setState({isLoaded:!0,categories:t})}),(e=>{this.setState({isError:e.detail})}))}render(){return this.state.isError?(0,n.Z)(oa,{message:this.state.isError}):this.state.isLoaded?r.createElement(aa,(0,l.Z)({},this.props,{categories:this.state.categories})):Os||(Os=(0,n.Z)(ia,{}))}}class aa extends d.Z{constructor(e){super(e),this.state={isLoading:!1,title:"",category:null,categories:e.categories,weight:0,is_hidden:0,is_closed:!1,validators:{title:[ea.C1()]},errors:{}},this.isHiddenChoices=[{value:0,icon:"visibility",label:gettext("No")},{value:1,icon:"visibility_off",label:gettext("Yes")}],this.isClosedChoices=[{value:!1,icon:"lock_outline",label:gettext("No")},{value:!0,icon:"lock",label:gettext("Yes")}],this.acl={},this.props.categories.forEach((e=>{e.post&&(this.state.category||(this.state.category=e.id),this.acl[e.id]={can_pin_threads:e.post.pin,can_close_threads:e.post.close,can_hide_threads:e.post.hide})}))}clean(){return!!this.isValid()||(v.Z.error(gettext("Form contains errors.")),this.setState({errors:this.validate()}),!1)}send(){return h.Z.post(this.props.thread.api.posts.split,{title:this.state.title,category:this.state.category,weight:this.state.weight,is_hidden:this.state.is_hidden,is_closed:this.state.is_closed,posts:[this.props.post.id]})}handleSuccess(e){g.Z.dispatch(Ue.r$(this.props.post,{isDeleted:!0})),m.Z.hide(),v.Z.success(gettext("Selected post was split into new thread."))}handleError(e){400===e.status?(this.setState({errors:Object.assign({},this.state.errors,e)}),v.Z.error(gettext("Form contains errors."))):v.Z.apiError(e)}onCategoryChange=e=>{const t=e.target.value,s={category:t};this.acl[t].can_pin_threads<s.weight&&(s.weight=0),this.acl[t].can_hide_threads||(s.is_hidden=0),this.acl[t].can_close_threads||(s.is_closed=!1),this.setState(s)};getWeightChoices(){const e=[{value:0,icon:"remove",label:gettext("Not pinned")},{value:1,icon:"bookmark_border",label:gettext("Pinned locally")}];return 2==this.acl[this.state.category].can_pin_threads&&e.push({value:2,icon:"bookmark",label:gettext("Pinned globally")}),e}renderWeightField(){return this.acl[this.state.category].can_pin_threads?(0,n.Z)(c.Z,{label:gettext("Thread weight"),for:"id_weight",labelClass:"col-sm-4",controlClass:"col-sm-8"},void 0,(0,n.Z)(Xs.Z,{id:"id_weight",onChange:this.bindInput("weight"),value:this.state.weight,choices:this.getWeightChoices()})):null}renderHiddenField(){return this.acl[this.state.category].can_hide_threads?(0,n.Z)(c.Z,{label:gettext("Hide thread"),for:"id_is_hidden",labelClass:"col-sm-4",controlClass:"col-sm-8"},void 0,(0,n.Z)(Xs.Z,{id:"id_is_closed",onChange:this.bindInput("is_hidden"),value:this.state.is_hidden,choices:this.isHiddenChoices})):null}renderClosedField(){return this.acl[this.state.category].can_close_threads?(0,n.Z)(c.Z,{label:gettext("Close thread"),for:"id_is_closed",labelClass:"col-sm-4",controlClass:"col-sm-8"},void 0,(0,n.Z)(Xs.Z,{id:"id_is_closed",onChange:this.bindInput("is_closed"),value:this.state.is_closed,choices:this.isClosedChoices})):null}render(){return(0,n.Z)(na,{className:"modal-dialog"},void 0,(0,n.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,n.Z)("div",{className:"modal-body"},void 0,(0,n.Z)(c.Z,{label:gettext("Thread title"),for:"id_title",labelClass:"col-sm-4",controlClass:"col-sm-8",validation:this.state.errors.title},void 0,(0,n.Z)("input",{id:"id_title",className:"form-control",type:"text",onChange:this.bindInput("title"),value:this.state.title})),Rs||(Rs=(0,n.Z)("div",{className:"clearfix"})),(0,n.Z)(c.Z,{label:gettext("Category"),for:"id_category",labelClass:"col-sm-4",controlClass:"col-sm-8",validation:this.state.errors.category},void 0,(0,n.Z)(Js.Z,{id:"id_category",onChange:this.onCategoryChange,value:this.state.category,choices:this.state.categories})),As||(As=(0,n.Z)("div",{className:"clearfix"})),this.renderWeightField(),this.renderHiddenField(),this.renderClosedField()),(0,n.Z)("div",{className:"modal-footer"},void 0,(0,n.Z)(Se.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,gettext("Split post")))))}}function ia(){return Is||(Is=(0,n.Z)(na,{className:"modal-dialog"},void 0,(0,n.Z)(Y.Z,{})))}function oa(e){return(0,n.Z)(na,{className:"modal-dialog modal-message"},void 0,Ds||(Ds=(0,n.Z)("div",{className:"message-icon"},void 0,(0,n.Z)("span",{className:"material-icon"},void 0,"info_outline"))),(0,n.Z)("div",{className:"message-body"},void 0,(0,n.Z)("p",{className:"lead"},void 0,gettext("You can't move this post at the moment.")),(0,n.Z)("p",{},void 0,e.message)))}function na(e){return(0,n.Z)("div",{className:e.className,role:"document"},void 0,(0,n.Z)("div",{className:"modal-content"},void 0,(0,n.Z)("div",{className:"modal-header"},void 0,(0,n.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,js||(js=(0,n.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,n.Z)("h4",{className:"modal-title"},void 0,gettext("Split post into new thread"))),e.children))}function ra(e){return(0,n.Z)("ul",{className:"dropdown-menu dropdown-menu-right stick-to-bottom"},void 0,r.createElement(la,e),r.createElement(da,e),r.createElement(ca,e),r.createElement(pa,e),r.createElement(ua,e),r.createElement(ha,e),r.createElement(ma,e),r.createElement(va,e),r.createElement(ga,e),r.createElement(Za,e),r.createElement(ba,e),r.createElement(_a,e),r.createElement(fa,e))}class la extends r.Component{onClick=()=>{let e=window.location.protocol+"//";e+=window.location.host,e+=this.props.post.url.index,prompt(gettext("Permament link to this post:"),e)};render(){return(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,zs||(zs=(0,n.Z)("span",{className:"material-icon"},void 0,"link")),gettext("Permament link")))}}class da extends r.Component{onClick=()=>{te.Z.open({mode:"EDIT",thread:this.props.thread,post:this.props.post,config:this.props.post.api.editor,submit:this.props.post.api.index})};render(){return this.props.post.acl.can_edit?(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,Us||(Us=(0,n.Z)("span",{className:"material-icon"},void 0,"edit")),gettext("Edit"))):null}}class ca extends r.Component{onClick=()=>{Ft(this.props)};render(){const{post:e,thread:t}=this.props;return t.acl.can_mark_best_answer&&e.acl.can_mark_as_best_answer?e.id===t.best_answer||t.best_answer&&!t.acl.can_change_best_answer?null:(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,Ms||(Ms=(0,n.Z)("span",{className:"material-icon"},void 0,"check_box")),gettext("Mark as best answer"))):null}}class pa extends r.Component{onClick=()=>{!function(e){const{post:t}=e;g.Z.dispatch(u.Vx({best_answer:null,best_answer_is_protected:!1,best_answer_marked_on:null,best_answer_marked_by:null,best_answer_marked_by_name:null,best_answer_marked_by_slug:null})),Yt(e,[{op:"remove",path:"best-answer",value:t.id},{op:"add",path:"acl",value:!0}],{best_answer:e.thread.best_answer,best_answer_is_protected:e.thread.best_answer_is_protected,best_answer_marked_on:e.thread.best_answer_marked_on,best_answer_marked_by:e.thread.best_answer_marked_by,best_answer_marked_by_name:e.thread.best_answer_marked_by_name,best_answer_marked_by_slug:e.thread.best_answer_marked_by_slug})}(this.props)};render(){const{post:e,thread:t}=this.props;return e.id!==t.best_answer?null:t.acl.can_unmark_best_answer?(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,Bs||(Bs=(0,n.Z)("span",{className:"material-icon"},void 0,"check_box_outline_blank")),gettext("Unmark best answer"))):null}}class ua extends r.Component{onClick=()=>{m.Z.show((0,n.Z)(Ts,{post:this.props.post}))};render(){const e=this.props.post.is_hidden&&!this.props.post.acl.can_see_hidden,t=0===this.props.post.edits;if(e||t)return null;const s=ngettext("This post was edited %(edits)s time.","This post was edited %(edits)s times.",this.props.post.edits);return interpolate(s,{edits:this.props.post.edits},!0),(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,qs||(qs=(0,n.Z)("span",{className:"material-icon"},void 0,"edit")),gettext("Changes history")))}}class ha extends r.Component{onClick=()=>{var e;e=this.props,g.Z.dispatch(Ue.r$(e.post,{is_unapproved:!1})),Ht(e,[{op:"replace",path:"is-unapproved",value:!1}],{is_unapproved:e.post.is_unapproved})};render(){return this.props.post.acl.can_approve&&this.props.post.is_unapproved?(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,Hs||(Hs=(0,n.Z)("span",{className:"material-icon"},void 0,"done")),gettext("Approve"))):null}}class ma extends r.Component{onClick=()=>{m.Z.show(r.createElement(hs,this.props))};render(){return this.props.post.acl.can_move?(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,Fs||(Fs=(0,n.Z)("span",{className:"material-icon"},void 0,"arrow_forward")),gettext("Move"))):null}}class va extends r.Component{onClick=()=>{m.Z.show(r.createElement(ta,this.props))};render(){return this.props.post.acl.can_move?(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,Ys||(Ys=(0,n.Z)("span",{className:"material-icon"},void 0,"call_split")),gettext("Split"))):null}}class ga extends r.Component{onClick=()=>{var e;e=this.props,g.Z.dispatch(Ue.r$(e.post,{is_protected:!0})),Ht(e,[{op:"replace",path:"is-protected",value:!0}],{is_protected:e.post.is_protected})};render(){return this.props.post.acl.can_protect?this.props.post.is_protected?null:(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,Vs||(Vs=(0,n.Z)("span",{className:"material-icon"},void 0,"lock_outline")),gettext("Protect"))):null}}class Za extends r.Component{onClick=()=>{var e;e=this.props,g.Z.dispatch(Ue.r$(e.post,{is_protected:!1})),Ht(e,[{op:"replace",path:"is-protected",value:!1}],{is_protected:e.post.is_protected})};render(){return this.props.post.acl.can_protect&&this.props.post.is_protected?(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,Gs||(Gs=(0,n.Z)("span",{className:"material-icon"},void 0,"lock_open")),gettext("Remove protection"))):null}}class ba extends r.Component{onClick=()=>{var e;e=this.props,g.Z.dispatch(Ue.r$(e.post,{is_hidden:!0,hidden_on:I()(),hidden_by_name:e.user.username,url:Object.assign(e.post.url,{hidden_by:e.user.url})})),Ht(e,[{op:"replace",path:"is-hidden",value:!0}],{is_hidden:e.post.is_hidden,hidden_on:e.post.hidden_on,hidden_by_name:e.post.hidden_by_name,url:e.post.url})};render(){const{post:e,thread:t}=this.props;return e.id===t.best_answer?null:e.acl.can_hide?e.is_hidden?null:(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,$s||($s=(0,n.Z)("span",{className:"material-icon"},void 0,"visibility_off")),gettext("Hide"))):null}}class _a extends r.Component{onClick=()=>{var e;e=this.props,g.Z.dispatch(Ue.r$(e.post,{is_hidden:!1})),Ht(e,[{op:"replace",path:"is-hidden",value:!1}],{is_hidden:e.post.is_hidden})};render(){return this.props.post.acl.can_unhide&&this.props.post.is_hidden?(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,Ws||(Ws=(0,n.Z)("span",{className:"material-icon"},void 0,"visibility")),gettext("Unhide"))):null}}class fa extends r.Component{onClick=()=>{var e;e=this.props,window.confirm(gettext("Are you sure you want to delete this post? This action is not reversible!"))&&(g.Z.dispatch(Ue.r$(e.post,{isDeleted:!0})),h.Z.delete(e.post.api.index).then((()=>{v.Z.success(gettext("Post has been deleted."))}),(t=>{400===t.status?v.Z.error(t.detail):v.Z.apiError(t),g.Z.dispatch(Ue.r$(e.post,{isDeleted:!1}))})))};render(){const{post:e,thread:t}=this.props;return e.id===t.best_answer?null:e.acl.can_delete?(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:this.onClick,type:"button"},void 0,Qs||(Qs=(0,n.Z)("span",{className:"material-icon"},void 0,"clear")),gettext("Delete"))):null}}function Na(e){return(0,n.Z)("div",{className:"pull-right dropdown"},void 0,Ks||(Ks=(0,n.Z)("button",{"aria-expanded":"true","aria-haspopup":"true",className:"btn btn-default btn-icon dropdown-toggle","data-toggle":"dropdown",type:"button"},void 0,(0,n.Z)("span",{className:"material-icon"},void 0,"expand_more"))),r.createElement(ra,e))}var xa=s(1981);const ya=class extends r.Component{onClick=()=>{this.props.post.isSelected?g.Z.dispatch(xa._H(this.props.post)):g.Z.dispatch(xa.Ys(this.props.post))};render(){return this.props.thread.acl.can_merge_posts||(e=this.props.post.acl).can_approve||e.can_hide||e.can_protect||e.can_unhide||e.can_delete||e.can_move?(0,n.Z)("div",{className:"pull-right"},void 0,(0,n.Z)("button",{className:"btn btn-default btn-icon",onClick:this.onClick,type:"button"},void 0,(0,n.Z)("span",{className:"material-icon"},void 0,this.props.post.isSelected?"check_box":"check_box_outline_blank"))):null;var e}};var wa,ka,Ca,Sa=s(4678);function Ea(e){return(0,n.Z)("div",{className:"post-heading"},void 0,r.createElement(La,e),r.createElement(Ta,e),r.createElement(Pa,e),r.createElement(Oa,e),r.createElement(Ra,e),r.createElement(Aa,e),r.createElement(Ia,e),r.createElement(ya,e),r.createElement(Na,e))}function La(e){return e.post.is_read?null:(0,n.Z)("span",{className:"label label-unread hidden-xs"},void 0,gettext("New post"))}function Ta(e){return e.post.is_read?null:(0,n.Z)("span",{className:"label label-unread visible-xs-inline-block"},void 0,gettext("New"))}function Pa(e){const t=interpolate(gettext("posted %(posted_on)s"),{posted_on:e.post.posted_on.format("LL, LT")},!0);return(0,n.Z)("a",{href:e.post.url.index,className:"btn btn-link posted-on hidden-xs",title:t},void 0,e.post.posted_on.fromNow())}function Oa(e){return(0,n.Z)("a",{href:e.post.url.index,className:"btn btn-link posted-on visible-xs-inline-block"},void 0,e.post.posted_on.fromNow())}class Ra extends r.Component{onClick=()=>{m.Z.show((0,n.Z)(Ts,{post:this.props.post}))};render(){const e=this.props.post.is_hidden&&!this.props.post.acl.can_see_hidden,t=0===this.props.post.edits;if(e||t)return null;const s=ngettext("This post was edited %(edits)s time.","This post was edited %(edits)s times.",this.props.post.edits),a=interpolate(s,{edits:this.props.post.edits},!0),i=ngettext("edited %(edits)s time","edited %(edits)s times",this.props.post.edits);return(0,n.Z)("button",{className:"btn btn-link btn-see-edits hidden-xs",onClick:this.onClick,title:a,type:"button"},void 0,interpolate(i,{edits:this.props.post.edits},!0))}}class Aa extends Ra{render(){const e=this.props.post.is_hidden&&!this.props.post.acl.can_see_hidden,t=0===this.props.post.edits;if(e||t)return null;const s=ngettext("%(edits)s edit","%(edits)s edits",this.props.post.edits);return(0,n.Z)("button",{className:"btn btn-link btn-see-edits visible-xs-inline-block",onClick:this.onClick,type:"button"},void 0,interpolate(s,{edits:this.props.post.edits},!0))}}function Ia(e){const t=e.post.poster&&e.post.poster.id===e.user.id,s=e.post.acl.can_protect;return e.user.id&&e.post.is_protected&&(t||s)?(0,n.Z)("span",{className:"label label-protected hidden-xs",title:gettext("This post is protected and may not be edited.")},void 0,wa||(wa=(0,n.Z)("span",{className:"material-icon"},void 0,"lock_outline")),gettext("protected")):null}function Da(e){let{post:t,thread:s}=e;return(0,n.Z)("div",{className:"post-side post-side-anonymous"},void 0,(0,n.Z)(ya,{post:t,thread:s}),(0,n.Z)(Na,{post:t,thread:s}),(0,n.Z)("div",{className:"media"},void 0,ka||(ka=(0,n.Z)("div",{className:"media-left"},void 0,(0,n.Z)("span",{},void 0,(0,n.Z)(S.ZP,{className:"poster-avatar",size:100})))),(0,n.Z)("div",{className:"media-body"},void 0,(0,n.Z)("span",{className:"media-heading item-title"},void 0,t.poster_name),(0,n.Z)("span",{className:"user-title user-title-anonymous"},void 0,gettext("Removed user")))))}function ja(e){let{title:t,rank:s}=e;return s.is_tab||!!t||!!s.title}function za(e){let{poster:t}=e;const s=ngettext("%(posts)s post","%(posts)s posts",t.posts);let a="user-postcount";return ja(t)&&(a+=" hidden-xs hidden-sm"),(0,n.Z)("span",{className:a},void 0,interpolate(s,{posts:t.posts},!0))}function Ua(e){let{poster:t}=e,s="hidden-xs";return ja(t)&&(s+=" hidden-sm"),(0,n.Z)("span",{className:s},void 0,(0,n.Z)(Sa.ZP,{status:t.status},void 0,(0,n.Z)(Sa.pg,{status:t.status,user:t})))}function Ma(e){let{rank:t,title:s}=e,a=s||t.title;if(!a&&t.is_tab&&(a=t.name),!a)return null;let i="user-title";return t.css_class&&(i+=" user-title-"+t.css_class),t.is_tab?(0,n.Z)("div",{className:i},void 0,(0,n.Z)("a",{href:t.url},void 0,a)):(0,n.Z)("div",{className:i},void 0,a)}function Ba(e){let{post:t,thread:s}=e;const{poster:a}=t;return(0,n.Z)("div",{className:"post-side post-side-registered"},void 0,(0,n.Z)(ya,{post:t,thread:s}),(0,n.Z)(Na,{post:t,thread:s}),(0,n.Z)("div",{className:"media"},void 0,(0,n.Z)("div",{className:"media-left"},void 0,(0,n.Z)("a",{href:a.url},void 0,(0,n.Z)(S.ZP,{className:"poster-avatar",size:100,user:a}))),(0,n.Z)("div",{className:"media-body"},void 0,(0,n.Z)("div",{className:"media-heading"},void 0,(0,n.Z)("a",{className:"item-title",href:a.url},void 0,a.username),(0,n.Z)(Sa.ZP,{status:a.status},void 0,(0,n.Z)(Sa.Jj,{status:a.status}))),(0,n.Z)(Ma,{rank:a.rank,title:a.title}),(0,n.Z)(Ua,{poster:a}),(0,n.Z)(za,{poster:a}))))}function qa(e){return e.post.poster?r.createElement(Ba,e):r.createElement(Da,e)}function Ha(e){let t="post";return e.post.isDeleted?t="hide":e.post.is_hidden&&!e.post.acl.can_see_hidden&&(t="post post-hidden"),e.post.poster&&e.post.poster.rank.css_class&&(t+=" post-"+e.post.poster.rank.css_class),e.post.is_read||(t+=" post-new"),(0,n.Z)("li",{id:"post-"+e.post.id,className:t},void 0,(0,n.Z)("div",{className:"panel panel-default panel-post"},void 0,(0,n.Z)("div",{className:"panel-body"},void 0,r.createElement(qa,e),(0,n.Z)("div",{className:"panel-content"},void 0,r.createElement(Ea,e),r.createElement(zt,e),r.createElement(Mt,e),r.createElement(Bt,e),r.createElement(Ut,e),r.createElement(St,e),r.createElement(Nt,e),r.createElement(is,e)))))}const Fa=()=>(0,n.Z)("li",{className:"post"},void 0,(0,n.Z)("div",{className:"panel panel-default panel-post"},void 0,(0,n.Z)("div",{className:"panel-body"},void 0,(0,n.Z)("div",{className:"post-side post-side-registered"},void 0,(0,n.Z)("div",{className:"media"},void 0,Ca||(Ca=(0,n.Z)("div",{className:"media-left"},void 0,(0,n.Z)("span",{},void 0,(0,n.Z)(S.ZP,{className:"poster-avatar",size:"100"})))),(0,n.Z)("div",{className:"media-body"},void 0,(0,n.Z)("span",{className:"media-heading item-title"},void 0,(0,n.Z)("span",{className:"ui-preview-text",style:{width:"80px"}},void 0," ")),(0,n.Z)("span",{className:"user-title user-title-anonymous"},void 0,(0,n.Z)("span",{className:"ui-preview-text",style:{width:"60px"}},void 0," "))))),(0,n.Z)("div",{className:"panel-content"},void 0,(0,n.Z)("div",{className:"post-body"},void 0,(0,n.Z)("article",{className:"misago-markup"},void 0,(0,n.Z)("p",{className:"ui-preview-text",style:{width:"100%"}},void 0," "),(0,n.Z)("p",{className:"ui-preview-text",style:{width:"70%"}},void 0," "),(0,n.Z)("p",{className:"ui-preview-text hidden-xs hidden-sm",style:{width:"85%"}},void 0," ")))))));var Ya;function Va(e){return e.posts.isLoaded?(0,n.Z)("ul",{className:"posts-list ui-ready"},void 0,e.posts.results.map((t=>r.createElement(Ga,(0,l.Z)({key:t.id,post:t},e))))):Ya||(Ya=(0,n.Z)("ul",{className:"posts-list ui-preview"},void 0,(0,n.Z)(Fa,{})))}function Ga(e){return e.post.is_event?r.createElement(ct,e):r.createElement(Ha,e)}var $a,Wa=s(5547),Qa=s(3328),Ka=s(661),Ja=s(905),Xa=s(8936),ei=s(366),ti=s(6768);const si=e=>{let{thread:t}=e;return(0,n.Z)("div",{className:"thread-user-card"},void 0,(0,n.Z)("div",{className:"thread-user-card-media"},void 0,t.starter?(0,n.Z)("a",{href:t.url.starter},void 0,(0,n.Z)(S.ZP,{size:40,user:t.starter})):$a||($a=(0,n.Z)(S.ZP,{size:40}))),(0,n.Z)("div",{className:"thread-user-card-body"},void 0,(0,n.Z)("div",{className:"thread-user-card-header"},void 0,t.starter?(0,n.Z)("a",{className:"item-title",href:t.url.starter,title:gettext("Thread author")},void 0,t.starter.username):(0,n.Z)("span",{className:"item-title",title:gettext("Thread author")},void 0,t.starter_name)),(0,n.Z)("div",{},void 0,(0,n.Z)("span",{className:"text-muted",title:interpolate(gettext("Started on: %(timestamp)s"),{timestamp:t.started_on.format("LLL")},!0)},void 0,t.started_on.fromNow()))))};var ai,ii,oi=s(9145),ni=s(2891);const ri=class extends d.Z{constructor(e){super(e),this.state={isLoading:!1,title:e.thread.title,validators:{title:(0,ni.jn)()},errors:{}}}clean(){if(!this.state.title.trim().length)return v.Z.error(gettext("You have to enter thread title.")),!1;const e=this.validate();return!e.title||(v.Z.error(e.title[0]),!1)}send(){return g.Z.dispatch(u.n6()),h.Z.patch(this.props.thread.api.index,[{op:"replace",path:"title",value:this.state.title}])}handleSuccess=e=>{this.handleSuccessUnmounted(e),this.setState({isLoading:!0}),m.Z.hide()};handleSuccessUnmounted=e=>{g.Z.dispatch(u.Ar()),g.Z.dispatch(u.Vx(e))};handleError=e=>{g.Z.dispatch(u.Ar()),400===e.status?v.Z.error(e.detail[0]):v.Z.apiError(e)};onChange=e=>{this.changeValue("title",e.target.value)};render(){return(0,n.Z)("div",{className:"modal-dialog modal-lg",role:"document"},void 0,(0,n.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,n.Z)("div",{className:"modal-content"},void 0,ai||(ai=(0,n.Z)(li,{})),(0,n.Z)("div",{className:"modal-body"},void 0,(0,n.Z)(c.Z,{for:"id_modal_title",label:gettext("Thread title")},void 0,(0,n.Z)("input",{className:"form-control",disabled:this.state.isLoading||this.props.thread.isBusy,id:"id_modal_title",onChange:this.onChange,value:this.state.title}))),(0,n.Z)("div",{className:"modal-footer"},void 0,(0,n.Z)("button",{className:"btn btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,gettext("Cancel")),(0,n.Z)("button",{className:"btn btn-primary",disabled:this.state.isLoading||this.props.thread.isBusy},void 0,gettext("Change title"))))))}};function li(e){return(0,n.Z)("div",{className:"modal-header"},void 0,(0,n.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,ii||(ii=(0,n.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,n.Z)("h4",{className:"modal-title"},void 0,gettext("Change title")))}var di,ci,pi=s(2753);const ui=class extends d.Z{constructor(e){super(e),this.state={isLoading:!1,url:"",validators:{url:[]},errors:{}}}clean(){return!!this.state.url.trim().length||(v.Z.error(gettext("You have to enter link to the other thread.")),!1)}send(){return g.Z.dispatch(u.n6()),h.Z.post(this.props.thread.api.merge,{other_thread:this.state.url})}handleSuccess=e=>{this.handleSuccessUnmounted(e),this.setState({isLoading:!0})};handleSuccessUnmounted=e=>{v.Z.success(gettext("Thread has been merged with other one.")),window.location=e.url};handleError=e=>{g.Z.dispatch(u.Ar()),400===e.status?e.best_answers||e.polls?m.Z.show((0,n.Z)(pi.ZP,{api:this.props.thread.api.merge,bestAnswers:e.best_answers,data:{other_thread:this.state.url},polls:e.polls,onError:this.handleError,onSuccess:this.handleSuccessUnmounted})):e.best_answer?v.Z.error(e.best_answer[0]):e.poll?v.Z.error(e.poll[0]):v.Z.error(e.detail):v.Z.apiError(e)};onUrlChange=e=>{this.changeValue("url",e.target.value)};render(){return(0,n.Z)("div",{className:"modal-dialog",role:"document"},void 0,(0,n.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,n.Z)("div",{className:"modal-content"},void 0,di||(di=(0,n.Z)(hi,{})),(0,n.Z)("div",{className:"modal-body"},void 0,(0,n.Z)(c.Z,{for:"id_url",label:gettext("Link to thread you want to merge with"),help_text:gettext("Merge will delete current thread and move its contents to the thread specified here.")},void 0,(0,n.Z)("input",{className:"form-control",disabled:this.state.isLoading||this.props.thread.isBusy,id:"id_url",onChange:this.onUrlChange,value:this.state.url}))),(0,n.Z)("div",{className:"modal-footer"},void 0,(0,n.Z)("button",{className:"btn btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,gettext("Cancel")),(0,n.Z)("button",{className:"btn btn-primary",disabled:this.state.isLoading||this.props.thread.isBusy},void 0,gettext("Merge thread"))))))}};function hi(e){return(0,n.Z)("div",{className:"modal-header"},void 0,(0,n.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,ci||(ci=(0,n.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,n.Z)("h4",{className:"modal-title"},void 0,gettext("Merge thread")))}var mi,vi,gi,Zi,bi,_i;const fi=class extends d.Z{constructor(e){super(e),this.state={isReady:!1,isLoading:!1,isError:!1,category:null,categories:[]}}componentDidMount(){h.Z.get(N.Z.get("THREAD_EDITOR_API")).then((e=>{let t=null;const s=e.map((e=>(!1===e.post||t||(t=e.id),Object.assign(e,{disabled:!1===e.post,label:e.name,value:e.id}))));this.setState({isReady:!0,category:t,categories:s})}),(e=>{this.setState({isError:e.detail})}))}send(){return g.Z.dispatch(u.n6()),h.Z.patch(this.props.thread.api.index,[{op:"replace",path:"category",value:this.state.category}])}handleSuccess(){h.Z.get(this.props.thread.api.posts.index,{page:this.props.posts.page}).then((e=>{g.Z.dispatch(u.gx(e)),g.Z.dispatch(xa.zD(e.post_set)),g.Z.dispatch(u.Ar()),v.Z.success(gettext("Thread has been moved.")),m.Z.hide()}),(e=>{g.Z.dispatch(u.Ar()),v.Z.apiError(e)}))}handleError(e){400===e.status?v.Z.error(e.detail[0]):v.Z.apiError(e)}onCategoryChange=e=>{this.changeValue("category",e.target.value)};render(){return this.state.isReady?(0,n.Z)("div",{className:"modal-dialog",role:"document"},void 0,(0,n.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,n.Z)("div",{className:"modal-content"},void 0,mi||(mi=(0,n.Z)(Ni,{})),(0,n.Z)("div",{className:"modal-body"},void 0,(0,n.Z)(c.Z,{for:"id_category",label:gettext("New category")},void 0,(0,n.Z)(Js.Z,{choices:this.state.categories,disabled:this.state.isLoading||this.props.thread.isBusy,id:"id_category",onChange:this.onCategoryChange,value:this.state.category}))),(0,n.Z)("div",{className:"modal-footer"},void 0,(0,n.Z)("button",{className:"btn btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,gettext("Cancel")),(0,n.Z)("button",{className:"btn btn-primary",disabled:this.state.isLoading||this.props.thread.isBusy},void 0,gettext("Move thread")))))):this.state.isError?(0,n.Z)(yi,{message:this.state.isError}):vi||(vi=(0,n.Z)(xi,{}))}};function Ni(e){return(0,n.Z)("div",{className:"modal-header"},void 0,(0,n.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,gi||(gi=(0,n.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,n.Z)("h4",{className:"modal-title"},void 0,gettext("Move thread")))}function xi(e){return Zi||(Zi=(0,n.Z)("div",{className:"modal-dialog",role:"document"},void 0,(0,n.Z)("div",{className:"modal-content"},void 0,(0,n.Z)(Ni,{}),(0,n.Z)(Y.Z,{}))))}function yi(e){return(0,n.Z)("div",{className:"modal-dialog modal-message",role:"document"},void 0,(0,n.Z)("div",{className:"modal-content"},void 0,bi||(bi=(0,n.Z)(Ni,{})),_i||(_i=(0,n.Z)("div",{className:"message-icon"},void 0,(0,n.Z)("span",{className:"material-icon"},void 0,"info_outline"))),(0,n.Z)("div",{className:"message-body"},void 0,(0,n.Z)("p",{className:"lead"},void 0,gettext("You can't move this thread at the moment.")),(0,n.Z)("p",{},void 0,e.message),(0,n.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,gettext("Ok")))))}var wi,ki,Ci,Si,Ei,Li,Ti,Pi,Oi,Ri,Ai,Ii;const Di=class extends r.Component{callApi=(e,t)=>{g.Z.dispatch(u.n6()),e.push({op:"add",path:"acl",value:!0}),h.Z.patch(this.props.thread.api.index,e).then((e=>{g.Z.dispatch(u.Vx(e)),g.Z.dispatch(u.Ar()),v.Z.success(t)}),(e=>{g.Z.dispatch(u.Ar()),400===e.status?v.Z.error(e.detail[0]):v.Z.apiError(e)}))};changeTitle=()=>{m.Z.show((0,n.Z)(ri,{thread:this.props.thread}))};pinGlobally=()=>{this.callApi([{op:"replace",path:"weight",value:2}],gettext("Thread has been pinned globally."))};pinLocally=()=>{this.callApi([{op:"replace",path:"weight",value:1}],gettext("Thread has been pinned locally."))};unpin=()=>{this.callApi([{op:"replace",path:"weight",value:0}],gettext("Thread has been unpinned."))};approve=()=>{this.callApi([{op:"replace",path:"is-unapproved",value:!1}],gettext("Thread has been approved."))};open=()=>{this.callApi([{op:"replace",path:"is-closed",value:!1}],gettext("Thread has been opened."))};close=()=>{this.callApi([{op:"replace",path:"is-closed",value:!0}],gettext("Thread has been closed."))};unhide=()=>{this.callApi([{op:"replace",path:"is-hidden",value:!1}],gettext("Thread has been made visible."))};hide=()=>{this.callApi([{op:"replace",path:"is-hidden",value:!0}],gettext("Thread has been made hidden."))};move=()=>{m.Z.show((0,n.Z)(fi,{posts:this.props.posts,thread:this.props.thread}))};merge=()=>{m.Z.show((0,n.Z)(ui,{thread:this.props.thread}))};delete=()=>{window.confirm(gettext("Are you sure you want to delete this thread?"))&&(g.Z.dispatch(u.n6()),h.Z.delete(this.props.thread.api.index).then((e=>{v.Z.success(gettext("Thread has been deleted.")),window.location=this.props.thread.category.url.index}),(e=>{g.Z.dispatch(u.Ar()),v.Z.apiError(e)})))};render(){const{moderation:e}=this.props;return(0,n.Z)("ul",{className:"dropdown-menu dropdown-menu-right stick-to-bottom"},void 0,!!e.edit&&(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:this.changeTitle,type:"button"},void 0,wi||(wi=(0,n.Z)("span",{className:"material-icon"},void 0,"edit")),gettext("Change title"))),!!e.pinGlobally&&(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:this.pinGlobally,type:"button"},void 0,ki||(ki=(0,n.Z)("span",{className:"material-icon"},void 0,"bookmark")),gettext("Pin globally"))),!!e.pinLocally&&(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:this.pinLocally,type:"button"},void 0,Ci||(Ci=(0,n.Z)("span",{className:"material-icon"},void 0,"bookmark_border")),gettext("Pin locally"))),!!e.unpin&&(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:this.unpin,type:"button"},void 0,Si||(Si=(0,n.Z)("span",{className:"material-icon"},void 0,"panorama_fish_eye")),gettext("Unpin"))),!!e.move&&(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:this.move,type:"button"},void 0,Ei||(Ei=(0,n.Z)("span",{className:"material-icon"},void 0,"arrow_forward")),gettext("Move"))),!!e.merge&&(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:this.merge,type:"button"},void 0,Li||(Li=(0,n.Z)("span",{className:"material-icon"},void 0,"call_merge")),gettext("Merge"))),!!e.approve&&(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:this.approve,type:"button"},void 0,Ti||(Ti=(0,n.Z)("span",{className:"material-icon"},void 0,"done")),gettext("Approve"))),!!e.open&&(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:this.open,type:"button"},void 0,Pi||(Pi=(0,n.Z)("span",{className:"material-icon"},void 0,"lock_open")),gettext("Open"))),!!e.close&&(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:this.close,type:"button"},void 0,Oi||(Oi=(0,n.Z)("span",{className:"material-icon"},void 0,"lock_outline")),gettext("Close"))),!!e.unhide&&(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:this.unhide,type:"button"},void 0,Ri||(Ri=(0,n.Z)("span",{className:"material-icon"},void 0,"visibility")),gettext("Unhide"))),!!e.hide&&(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:this.hide,type:"button"},void 0,Ai||(Ai=(0,n.Z)("span",{className:"material-icon"},void 0,"visibility_off")),gettext("Hide"))),!!e.delete&&(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:this.delete,type:"button"},void 0,Ii||(Ii=(0,n.Z)("span",{className:"material-icon"},void 0,"clear")),gettext("Delete"))))}};var ji;const zi=e=>{let{thread:t,posts:s,moderation:a}=e;return(0,n.Z)("div",{className:"dropdown"},void 0,(0,n.Z)("button",{type:"button",className:"btn btn-default btn-outline btn-icon dropdown-toggle",title:gettext("Thread options"),"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",disabled:t.isBusy},void 0,ji||(ji=(0,n.Z)("span",{className:"material-icon"},void 0,"settings"))),(0,n.Z)(Di,{thread:t,posts:s,moderation:a}))};var Ui,Mi,Bi,qi=s(4184),Hi=s.n(qi);function Fi(e,t,s){const a={subscription:e.subscription};g.Z.dispatch(u.Vx({subscription:t})),h.Z.patch(e.api.index,[{op:"replace",path:"subscription",value:s}]).then((e=>{g.Z.dispatch(u.Vx(e))}),(e=>{400===e.status?v.Z.error(e.detail[0]):v.Z.apiError(e),g.Z.dispatch(u.Vx(a))}))}const Yi=e=>{let{stickToBottom:t,thread:s}=e;return(0,n.Z)("div",{className:"dropdown"},void 0,(0,n.Z)("button",{className:"btn btn-default btn-outline btn-block","aria-expanded":"true","aria-haspopup":"true","data-toggle":"dropdown",type:"button"},void 0,(0,n.Z)("span",{className:"material-icon"},void 0,!0===(a=s.subscription)?"star":!1===a?"star_half":"star_border"),function(e){return!0===e?gettext("E-mail"):!1===e?gettext("Enabled"):gettext("Disabled")}(s.subscription)),(0,n.Z)("ul",{className:Hi()("dropdown-menu dropdown-menu-right",{"stick-to-bottom":t})},void 0,(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:()=>function(e){null!==e.subscription&&Fi(e,null,"unsubscribe")}(s)},void 0,Ui||(Ui=(0,n.Z)("span",{className:"material-icon"},void 0,"star_border")),gettext("Unsubscribe"))),(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:()=>function(e){!1!==e.subscription&&Fi(e,!1,"notify")}(s)},void 0,Mi||(Mi=(0,n.Z)("span",{className:"material-icon"},void 0,"star_half")),gettext("Subscribe"))),(0,n.Z)("li",{},void 0,(0,n.Z)("button",{className:"btn btn-link",onClick:()=>function(e){!0!==e.subscription&&Fi(e,!0,"email")}(s)},void 0,Bi||(Bi=(0,n.Z)("span",{className:"material-icon"},void 0,"star")),gettext("Subscribe with e-mail")))));var a},Vi=e=>{let{children:t,className:s}=e;return(0,n.Z)("ul",{className:Hi()("breadcrumbs",s)},void 0,t)},Gi=e=>{let{category:t,className:s}=e;return(0,n.Z)("li",{className:Hi()("breadcrumbs-item",s)},void 0,(0,n.Z)("a",{href:t.url.index},void 0,(0,n.Z)("span",{className:"material-icon",style:{color:t.color||"inherit"}},void 0,"label"),!!t.short_name&&(0,n.Z)("span",{className:"breadcrumbs-item-name hidden-sm hidden-md hidden-lg",title:t.name},void 0,t.short_name),!!t.short_name&&(0,n.Z)("span",{className:"breadcrumbs-item-name hidden-xs"},void 0,t.name),!t.short_name&&(0,n.Z)("span",{className:"breadcrumbs-item-name"},void 0,t.name)))};var $i;const Wi=e=>{let{category:t,className:s}=e;return(0,n.Z)("li",{className:Hi()("breadcrumbs-item",s)},void 0,(0,n.Z)("a",{href:t.url.index},void 0,$i||($i=(0,n.Z)("span",{className:"material-icon"},void 0,"chevron_right")),(0,n.Z)("span",{className:"breadcrumbs-item-name"},void 0,"root_category"===t.special_role?gettext("Threads"):gettext("Private threads"))))},Qi=e=>{let{breadcrumbs:t}=e;return(0,n.Z)(Vi,{},void 0,t.map((e=>e.special_role?(0,n.Z)(Wi,{category:e},e.id):(0,n.Z)(Gi,{category:e},e.id))))};var Ki;const Ji=e=>{let{styleName:t,thread:s,posts:a,user:i,moderation:o}=e;return(0,n.Z)(oi.sP,{},void 0,(0,n.Z)(oi.mr,{styleName:t},void 0,(0,n.Z)(oi.gC,{styleName:t},void 0,(0,n.Z)(Qi,{breadcrumbs:s.path}),(0,n.Z)("h1",{},void 0,s.title)),(0,n.Z)(oi.eA,{className:"page-header-thread-details"},void 0,(0,n.Z)(Xa.gq,{},void 0,(0,n.Z)(Xa.kw,{auto:!0},void 0,(0,n.Z)(Xa.Z6,{shrink:!0},void 0,(0,n.Z)(si,{thread:s})),Ki||(Ki=(0,n.Z)(Xa.Z6,{auto:!0})),s.replies>0&&(0,n.Z)(Xa.Z6,{shrink:!0},void 0,(0,n.Z)(ti.Z,{thread:s})),(e=>e.is_closed||e.is_hidden||e.is_unapproved||e.weight>0||e.best_answer||e.has_poll||e.has_unapproved_posts)(s)&&(0,n.Z)(Xa.Z6,{shrink:!0},void 0,(0,n.Z)(ei.Z,{thread:s}))),i.is_authenticated&&(0,n.Z)(Xa.kw,{},void 0,(0,n.Z)(Xa.Z6,{},void 0,(0,n.Z)(Yi,{thread:s})),o.enabled&&(0,n.Z)(Xa.Z6,{shrink:!0},void 0,(0,n.Z)(zi,{thread:s,posts:a,moderation:o})))))))};var Xi,eo,to,so,ao,io,oo,no,ro=s(2490),lo=s(9655);const co=e=>{let{baseUrl:t,posts:s}=e;return(0,n.Z)("div",{className:"misago-pagination"},void 0,s.isLoaded&&s.first?(0,n.Z)(lo.rU,{className:"btn btn-default btn-outline btn-icon",to:t,title:gettext("Go to first page")},void 0,Xi||(Xi=(0,n.Z)("span",{className:"material-icon"},void 0,"first_page"))):(0,n.Z)("button",{className:"btn btn-default btn-outline btn-icon",title:gettext("Go to first page"),type:"button",disabled:!0},void 0,eo||(eo=(0,n.Z)("span",{className:"material-icon"},void 0,"first_page"))),s.isLoaded&&s.previous?(0,n.Z)(lo.rU,{className:"btn btn-default btn-outline btn-icon",to:t+(s.previous>1?s.previous+"/":""),title:gettext("Go to previous page")},void 0,to||(to=(0,n.Z)("span",{className:"material-icon"},void 0,"chevron_left"))):(0,n.Z)("button",{className:"btn btn-default btn-outline btn-icon",title:gettext("Go to previous page"),type:"button",disabled:!0},void 0,so||(so=(0,n.Z)("span",{className:"material-icon"},void 0,"chevron_left"))),s.isLoaded&&s.next?(0,n.Z)(lo.rU,{className:"btn btn-default btn-outline btn-icon",to:t+s.next+"/",title:gettext("Go to next page")},void 0,ao||(ao=(0,n.Z)("span",{className:"material-icon"},void 0,"chevron_right"))):(0,n.Z)("button",{className:"btn btn-default btn-outline btn-icon",title:gettext("Go to next page"),type:"button",disabled:!0},void 0,io||(io=(0,n.Z)("span",{className:"material-icon"},void 0,"chevron_right"))),s.isLoaded&&s.last?(0,n.Z)(lo.rU,{className:"btn btn-default btn-outline btn-icon",to:t+s.last+"/",title:gettext("Go to last page")},void 0,oo||(oo=(0,n.Z)("span",{className:"material-icon"},void 0,"last_page"))):(0,n.Z)("button",{className:"btn btn-default btn-outline btn-icon",title:gettext("Go to last page"),type:"button",disabled:!0},void 0,no||(no=(0,n.Z)("span",{className:"material-icon"},void 0,"last_page"))))},po=e=>{let{posts:t}=e;return t.more?(0,n.Z)("p",{},void 0,interpolate(ngettext("There is %(more)s more post in this thread.","There are %(more)s more posts in this thread.",t.more),{more:t.more},!0)):(0,n.Z)("p",{},void 0,gettext("There are no more posts in this thread."))};var uo,ho,mo;function vo(e){let{errors:t,posts:s}=e;return(0,n.Z)("div",{className:"modal-dialog",role:"document"},void 0,(0,n.Z)("div",{className:"modal-content"},void 0,(0,n.Z)("div",{className:"modal-header"},void 0,(0,n.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,uo||(uo=(0,n.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,n.Z)("h4",{className:"modal-title"},void 0,gettext("Moderation"))),(0,n.Z)("div",{className:"modal-body"},void 0,(0,n.Z)("p",{className:"lead"},void 0,gettext("One or more posts could not be changed:")),(0,n.Z)("ul",{className:"list-unstyled list-errored-items"},void 0,t.map((e=>(0,n.Z)(go,{errors:e.detail,post:s[e.id]},e.id)))))))}function go(e){let{errors:t,post:s}=e;const a=interpolate(gettext("%(username)s on %(posted_on)s"),{posted_on:s.posted_on.format("LL, LT"),username:s.poster_name},!0);return(0,n.Z)("li",{},void 0,(0,n.Z)("h5",{},void 0,a,":"),t.map(((e,t)=>(0,n.Z)("p",{},t,e))))}function Zo(e,t,s,a){const{selection:i,thread:o}=e;s.forEach((e=>{Ue.r$(e,e)})),g.Z.dispatch(xa.kR());const r={ops:t,ids:i.map((e=>e.id))};h.Z.patch(o.api.posts.index,r).then((e=>{e.forEach((e=>{g.Z.dispatch(Ue.r$(e,e))}))}),(e=>{if(400!==e.status)return a.forEach((e=>{g.Z.dispatch(Ue.r$(e,e))})),v.Z.apiError(e);let t=[],s=[];e.forEach((e=>{e.detail?(t.push(e),s.push(e.id)):g.Z.dispatch(Ue.r$(e,e)),a.forEach((e=>{-1!==s.indexOf(e)&&g.Z.dispatch(Ue.r$(e,e))}))}));let o={};i.forEach((e=>{o[e.id]=e})),m.Z.show((0,n.Z)(vo,{errors:t,posts:o}))}))}const bo=class extends d.Z{constructor(e){super(e),this.state={isLoading:!1,url:"",validators:{url:[]},errors:{}}}clean(){return!!this.state.url.trim().length||(v.Z.error(gettext("You have to enter link to the other thread.")),!1)}send(){return h.Z.post(this.props.thread.api.posts.move,{new_thread:this.state.url,posts:this.props.selection.map((e=>e.id))})}handleSuccess(e){this.props.selection.forEach((e=>{g.Z.dispatch(Ue.r$(e,{isDeleted:!0}))})),m.Z.hide(),v.Z.success(gettext("Selected posts were moved to the other thread."))}handleError(e){400===e.status?v.Z.error(e.detail):v.Z.apiError(e)}onUrlChange=e=>{this.changeValue("url",e.target.value)};render(){return(0,n.Z)("div",{className:"modal-dialog",role:"document"},void 0,(0,n.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,n.Z)("div",{className:"modal-content"},void 0,ho||(ho=(0,n.Z)(_o,{})),(0,n.Z)("div",{className:"modal-body"},void 0,(0,n.Z)(c.Z,{for:"id_url",label:gettext("Link to thread you want to move posts to")},void 0,(0,n.Z)("input",{className:"form-control",disabled:this.state.isLoading,id:"id_url",onChange:this.onUrlChange,value:this.state.url}))),(0,n.Z)("div",{className:"modal-footer"},void 0,(0,n.Z)("button",{className:"btn btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,gettext("Cancel")),(0,n.Z)("button",{className:"btn btn-primary",disabled:this.state.isLoading},void 0,gettext("Move posts"))))))}};function _o(e){return(0,n.Z)("div",{className:"modal-header"},void 0,(0,n.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,mo||(mo=(0,n.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,n.Z)("h4",{className:"modal-title"},void 0,gettext("Move posts")))}var fo,No,xo,yo,wo,ko,Co,So,Eo,Lo,To,Po,Oo,Ro,Ao,Io;function Do(e){return r.createElement(jo,(0,l.Z)({},e,{Form:zo}))}class jo extends r.Component{constructor(e){super(e),this.state={isLoaded:!1,isError:!1,categories:[]}}componentDidMount(){h.Z.get(misago.get("THREAD_EDITOR_API")).then((e=>{const t=e.map((e=>Object.assign(e,{disabled:!1===e.post,label:e.name,value:e.id,post:e.post})));this.setState({isLoaded:!0,categories:t})}),(e=>{this.setState({isError:e.detail})}))}render(){return this.state.isError?(0,n.Z)(Mo,{message:this.state.isError}):this.state.isLoaded?r.createElement(zo,(0,l.Z)({},this.props,{categories:this.state.categories})):fo||(fo=(0,n.Z)(Uo,{}))}}class zo extends d.Z{constructor(e){super(e),this.state={isLoading:!1,title:"",category:null,categories:e.categories,weight:0,is_hidden:0,is_closed:!1,validators:{title:[ea.C1()]},errors:{}},this.isHiddenChoices=[{value:0,icon:"visibility",label:gettext("No")},{value:1,icon:"visibility_off",label:gettext("Yes")}],this.isClosedChoices=[{value:!1,icon:"lock_outline",label:gettext("No")},{value:!0,icon:"lock",label:gettext("Yes")}],this.acl={},this.props.categories.forEach((e=>{e.post&&(this.state.category||(this.state.category=e.id),this.acl[e.id]={can_pin_threads:e.post.pin,can_close_threads:e.post.close,can_hide_threads:e.post.hide})}))}clean(){return!!this.isValid()||(v.Z.error(gettext("Form contains errors.")),this.setState({errors:this.validate()}),!1)}send(){return h.Z.post(this.props.thread.api.posts.split,{title:this.state.title,category:this.state.category,weight:this.state.weight,is_hidden:this.state.is_hidden,is_closed:this.state.is_closed,posts:this.props.selection.map((e=>e.id))})}handleSuccess(e){this.props.selection.forEach((e=>{g.Z.dispatch(Ue.r$(e,{isDeleted:!0}))})),m.Z.hide(),v.Z.success(gettext("Selected posts were split into new thread."))}handleError(e){400===e.status?(this.setState({errors:Object.assign({},this.state.errors,e)}),v.Z.error(gettext("Form contains errors."))):403===e.status&&Array.isArray(e)?m.Z.show((0,n.Z)(vo,{errors:e})):v.Z.apiError(e)}onCategoryChange=e=>{const t=e.target.value,s={category:t};this.acl[t].can_pin_threads<s.weight&&(s.weight=0),this.acl[t].can_hide_threads||(s.is_hidden=0),this.acl[t].can_close_threads||(s.is_closed=!1),this.setState(s)};getWeightChoices(){const e=[{value:0,icon:"remove",label:gettext("Not pinned")},{value:1,icon:"bookmark_border",label:gettext("Pinned locally")}];return 2==this.acl[this.state.category].can_pin_threads&&e.push({value:2,icon:"bookmark",label:gettext("Pinned globally")}),e}renderWeightField(){return this.acl[this.state.category].can_pin_threads?(0,n.Z)(c.Z,{label:gettext("Thread weight"),for:"id_weight",labelClass:"col-sm-4",controlClass:"col-sm-8"},void 0,(0,n.Z)(Xs.Z,{id:"id_weight",onChange:this.bindInput("weight"),value:this.state.weight,choices:this.getWeightChoices()})):null}renderHiddenField(){return this.acl[this.state.category].can_hide_threads?(0,n.Z)(c.Z,{label:gettext("Hide thread"),for:"id_is_hidden",labelClass:"col-sm-4",controlClass:"col-sm-8"},void 0,(0,n.Z)(Xs.Z,{id:"id_is_closed",onChange:this.bindInput("is_hidden"),value:this.state.is_hidden,choices:this.isHiddenChoices})):null}renderClosedField(){return this.acl[this.state.category].can_close_threads?(0,n.Z)(c.Z,{label:gettext("Close thread"),for:"id_is_closed",labelClass:"col-sm-4",controlClass:"col-sm-8"},void 0,(0,n.Z)(Xs.Z,{id:"id_is_closed",onChange:this.bindInput("is_closed"),value:this.state.is_closed,choices:this.isClosedChoices})):null}render(){return(0,n.Z)(Bo,{className:"modal-dialog"},void 0,(0,n.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,n.Z)("div",{className:"modal-body"},void 0,(0,n.Z)(c.Z,{label:gettext("Thread title"),for:"id_title",labelClass:"col-sm-4",controlClass:"col-sm-8",validation:this.state.errors.title},void 0,(0,n.Z)("input",{id:"id_title",className:"form-control",type:"text",onChange:this.bindInput("title"),value:this.state.title})),No||(No=(0,n.Z)("div",{className:"clearfix"})),(0,n.Z)(c.Z,{label:gettext("Category"),for:"id_category",labelClass:"col-sm-4",controlClass:"col-sm-8",validation:this.state.errors.category},void 0,(0,n.Z)(Js.Z,{id:"id_category",onChange:this.onCategoryChange,value:this.state.category,choices:this.state.categories})),xo||(xo=(0,n.Z)("div",{className:"clearfix"})),this.renderWeightField(),this.renderHiddenField(),this.renderClosedField()),(0,n.Z)("div",{className:"modal-footer"},void 0,(0,n.Z)("button",{className:"btn btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,gettext("Cancel")),(0,n.Z)(Se.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,gettext("Split posts")))))}}function Uo(){return yo||(yo=(0,n.Z)(Bo,{className:"modal-dialog"},void 0,(0,n.Z)(Y.Z,{})))}function Mo(e){return(0,n.Z)(Bo,{className:"modal-dialog modal-message"},void 0,wo||(wo=(0,n.Z)("div",{className:"message-icon"},void 0,(0,n.Z)("span",{className:"material-icon"},void 0,"info_outline"))),(0,n.Z)("div",{className:"message-body"},void 0,(0,n.Z)("p",{className:"lead"},void 0,gettext("You can't move selected posts at the moment.")),(0,n.Z)("p",{},void 0,e.message),(0,n.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,gettext("Ok"))))}function Bo(e){return(0,n.Z)("div",{className:e.className,role:"document"},void 0,(0,n.Z)("div",{className:"modal-content"},void 0,(0,n.Z)("div",{className:"modal-header"},void 0,(0,n.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,ko||(ko=(0,n.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,n.Z)("h4",{className:"modal-title"},void 0,gettext("Split posts into new thread"))),e.children))}function qo(e){return(0,n.Z)("ul",{className:"dropdown-menu dropdown-menu-right stick-to-bottom"},void 0,r.createElement(Ho,e),r.createElement(Fo,e),r.createElement(Yo,e),r.createElement(Vo,e),r.createElement(Go,e),r.createElement($o,e),r.createElement(Qo,e),r.createElement(Wo,e),r.createElement(Ko,e))}class Ho extends r.Component{onClick=()=>{!function(e){const{selection:t}=e,s=t.map((e=>({id:e.id,is_unapproved:!1}))),a=t.map((e=>({id:e.id,is_unapproved:e.is_unapproved})));Zo(e,[{op:"replace",path:"is-unapproved",value:!1}],s,a)}(this.props)};render(){const e=this.props.selection.find((e=>e.acl.can_approve&&e.is_unapproved));return e?(0,n.Z)("li",{},void 0,(0,n.Z)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,Co||(Co=(0,n.Z)("span",{className:"material-icon"},void 0,"done")),gettext("Approve"))):null}}class Fo extends r.Component{onClick=()=>{var e;e=this.props,window.confirm(gettext("Are you sure you want to merge selected posts? This action is not reversible!"))&&(e.selection.slice(1).map((e=>{g.Z.dispatch(Ue.r$(e,{isDeleted:!0}))})),h.Z.post(e.thread.api.posts.merge,{posts:e.selection.map((e=>e.id))}).then((e=>{g.Z.dispatch(Ue.r$(e,Ue.ZB(e)))}),(t=>{400===t.status?v.Z.error(t.detail):v.Z.apiError(t),e.selection.slice(1).map((e=>{g.Z.dispatch(Ue.r$(e,{isDeleted:!1}))}))})),g.Z.dispatch(xa.kR()))};render(){const e=this.props.selection.length>1&&this.props.selection.find((e=>e.acl.can_merge));return e?(0,n.Z)("li",{},void 0,(0,n.Z)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,So||(So=(0,n.Z)("span",{className:"material-icon"},void 0,"call_merge")),gettext("Merge"))):null}}class Yo extends r.Component{onClick=()=>{m.Z.show(r.createElement(bo,this.props))};render(){const e=this.props.selection.find((e=>e.acl.can_move));return e?(0,n.Z)("li",{},void 0,(0,n.Z)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,Eo||(Eo=(0,n.Z)("span",{className:"material-icon"},void 0,"arrow_forward")),gettext("Move"))):null}}class Vo extends r.Component{onClick=()=>{m.Z.show(r.createElement(Do,this.props))};render(){const e=this.props.selection.find((e=>e.acl.can_move));return e?(0,n.Z)("li",{},void 0,(0,n.Z)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,Lo||(Lo=(0,n.Z)("span",{className:"material-icon"},void 0,"call_split")),gettext("Split"))):null}}class Go extends r.Component{onClick=()=>{!function(e){const{selection:t}=e,s=t.map((e=>({id:e.id,is_protected:!0}))),a=t.map((e=>({id:e.id,is_protected:e.is_protected})));Zo(e,[{op:"replace",path:"is-protected",value:!0}],s,a)}(this.props)};render(){const e=this.props.selection.find((e=>!e.is_protected&&e.acl.can_protect));return e?(0,n.Z)("li",{},void 0,(0,n.Z)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,To||(To=(0,n.Z)("span",{className:"material-icon"},void 0,"lock_outline")),gettext("Protect"))):null}}class $o extends r.Component{onClick=()=>{!function(e){const{selection:t}=e,s=t.map((e=>({id:e.id,is_protected:!1}))),a=t.map((e=>({id:e.id,is_protected:e.is_protected})));Zo(e,[{op:"replace",path:"is-protected",value:!1}],s,a)}(this.props)};render(){const e=this.props.selection.find((e=>e.is_protected&&e.acl.can_protect));return e?(0,n.Z)("li",{},void 0,(0,n.Z)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,Po||(Po=(0,n.Z)("span",{className:"material-icon"},void 0,"lock_open")),gettext("Unprotect"))):null}}class Wo extends r.Component{onClick=()=>{!function(e){const{selection:t}=e,s=t.map((t=>({id:t.id,is_hidden:!0,hidden_on:I()(),hidden_by_name:e.user.username,url:Object.assign(t.url,{hidden_by:e.user.url})}))),a=t.map((e=>({id:e.id,is_hidden:e.is_hidden,hidden_on:e.hidden_on,hidden_by_name:e.hidden_by_name,url:e.url})));Zo(e,[{op:"replace",path:"is-hidden",value:!0}],s,a)}(this.props)};render(){const e=this.props.selection.find((e=>e.acl.can_hide&&!e.is_hidden));return e?(0,n.Z)("li",{},void 0,(0,n.Z)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,Oo||(Oo=(0,n.Z)("span",{className:"material-icon"},void 0,"visibility_off")),gettext("Hide"))):null}}class Qo extends r.Component{onClick=()=>{!function(e){const{selection:t}=e,s=t.map((t=>({id:t.id,is_hidden:!1,hidden_on:I()(),hidden_by_name:e.user.username,url:Object.assign(t.url,{hidden_by:e.user.url})}))),a=t.map((e=>({id:e.id,is_hidden:e.is_hidden,hidden_on:e.hidden_on,hidden_by_name:e.hidden_by_name,url:e.url})));Zo(e,[{op:"replace",path:"is-hidden",value:!1}],s,a)}(this.props)};render(){const e=this.props.selection.find((e=>e.acl.can_unhide&&e.is_hidden));return e?(0,n.Z)("li",{},void 0,(0,n.Z)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,Ro||(Ro=(0,n.Z)("span",{className:"material-icon"},void 0,"visibility")),gettext("Unhide"))):null}}class Ko extends r.Component{onClick=()=>{!function(e){if(!window.confirm(gettext("Are you sure you want to delete selected posts? This action is not reversible!")))return;e.selection.map((e=>{g.Z.dispatch(Ue.r$(e,{isDeleted:!0}))}));const t=e.selection.map((e=>e.id));h.Z.delete(e.thread.api.posts.index,t).then((()=>{}),(t=>{400===t.status?v.Z.error(t.detail):v.Z.apiError(t),e.selection.map((e=>{g.Z.dispatch(Ue.r$(e,{isDeleted:!1}))}))})),g.Z.dispatch(xa.kR())}(this.props)};render(){const e=this.props.selection.find((e=>e.acl.can_delete));return e?(0,n.Z)("li",{},void 0,(0,n.Z)("button",{type:"button",className:"btn btn-link",onClick:this.onClick},void 0,Ao||(Ao=(0,n.Z)("span",{className:"material-icon"},void 0,"clear")),gettext("Delete"))):null}}const Jo=e=>{let{thread:t,user:s,selection:a,dropup:i}=e;return(0,n.Z)("div",{className:i?"dropup":"dropdown"},void 0,(0,n.Z)("button",{type:"button",className:"btn btn-default btn-outline btn-icon dropdown-toggle",title:gettext("Posts options"),"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",disabled:0===a.length},void 0,Io||(Io=(0,n.Z)("span",{className:"material-icon"},void 0,"settings"))),(0,n.Z)(qo,{thread:t,user:s,selection:a}))};var Xo;const en=e=>{let{onClick:t}=e;return(0,n.Z)("button",{className:"btn btn-primary btn-outline btn-block",type:"button",onClick:t},void 0,Xo||(Xo=(0,n.Z)("span",{className:"material-icon"},void 0,"chat")),gettext("Reply"))};var tn;const sn=e=>{let{thread:t,posts:s,user:a,selection:i,moderation:o,onReply:r}=e;return(0,n.Z)(ro.o8,{},void 0,(0,n.Z)(ro.Z2,{},void 0,(0,n.Z)(ro.Eg,{},void 0,(0,n.Z)(co,{baseUrl:t.url.index,posts:s})),o.enabled&&(0,n.Z)(ro.Eg,{className:"hidden-sm hidden-md hidden-lg",shrink:!0},void 0,(0,n.Z)(Jo,{thread:t,user:a,selection:i,dropup:!0}))),(0,n.Z)(ro.Z2,{className:"hidden-xs hidden-sm",auto:!0},void 0,(0,n.Z)(ro.Eg,{},void 0,(0,n.Z)(po,{posts:s}))),tn||(tn=(0,n.Z)(ro.tw,{className:"hidden-md hidden-lg"})),a.is_authenticated&&(0,n.Z)(ro.Z2,{},void 0,(0,n.Z)(ro.Eg,{},void 0,(0,n.Z)(Yi,{thread:t})),t.acl.can_reply&&(0,n.Z)(ro.Eg,{},void 0,(0,n.Z)(en,{onClick:r})),o.enabled&&(0,n.Z)(ro.Eg,{className:"hidden-xs",shrink:!0},void 0,(0,n.Z)(Jo,{thread:t,user:a,selection:i,dropup:!0}))))};var an;const on=e=>{let{compact:t,disabled:s,onClick:a}=e;return(0,n.Z)("button",{className:Hi()("btn btn-default btn-outline",{"btn-block":!t,"btn-icon":t}),type:"button",title:t?gettext("Add poll"):null,disabled:s,onClick:a},void 0,an||(an=(0,n.Z)("span",{className:"material-icon"},void 0,"poll")),!t&&gettext("Add poll"))};var nn,rn,ln,dn,cn;const pn=e=>{let{user:t,thread:s}=e;return(0,n.Z)("div",{className:"dropdown"},void 0,(0,n.Z)("button",{className:"btn btn-default btn-outline btn-icon",title:gettext("Shortcuts"),"aria-expanded":"true","aria-haspopup":"true","data-toggle":"dropdown",type:"button"},void 0,nn||(nn=(0,n.Z)("span",{className:"material-icon"},void 0,"bookmark"))),(0,n.Z)("ul",{className:"dropdown-menu"},void 0,t.is_authenticated&&s.is_new&&(0,n.Z)("li",{},void 0,(0,n.Z)("a",{className:"btn btn-link",href:s.url.new_post},void 0,rn||(rn=(0,n.Z)("span",{className:"material-icon"},void 0,"comment")),gettext("Go to new post"))),s.best_answer&&(0,n.Z)("li",{},void 0,(0,n.Z)("a",{className:"btn btn-link",href:s.url.best_answer},void 0,ln||(ln=(0,n.Z)("span",{className:"material-icon"},void 0,"check_circle")),gettext("Go to best answer"))),s.has_unapproved_posts&&s.acl.can_approve&&(0,n.Z)("li",{},void 0,(0,n.Z)("a",{className:"btn btn-link",href:s.url.unapproved_post},void 0,dn||(dn=(0,n.Z)("span",{className:"material-icon"},void 0,"visibility")),gettext("Go to unapproved post"))),(0,n.Z)("li",{},void 0,(0,n.Z)("a",{className:"btn btn-link",href:s.url.last_post},void 0,cn||(cn=(0,n.Z)("span",{className:"material-icon"},void 0,"reply")),gettext("Go to last post")))))};var un;const hn=e=>{let{thread:t,posts:s,user:a,pollDisabled:i,selection:o,moderation:r,onPoll:l,onReply:d}=e;return(0,n.Z)(ro.o8,{},void 0,(0,n.Z)(ro.Z2,{className:"hidden-xs"},void 0,(0,n.Z)(ro.Eg,{},void 0,(0,n.Z)(pn,{thread:t,user:a})),(0,n.Z)(ro.Eg,{className:"hidden-xs hidden-sm"},void 0,(0,n.Z)(co,{baseUrl:t.url.index,posts:s}))),un||(un=(0,n.Z)(ro.tw,{})),t.acl.can_start_poll&&!t.poll&&(0,n.Z)(ro.Z2,{className:"hidden-xs"},void 0,(0,n.Z)(ro.Eg,{},void 0,(0,n.Z)(on,{disabled:i,onClick:l}))),t.acl.can_reply?(0,n.Z)(ro.Z2,{},void 0,(0,n.Z)(ro.Eg,{className:"hidden-sm hidden-md hidden-lg",shrink:!0},void 0,(0,n.Z)(pn,{thread:t,user:a})),(0,n.Z)(ro.Eg,{},void 0,(0,n.Z)(en,{onClick:d})),t.acl.can_start_poll&&!t.poll&&(0,n.Z)(ro.Eg,{className:"hidden-sm hidden-md hidden-lg",shrink:!0},void 0,(0,n.Z)(on,{disabled:i,onClick:l,compact:!0})),r.enabled&&(0,n.Z)(ro.Eg,{className:"hidden-xs",shrink:!0},void 0,(0,n.Z)(Jo,{thread:t,user:a,selection:o}))):(0,n.Z)(ro.Z2,{},void 0,(0,n.Z)(ro.Eg,{className:"hidden-sm hidden-md hidden-lg",shrink:!0},void 0,(0,n.Z)(pn,{thread:t,user:a})),t.acl.can_start_poll&&!t.poll&&(0,n.Z)(ro.Eg,{},void 0,(0,n.Z)(on,{disabled:i,onClick:l})),r.enabled&&(0,n.Z)(ro.Eg,{shrink:!0},void 0,(0,n.Z)(Jo,{thread:t,user:a,selection:o}))))},mn=class extends r.Component{constructor(e){super(e),this.state={editPoll:!1}}componentDidMount(){this.shouldFetchData()&&(this.fetchData(),this.setPageTitle()),this.startPollingApi()}componentDidUpdate(){this.shouldFetchData()&&(this.fetchData(),this.startPollingApi(),this.setPageTitle())}componentWillUnmount(){this.stopPollingApi()}shouldFetchData(){return!!this.props.posts.isLoaded&&1*(this.props.params.page||1)!=this.props.posts.page}fetchData(){g.Z.dispatch(xa.Rz()),h.Z.get(this.props.thread.api.posts.index,{page:this.props.params.page||1},"posts").then((e=>{this.update(e)}),(e=>{v.Z.apiError(e)}))}startPollingApi(){Wa.Z.start({poll:"thread-posts",url:this.props.thread.api.posts.index,data:{page:this.props.params.page||1},update:this.update,frequency:12e4,delayed:!0})}stopPollingApi(){Wa.Z.stop("thread-posts")}setPageTitle(){Qa.Z.set({title:this.props.thread.title,parent:this.props.thread.category.name,page:1*(this.props.params.page||1)})}update=e=>{g.Z.dispatch(u.gx(e)),g.Z.dispatch(xa.zD(e.post_set)),e.participants&&g.Z.dispatch(p.gx(e.participants)),e.poll&&g.Z.dispatch(ee.gx(e.poll)),this.setPageTitle()};openPollForm=()=>{this.setState({editPoll:!0})};closePollForm=()=>{this.setState({editPoll:!1})};openReplyForm=()=>{te.Z.open({mode:"REPLY",thread:this.props.thread,config:this.props.thread.api.editor,submit:this.props.thread.api.posts.index})};render(){const e=this.props.thread.category;let t="page page-thread";e.css_class&&(t+=" page-thread-"+e.css_class);const s="private_threads"===e.special_role?"private-threads":e.css_class||"category-threads",a=vn(this.props.thread,this.props.user),i=gn(this.props.posts.results,this.props.user),o=this.props.posts.results.filter((e=>e.isSelected));return(0,n.Z)("div",{className:t},void 0,(0,n.Z)(Ji,{styleName:s,thread:this.props.thread,posts:this.props.posts,user:this.props.user,moderation:a}),(0,n.Z)(Ja.Z,{},void 0,(0,n.Z)(P,{participants:this.props.participants,thread:this.props.thread,user:this.props.user}),(0,n.Z)(hn,{thread:this.props.thread,posts:this.props.posts,user:this.props.user,selection:o,moderation:i,pollDisabled:this.state.editPoll,onPoll:this.openPollForm,onReply:this.openReplyForm}),this.state.editPoll?(0,n.Z)(Ie,{poll:this.props.poll,thread:this.props.thread,close:this.closePollForm}):(0,n.Z)(Le,{poll:this.props.poll,thread:this.props.thread,user:this.props.user,edit:this.openPollForm}),this.props.thread.acl.can_reply?(0,n.Z)(Ka.mv,{posting:{mode:"REPLY",thread:this.props.thread,config:this.props.thread.api.editor,submit:this.props.thread.api.posts.index}},void 0,r.createElement(Va,this.props)):r.createElement(Va,this.props),(0,n.Z)(sn,{thread:this.props.thread,posts:this.props.posts,user:this.props.user,selection:o,moderation:i,onReply:this.openReplyForm})))}},vn=(e,t)=>{const s={enabled:!1,edit:!1,approve:!1,close:!1,open:!1,hide:!1,unhide:!1,move:!1,merge:!1,pinGlobally:!1,pinLocally:!1,unpin:!1,delete:!1};return t.is_authenticated?(s.edit=e.acl.can_edit,s.approve=e.acl.can_approve&&e.is_unapproved,s.close=e.acl.can_close&&!e.is_closed,s.open=e.acl.can_close&&e.is_closed,s.hide=e.acl.can_hide&&!e.is_hidden,s.unhide=e.acl.can_unhide&&e.is_hidden,s.move=e.acl.can_move,s.merge=e.acl.can_merge,s.pinGlobally=e.acl.can_pin_globally&&e.weight<2,s.pinLocally=e.acl.can_pin&&1!==e.weight,s.unpin=e.acl.can_pin&&1===e.weight||e.acl.can_pin_globally&&2===e.weight,s.delete=e.acl.can_delete,s.enabled=s.edit||s.approve||s.close||s.open||s.hide||s.unhide||s.move||s.merge||s.pinGlobally||s.pinLocally||s.unpin||s.delete,s):s},gn=(e,t)=>{const s={enabled:!1,approve:!1,move:!1,merge:!1,protect:!1,hide:!1,delete:!1};return t.is_authenticated?(e.forEach((e=>{e.is_event||(e.acl.can_approve&&e.is_unapproved&&(s.approve=!0),e.acl.can_move&&(s.move=!0),e.acl.can_merge&&(s.merge=!0),(e.acl.can_protect||e.acl.can_unprotect)&&(s.protect=!0),(e.acl.can_hide||e.acl.can_unhide)&&(s.hide=!0),e.acl.can_delete&&(s.delete=!0),(s.approve||s.move||s.merge||s.protect||s.hide||s.delete)&&(s.enabled=!0))})),s):s};function Zn(e){return{participants:e.participants,poll:e.poll,posts:e.posts,thread:e.thread,tick:e.tick.tick,user:e.auth.user}}function bn(){const e=N.Z.get("THREAD"),t=e.url.index.replace(e.slug+"-"+e.pk,":slug");return[{path:t,component:(0,o.$j)(Zn)(mn)},{path:t+":page/",component:(0,o.$j)(Zn)(mn)}]}var _n=s(9633);N.Z.addInitializer({name:"component:thread",initializer:function(e){e.has("THREAD")&&e.has("POSTS")&&(0,_n.Z)({paths:bn()})},after:"store"})},2168:(e,t,s)=>{"use strict";var a=s(2928),i=s(7785),o=s(7294),n=s(2211);function r(e,t){return e.last_post>t.last_post?-1:e.last_post<t.last_post?1:0}function l(e,t){return 2===e.weight&&e.weight>t.weight?-1:2===t.weight&&e.weight<t.weight?1:r(e,t)}function d(e,t){return e.weight>t.weight?-1:e.weight<t.weight?1:r(e,t)}var c,p=s(905),u=s(4646),h=s(2490),m=s(9655);const v=e=>{let{allItems:t,parentUrl:s,category:i,categories:o,list:n}=e;return(0,a.Z)("div",{className:"dropdown threads-category-picker"},void 0,(0,a.Z)("button",{type:"button",className:"btn btn-default btn-outline dropdown-toggle btn-block text-ellipsis","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},void 0,i&&(0,a.Z)("span",{className:"material-icon",style:{color:i.color||"inherit"}},void 0,"label"),i&&i.short_name&&(0,a.Z)("span",{className:i.short_name&&"hidden-md hidden-lg"},void 0,i.short_name),i?(0,a.Z)("span",{className:i.short_name&&"hidden-xs hidden-sm"},void 0,i.name):t),(0,a.Z)("ul",{className:"dropdown-menu"},void 0,(0,a.Z)("li",{},void 0,(0,a.Z)(m.rU,{to:s+n.path},void 0,t)),c||(c=(0,a.Z)("li",{role:"separator",className:"divider"})),o.map((e=>(0,a.Z)("li",{},e.id,(0,a.Z)(m.rU,{to:e.url.index+n.path},void 0,(0,a.Z)("span",{className:"material-icon",style:{color:e.color||"inherit"}},void 0,"label"),e.name))))))},g=e=>{let{baseUrl:t,list:s,lists:i}=e;return(0,a.Z)("div",{className:"dropdown threads-list-picker"},void 0,(0,a.Z)("button",{type:"button",className:"btn btn-default btn-outline dropdown-toggle btn-block","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},void 0,s.longName),(0,a.Z)("ul",{className:"dropdown-menu stick-to-bottom"},void 0,i.map((e=>(0,a.Z)("li",{},e.type,(0,a.Z)(m.rU,{to:t+e.path},void 0,e.longName))))))};var Z;const b=class extends o.Component{render(){return(0,a.Z)("div",{className:"modal-dialog",role:"document"},void 0,(0,a.Z)("div",{className:"modal-content"},void 0,(0,a.Z)("div",{className:"modal-header"},void 0,(0,a.Z)("button",{"aria-label":pgettext("modal","Close"),className:"close","data-dismiss":"modal",type:"button"},void 0,Z||(Z=(0,a.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,a.Z)("h4",{className:"modal-title"},void 0,gettext("Threads moderation"))),(0,a.Z)("div",{className:"modal-body"},void 0,(0,a.Z)("p",{className:"lead"},void 0,gettext("One or more threads could not be deleted:")),(0,a.Z)("ul",{className:"list-unstyled list-errored-items"},void 0,this.props.errors.map((e=>(0,a.Z)(_,{errors:e.errors,thread:e.thread},e.thread.id)))))))}};function _(e){let{errors:t,thread:s}=e;return(0,a.Z)("li",{},void 0,(0,a.Z)("h5",{},void 0,s.title),t.map(((e,t)=>(0,a.Z)("p",{},void 0,e))))}var f,N,x,y,w=s(3345),k=s(6359),C=s(7026),S=s(471),E=s(2233),L=s(1340),T=s(4600),P=s(2753),O=s(8657),R=s(9801),A=s(3904),I=s(287),D=s(5210);const j=class extends w.Z{constructor(e){super(e),this.state={isLoading:!1,title:"",category:null,weight:0,is_hidden:0,is_closed:!1,validators:{title:[D.C1()]},errors:{}},this.acl={};for(const t in e.user.acl.categories){if(!e.user.acl.categories.hasOwnProperty(t))continue;const s=e.user.acl.categories[t];this.acl[s.id]=s}this.categoryChoices=[],e.categories.forEach((e=>{if(e.level>0){const t=this.acl[e.id],s=!t.can_start_threads||e.is_closed&&!t.can_close_threads;this.categoryChoices.push({value:e.id,disabled:s,level:e.level-1,label:e.name}),s||this.state.category||(this.state.category=e.id)}})),this.isHiddenChoices=[{value:0,icon:"visibility",label:gettext("No")},{value:1,icon:"visibility_off",label:gettext("Yes")}],this.isClosedChoices=[{value:!1,icon:"lock_outline",label:gettext("No")},{value:!0,icon:"lock",label:gettext("Yes")}]}clean(){return!!this.isValid()||(A.Z.error(gettext("Form contains errors.")),this.setState({errors:this.validate()}),!1)}send(){return O.Z.post(E.Z.get("MERGE_THREADS_API"),this.getFormdata())}getFormdata=()=>({threads:this.props.threads.map((e=>e.id)),title:this.state.title,category:this.state.category,weight:this.state.weight,is_hidden:this.state.is_hidden,is_closed:this.state.is_closed});handleSuccess=e=>{this.props.threads.forEach((e=>{this.props.freezeThread(e.id),this.props.deleteThread(e)})),I.Z.dispatch(T.YP()),this.props.addThreads([e]),I.Z.dispatch((0,L.V8)(this.props.route.category,this.props.categoriesMap)),R.Z.hide()};handleError=e=>{400===e.status?e.best_answers||e.polls?R.Z.show((0,a.Z)(P.ZP,{api:E.Z.get("MERGE_THREADS_API"),bestAnswers:e.best_answers,data:this.getFormdata(),polls:e.polls,onError:this.handleError,onSuccess:this.handleSuccess})):(this.setState({errors:Object.assign({},this.state.errors,e)}),A.Z.error(gettext("Form contains errors."))):403===e.status&&Array.isArray(e)?R.Z.show((0,a.Z)(b,{errors:e})):e.best_answer?A.Z.error(e.best_answer[0]):e.poll?A.Z.error(e.poll[0]):A.Z.apiError(e)};onCategoryChange=e=>{const t=e.target.value,s={category:t};this.acl[t].can_pin_threads<s.weight&&(s.weight=0),this.acl[t].can_hide_threads||(s.is_hidden=0),this.acl[t].can_close_threads||(s.is_closed=!1),this.setState(s)};getWeightChoices(){const e=[{value:0,icon:"remove",label:gettext("Not pinned")},{value:1,icon:"bookmark_border",label:gettext("Pinned locally")}];return 2==this.acl[this.state.category].can_pin_threads&&e.push({value:2,icon:"bookmark",label:gettext("Pinned globally")}),e}renderWeightField(){return this.acl[this.state.category].can_pin_threads?(0,a.Z)(k.Z,{label:gettext("Thread weight"),for:"id_weight"},void 0,(0,a.Z)(S.Z,{id:"id_weight",onChange:this.bindInput("weight"),value:this.state.weight,choices:this.getWeightChoices()})):null}renderHiddenField(){return this.acl[this.state.category].can_hide_threads?(0,a.Z)(k.Z,{label:gettext("Hide thread"),for:"id_is_hidden"},void 0,(0,a.Z)(S.Z,{id:"id_is_closed",onChange:this.bindInput("is_hidden"),value:this.state.is_hidden,choices:this.isHiddenChoices})):null}renderClosedField(){return this.acl[this.state.category].can_close_threads?(0,a.Z)(k.Z,{label:gettext("Close thread"),for:"id_is_closed"},void 0,(0,a.Z)(S.Z,{id:"id_is_closed",onChange:this.bindInput("is_closed"),value:this.state.is_closed,choices:this.isClosedChoices})):null}renderForm(){return(0,a.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,a.Z)("div",{className:"modal-body"},void 0,(0,a.Z)(k.Z,{label:gettext("Thread title"),for:"id_title",validation:this.state.errors.title},void 0,(0,a.Z)("input",{id:"id_title",className:"form-control",type:"text",onChange:this.bindInput("title"),value:this.state.title})),f||(f=(0,a.Z)("div",{className:"clearfix"})),(0,a.Z)(k.Z,{label:gettext("Category"),for:"id_category",validation:this.state.errors.category},void 0,(0,a.Z)(C.Z,{id:"id_category",onChange:this.onCategoryChange,value:this.state.category,choices:this.categoryChoices})),N||(N=(0,a.Z)("div",{className:"clearfix"})),this.renderWeightField(),this.renderHiddenField(),this.renderClosedField()),(0,a.Z)("div",{className:"modal-footer"},void 0,(0,a.Z)("button",{className:"btn btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,gettext("Cancel")),(0,a.Z)(n.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,gettext("Merge threads"))))}renderCantMergeMessage(){return(0,a.Z)("div",{className:"modal-body"},void 0,x||(x=(0,a.Z)("div",{className:"message-icon"},void 0,(0,a.Z)("span",{className:"material-icon"},void 0,"info_outline"))),(0,a.Z)("div",{className:"message-body"},void 0,(0,a.Z)("p",{className:"lead"},void 0,gettext("You can't move threads because there are no categories you are allowed to move them to.")),(0,a.Z)("p",{},void 0,gettext("You need permission to start threads in category to be able to merge threads to it.")),(0,a.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,gettext("Ok"))))}getClassName(){return this.state.category?"modal-dialog":"modal-dialog modal-message"}render(){return(0,a.Z)("div",{className:this.getClassName(),role:"document"},void 0,(0,a.Z)("div",{className:"modal-content"},void 0,(0,a.Z)("div",{className:"modal-header"},void 0,(0,a.Z)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":pgettext("modal","Close")},void 0,y||(y=(0,a.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,a.Z)("h4",{className:"modal-title"},void 0,gettext("Merge threads"))),this.state.category?this.renderForm():this.renderCantMergeMessage()))}};var z,U;const M=class extends w.Z{constructor(e){super(e),this.state={category:null};const t={};for(const s in e.user.acl.categories){if(!e.user.acl.categories.hasOwnProperty(s))continue;const a=e.user.acl.categories[s];t[a.id]=a}this.categoryChoices=[],e.categories.forEach((e=>{if(e.level>0){const s=t[e.id],a=!s.can_start_threads||e.is_closed&&!s.can_close_threads;this.categoryChoices.push({value:e.id,disabled:a,level:e.level-1,label:e.name}),a||this.state.category||(this.state.category=e.id)}}))}handleSubmit=e=>{e.preventDefault(),R.Z.hide(),this.props.callApi([{op:"replace",path:"category",value:this.state.category},{op:"replace",path:"flatten-categories",value:null},{op:"add",path:"acl",value:!0}],gettext("Selected threads were moved."),(()=>{I.Z.dispatch((0,L.V8)(this.props.route.category,this.props.categoriesMap));const e=I.Z.getState(),t=e.threads.map((e=>e.id));I.Z.dispatch(T.$6(e.selection.filter((e=>-1!==t.indexOf(e)))))}))};getClassName(){return this.state.category?"modal-dialog":"modal-dialog modal-message"}renderForm(){return(0,a.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,a.Z)("div",{className:"modal-body"},void 0,(0,a.Z)(k.Z,{label:gettext("New category"),for:"id_new_category"},void 0,(0,a.Z)(C.Z,{id:"id_new_category",onChange:this.bindInput("category"),value:this.state.category,choices:this.categoryChoices}))),(0,a.Z)("div",{className:"modal-footer"},void 0,(0,a.Z)("button",{className:"btn btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,gettext("Cancel")),(0,a.Z)("button",{className:"btn btn-primary"},void 0,gettext("Move threads"))))}renderCantMoveMessage(){return(0,a.Z)("div",{className:"modal-body"},void 0,z||(z=(0,a.Z)("div",{className:"message-icon"},void 0,(0,a.Z)("span",{className:"material-icon"},void 0,"info_outline"))),(0,a.Z)("div",{className:"message-body"},void 0,(0,a.Z)("p",{className:"lead"},void 0,gettext("You can't move threads because there are no categories you are allowed to move them to.")),(0,a.Z)("p",{},void 0,gettext("You need permission to start threads in category to be able to move threads to it.")),(0,a.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,gettext("Ok"))))}render(){return(0,a.Z)("div",{className:this.getClassName(),role:"document"},void 0,(0,a.Z)("div",{className:"modal-content"},void 0,(0,a.Z)("div",{className:"modal-header"},void 0,(0,a.Z)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":pgettext("modal","Close")},void 0,U||(U=(0,a.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,a.Z)("h4",{className:"modal-title"},void 0,gettext("Move threads"))),this.state.category?this.renderForm():this.renderCantMoveMessage()))}};var B,q,H,F,Y,V,G,$,W,Q,K,J,X,ee;const te=class extends o.Component{callApi=(()=>{var e=this;return function(t,s){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.props.threads.forEach((t=>{e.props.freezeThread(t.id)}));const o=e.props.threads.map((e=>e.id));t.push({op:"add",path:"acl",value:!0}),O.Z.patch(e.props.api,{ids:o,ops:t}).then((t=>{e.props.threads.forEach((t=>{e.props.freezeThread(t.id)})),t.forEach((t=>{e.props.updateThread(t)})),A.Z.success(s),i&&i()}),(t=>{if(e.props.threads.forEach((t=>{e.props.freezeThread(t.id)})),400!==t.status)return A.Z.apiError(t);let s=[],i={};e.props.threads.forEach((e=>{i[e.id]=e})),t.forEach((e=>{let{id:t,detail:a}=e;void 0!==i[t]&&s.push({errors:a,thread:i[t]})})),R.Z.show((0,a.Z)(b,{errors:s}))}))}})();pinGlobally=()=>{this.callApi([{op:"replace",path:"weight",value:2}],gettext("Selected threads were pinned globally."))};pinLocally=()=>{this.callApi([{op:"replace",path:"weight",value:1}],gettext("Selected threads were pinned locally."))};unpin=()=>{this.callApi([{op:"replace",path:"weight",value:0}],gettext("Selected threads were unpinned."))};approve=()=>{this.callApi([{op:"replace",path:"is-unapproved",value:!1}],gettext("Selected threads were approved."))};open=()=>{this.callApi([{op:"replace",path:"is-closed",value:!1}],gettext("Selected threads were opened."))};close=()=>{this.callApi([{op:"replace",path:"is-closed",value:!0}],gettext("Selected threads were closed."))};unhide=()=>{this.callApi([{op:"replace",path:"is-hidden",value:!1}],gettext("Selected threads were unhidden."))};hide=()=>{this.callApi([{op:"replace",path:"is-hidden",value:!0}],gettext("Selected threads were hidden."))};move=()=>{R.Z.show((0,a.Z)(M,{callApi:this.callApi,categories:this.props.categories,categoriesMap:this.props.categoriesMap,route:this.props.route,user:this.props.user}))};merge=()=>{const e=[];if(this.props.threads.forEach((t=>{t.acl.can_merge||e.append({id:t.id,title:t.title,errors:[gettext("You don't have permission to merge this thread with others.")]})})),this.props.threads.length<2)A.Z.info(gettext("You have to select at least two threads to merge."));else{if(e.length)return void R.Z.show((0,a.Z)(b,{errors:e}));R.Z.show(o.createElement(j,this.props))}};delete=()=>{if(!window.confirm(gettext("Are you sure you want to delete selected threads?")))return;this.props.threads.map((e=>{this.props.freezeThread(e.id)}));const e=this.props.threads.map((e=>e.id));O.Z.delete(this.props.api,e).then((()=>{this.props.threads.map((e=>{this.props.freezeThread(e.id),this.props.deleteThread(e)})),A.Z.success(gettext("Selected threads were deleted."))}),(e=>{if(400===e.status){const t=e.map((e=>e.id));this.props.threads.map((e=>{this.props.freezeThread(e.id),-1===t.indexOf(e.id)&&this.props.deleteThread(e)})),R.Z.show((0,a.Z)(b,{errors:e}))}else A.Z.apiError(e)}))};render(){const{moderation:e,threads:t}=this.props,s=0==this.props.selection.length;return(0,a.Z)("ul",{className:"dropdown-menu dropdown-menu-right stick-to-bottom"},void 0,(0,a.Z)("li",{},void 0,(0,a.Z)("button",{className:"btn btn-link",type:"button",onClick:()=>I.Z.dispatch(T.$6(t.map((e=>e.id))))},void 0,B||(B=(0,a.Z)("span",{className:"material-icon"},void 0,"check_box")),gettext("Select all"))),(0,a.Z)("li",{},void 0,(0,a.Z)("button",{className:"btn btn-link",type:"button",disabled:s,onClick:()=>I.Z.dispatch(T.YP())},void 0,q||(q=(0,a.Z)("span",{className:"material-icon"},void 0,"check_box_outline_blank")),gettext("Select none"))),H||(H=(0,a.Z)("li",{role:"separator",className:"divider"})),!!e.can_pin_globally&&(0,a.Z)("li",{},void 0,(0,a.Z)("button",{className:"btn btn-link",type:"button",disabled:s,onClick:this.pinGlobally},void 0,F||(F=(0,a.Z)("span",{className:"material-icon"},void 0,"bookmark")),gettext("Pin threads globally"))),!!e.can_pin&&(0,a.Z)("li",{},void 0,(0,a.Z)("button",{className:"btn btn-link",type:"button",disabled:s,onClick:this.pinLocally},void 0,Y||(Y=(0,a.Z)("span",{className:"material-icon"},void 0,"bookmark_border")),gettext("Pin threads locally"))),!!e.can_pin&&(0,a.Z)("li",{},void 0,(0,a.Z)("button",{className:"btn btn-link",type:"button",disabled:s,onClick:this.unpin},void 0,V||(V=(0,a.Z)("span",{className:"material-icon"},void 0,"panorama_fish_eye")),gettext("Unpin threads"))),!!e.can_move&&(0,a.Z)("li",{},void 0,(0,a.Z)("button",{className:"btn btn-link",type:"button",disabled:s,onClick:this.move},void 0,G||(G=(0,a.Z)("span",{className:"material-icon"},void 0,"arrow_forward")),gettext("Move threads"))),!!e.can_merge&&(0,a.Z)("li",{},void 0,(0,a.Z)("button",{className:"btn btn-link",type:"button",disabled:s,onClick:this.merge},void 0,$||($=(0,a.Z)("span",{className:"material-icon"},void 0,"call_merge")),gettext("Merge threads"))),!!e.can_approve&&(0,a.Z)("li",{},void 0,(0,a.Z)("button",{className:"btn btn-link",type:"button",disabled:s,onClick:this.approve},void 0,W||(W=(0,a.Z)("span",{className:"material-icon"},void 0,"done")),gettext("Approve threads"))),!!e.can_close&&(0,a.Z)("li",{},void 0,(0,a.Z)("button",{className:"btn btn-link",type:"button",disabled:s,onClick:this.open},void 0,Q||(Q=(0,a.Z)("span",{className:"material-icon"},void 0,"lock_open")),gettext("Open threads"))),!!e.can_close&&(0,a.Z)("li",{},void 0,(0,a.Z)("button",{className:"btn btn-link",type:"button",disabled:s,onClick:this.close},void 0,K||(K=(0,a.Z)("span",{className:"material-icon"},void 0,"lock_outline")),gettext("Close threads"))),!!e.can_unhide&&(0,a.Z)("li",{},void 0,(0,a.Z)("button",{className:"btn btn-link",type:"button",disabled:s,onClick:this.unhide},void 0,J||(J=(0,a.Z)("span",{className:"material-icon"},void 0,"visibility")),gettext("Unhide threads"))),!!e.can_hide&&(0,a.Z)("li",{},void 0,(0,a.Z)("button",{className:"btn btn-link",type:"button",disabled:s,onClick:this.hide},void 0,X||(X=(0,a.Z)("span",{className:"material-icon"},void 0,"visibility_off")),gettext("Hide threads"))),!!e.can_delete&&(0,a.Z)("li",{},void 0,(0,a.Z)("button",{className:"btn btn-link",type:"button",disabled:s,onClick:this.delete},void 0,ee||(ee=(0,a.Z)("span",{className:"material-icon"},void 0,"clear")),gettext("Delete threads"))))}};var se;const ae=e=>{let{api:t,categoriesMap:s,categories:i,threads:o,addThreads:n,freezeThread:r,updateThread:l,deleteThread:d,selection:c,moderation:p,route:u,user:h,disabled:m}=e;return(0,a.Z)("div",{className:"dropdown threads-moderation"},void 0,(0,a.Z)("button",{type:"button",className:"btn btn-default btn-outline btn-icon dropdown-toggle",title:gettext("Moderation"),"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",disabled:m},void 0,se||(se=(0,a.Z)("span",{className:"material-icon"},void 0,"settings"))),(0,a.Z)(te,{api:t,categories:i,categoriesMap:s,threads:o,addThreads:n,freezeThread:r,updateThread:l,deleteThread:d,selection:c,moderation:p,route:u,user:h,disabled:m}))};var ie,oe;const ne=e=>{let{api:t,baseUrl:s,category:i,categories:o,categoriesMap:r,topCategory:l,topCategories:d,subCategory:c,subCategories:p,list:m,lists:Z,threads:b,addThreads:_,startThread:f,freezeThread:N,updateThread:x,deleteThread:y,selection:w,moderation:k,route:C,user:S,disabled:E}=e;return(0,a.Z)(h.o8,{},void 0,d.length>0&&(0,a.Z)(h.Z2,{},void 0,(0,a.Z)(h.Eg,{},void 0,(0,a.Z)(v,{allItems:gettext("All categories"),parentUrl:m.path,category:l,categories:d,list:m})),l&&p.length>0&&(0,a.Z)(h.Eg,{},void 0,(0,a.Z)(v,{allItems:gettext("All subcategories"),parentUrl:l.url.index,category:c,categories:p,list:m}))),Z.length>1&&(0,a.Z)(h.Z2,{className:"hidden-xs"},void 0,(0,a.Z)(h.Eg,{},void 0,(0,a.Z)(g,{baseUrl:s,list:m,lists:Z}))),ie||(ie=(0,a.Z)(h.tw,{})),!!S.id&&(0,a.Z)(h.Z2,{},void 0,(0,a.Z)(h.Eg,{},void 0,(0,a.Z)(n.Z,{className:"btn-primary btn-outline btn-block",disabled:E,onClick:()=>{u.Z.open(f||{mode:"START",config:misago.get("THREAD_EDITOR_API"),submit:misago.get("THREADS_API"),category:i.id})}},void 0,oe||(oe=(0,a.Z)("span",{className:"material-icon"},void 0,"chat")),gettext("Start thread"))),!!k.allow&&(0,a.Z)(h.Eg,{shrink:!0},void 0,(0,a.Z)(ae,{api:t,categories:o,categoriesMap:r,threads:b.filter((e=>-1!==w.indexOf(e.id))),addThreads:_,freezeThread:N,updateThread:x,deleteThread:y,selection:w,moderation:k,route:C,user:S,disabled:E}))))},re=class extends o.Component{render(){const{root:e}=this.props,{category:t,categories:s,categoriesMap:i}=this.props.route,o=le(e,t,i);return(0,a.Z)(p.Z,{},void 0,(0,a.Z)(ne,{api:this.props.api,baseUrl:t.url.index,category:t,categories:s,categoriesMap:i,topCategory:o,topCategories:s.filter((t=>t.parent===e.id)),subCategories:o?s.filter((e=>e.parent===o.id)):[],subCategory:2===t.level?t:null,subcategories:this.props.subcategories,list:this.props.route.list,lists:this.props.route.lists,threads:this.props.threads,addThreads:this.props.addThreads,startThread:this.props.startThread,freezeThread:this.props.freezeThread,deleteThread:this.props.deleteThread,updateThread:this.props.updateThread,selection:this.props.selection,moderation:this.props.moderation,route:this.props.route,user:this.props.user,disabled:!this.props.isLoaded||this.props.isBusy||this.props.busyThreads.length}),this.props.children)}},le=(e,t,s)=>t.parent?t.parent===e.id?t:s[t.parent]:null;function de(e,t){let s={};return e.forEach((function(e){s[e.id]=e})),t.filter((function(e){return!s[e.id]||function(e,t){return[e.title===t.title,e.weight===t.weight,e.category===t.category,e.last_post===t.last_post,e.last_poster_name===t.last_poster_name].indexOf(!1)>=0}(s[e.id],e)}))}function ce(e){let t={allow:!1,can_approve:0,can_close:0,can_delete:0,can_hide:0,can_merge:0,can_move:0,can_pin:0,can_pin_globally:0,can_unhide:0};return e.forEach((function(e){e.is_unapproved&&e.acl.can_approve>t.can_approve&&(t.can_approve=e.acl.can_approve),e.acl.can_close>t.can_close&&(t.can_close=e.acl.can_close),e.acl.can_delete>t.can_delete&&(t.can_delete=e.acl.can_delete),e.acl.can_hide>t.can_hide&&(t.can_hide=e.acl.can_hide),e.acl.can_merge>t.can_merge&&(t.can_merge=e.acl.can_merge),e.acl.can_move>t.can_move&&(t.can_move=e.acl.can_move),e.acl.can_pin>t.can_pin&&(t.can_pin=e.acl.can_pin),e.acl.can_pin_globally>t.can_pin_globally&&(t.can_pin_globally=e.acl.can_pin_globally),e.is_hidden&&e.acl.can_unhide>t.can_unhide&&(t.can_unhide=e.acl.can_unhide),t.allow=t.can_approve||t.can_close||t.can_delete||t.can_hide||t.can_merge||t.can_move||t.can_pin||t.can_pin_globally||t.can_unhide})),t}const pe=e=>{let{category:t,list:s,message:i}=e;return"all"===s.type?i?(0,a.Z)("li",{className:"list-group-item empty-message"},void 0,(0,a.Z)("p",{className:"lead"},void 0,i),(0,a.Z)("p",{},void 0,gettext("Why not start one yourself?"))):(0,a.Z)("li",{className:"list-group-item empty-message"},void 0,(0,a.Z)("p",{className:"lead"},void 0,t.special_role?gettext("There are no threads on this forum... yet!"):gettext("There are no threads in this category.")),(0,a.Z)("p",{},void 0,gettext("Why not start one yourself?"))):(0,a.Z)("li",{className:"list-group-item empty-message"},void 0,(0,a.Z)("p",{className:"lead"},void 0,gettext("No threads matching specified criteria were found.")))};var ue=s(366),he=s(6768);const me=e=>{let{thread:t}=e;return(0,a.Z)("a",{href:t.url.last_post,className:"threads-list-item-last-activity",title:interpolate(gettext("Last activity: %(timestamp)s"),{timestamp:t.last_post_on.format("LLL")},!0)},void 0,t.last_post_on.fromNow(!0))},ve=e=>{let t="threads-list-item-category threads-list-category-label";return e.color&&(t+=" threads-list-category-label-color"),t},ge=e=>{let{parent:t,category:s}=e;return(0,a.Z)("span",{},void 0,t&&(0,a.Z)("a",{href:t.url.index,className:ve(t)+" threads-list-item-parent-category",style:t.color?{"--label-color":t.color}:null,title:t.short_name?t.name:null},void 0,t.short_name||t.name),(0,a.Z)("a",{href:s.url.index,className:ve(s),style:s.color?{"--label-color":s.color}:null,title:s.short_name?s.name:null},void 0,s.short_name||s.name))},Ze=e=>{let{checked:t,disabled:s,thread:i}=e;return(0,a.Z)("button",{className:"btn btn-default btn-icon",type:"button",disabled:s,onClick:()=>I.Z.dispatch(T.wc(i.id))},void 0,(0,a.Z)("span",{className:"material-icon"},void 0,t?"check_box":"check_box_outline_blank"))},be=e=>{let{thread:t}=e,s="threads-list-icon";return t.is_read||(s+=" threads-list-icon-new"),(0,a.Z)("a",{title:t.is_read?gettext("No new posts"):gettext("New posts"),href:t.is_read?t.url.last_post:t.url.new_post,className:s},void 0,(0,a.Z)("span",{className:"material-icon"},void 0,t.is_read?"chat_bubble_outline":"chat_bubble"))};var _e,fe=s(9605);const Ne=e=>{let{thread:t}=e;return t.last_poster?(0,a.Z)("a",{href:t.url.last_poster,className:"threads-list-item-last-poster",title:interpolate(gettext("Last post by: %(poster)s"),{poster:t.last_poster.username},!0)},void 0,(0,a.Z)(fe.ZP,{size:32,user:t.last_poster})):(0,a.Z)("span",{className:"threads-list-item-last-poster",title:interpolate(gettext("Last post by: %(poster)s"),{poster:t.last_poster_name},!0)},void 0,_e||(_e=(0,a.Z)(fe.ZP,{size:32})))};var xe,ye,we;const ke={unsubscribe:null,notify:!1,email:!0};class Ce extends o.Component{constructor(e){super(e),this.state={loading:!1}}update=e=>{const{thread:t}=this.props;this.setState({loading:!0}),I.Z.dispatch((0,L.r$)(t,{subscription:ke[e]})),O.Z.patch(t.api.index,[{op:"replace",path:"subscription",value:e}]).then((()=>{}),(e=>{I.Z.dispatch((0,L.r$)(t,{subscription:ke[t.subscription]})),A.Z.apiError(e)})).then((()=>this.setState({loading:!1})))};render=()=>{const{loading:e}=this.state,{disabled:t,thread:s}=this.props;return(0,a.Z)("ul",{className:"dropdown-menu dropdown-menu-right"},void 0,(0,a.Z)("li",{},void 0,(0,a.Z)("button",{className:"btn-link",disabled:t||e||null===s.subscription,onClick:()=>this.update("unsubscribe")},void 0,xe||(xe=(0,a.Z)("span",{className:"material-icon"},void 0,"star_border")),gettext("Unsubscribe"))),(0,a.Z)("li",{},void 0,(0,a.Z)("button",{className:"btn-link",disabled:t||e||!1===s.subscription,onClick:()=>this.update("notify")},void 0,ye||(ye=(0,a.Z)("span",{className:"material-icon"},void 0,"star_half")),gettext("Subscribe with alert"))),(0,a.Z)("li",{},void 0,(0,a.Z)("button",{className:"btn-link",disabled:t||e||!0===s.subscription,onClick:()=>this.update("email")},void 0,we||(we=(0,a.Z)("span",{className:"material-icon"},void 0,"star")),gettext("Subscribe with e-mail"))))}}const Se=Ce,Ee=e=>{let{disabled:t,thread:s}=e;return(0,a.Z)("div",{className:"dropdown"},void 0,(0,a.Z)("button",{className:"btn btn-default btn-icon",type:"button",title:(i=s.subscription,!0===i?gettext("Subscribed to e-mails"):!1===i?gettext("Subscribed to alerts"):gettext("Not subscribed")),disabled:t,"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},void 0,(0,a.Z)("span",{className:"material-icon"},void 0,(e=>!0===e?"star":!1===e?"star_half":"star_border")(s.subscription))),(0,a.Z)(Se,{disabled:t,thread:s}));var i};var Le;const Te=e=>{let{activeCategory:t,categories:s,showOptions:i,showSubscription:o,thread:n,isBusy:r,isSelected:l}=e,d=null,c=null;t.id!==n.category&&(c=s[n.category],c.parent&&c.parent!==t.id&&s[c.parent]&&!s[c.parent].special_role&&(d=s[c.parent]));const p=n.is_closed||n.is_hidden||n.is_unapproved||n.weight>0||n.best_answer||n.has_poll||n.has_unapproved_posts,u=!!i&&n.is_new;return(0,a.Z)("li",{className:"list-group-item threads-list-item"+(r?" threads-list-item-is-busy":"")},void 0,(0,a.Z)("div",{className:"threads-list-item-top-row"},void 0,i&&(0,a.Z)("div",{className:"threads-list-item-col-icon"},void 0,(0,a.Z)(be,{thread:n})),(0,a.Z)("div",{className:"threads-list-item-col-title"},void 0,(0,a.Z)("a",{href:n.url.index,className:"threads-list-item-title"},void 0,n.title),(0,a.Z)("a",{href:u?n.url.new_post:n.url.index,className:"threads-list-item-title-sm"+(u?" threads-list-item-title-new":"")},void 0,n.title)),i&&n.moderation.length>0&&(0,a.Z)("div",{className:"threads-list-item-col-checkbox-sm"},void 0,(0,a.Z)(Ze,{checked:l,disabled:r,thread:n}))),(0,a.Z)("div",{className:"threads-list-item-bottom-row"},void 0,p&&(0,a.Z)("div",{className:"threads-list-item-col-flags"},void 0,(0,a.Z)(ue.Z,{thread:n})),!!c&&(0,a.Z)("div",{className:"threads-list-item-col-category"},void 0,(0,a.Z)(ge,{parent:d,category:c})),Le||(Le=(0,a.Z)("div",{className:"threads-list-item-col-spacer-xs"})),(0,a.Z)("div",{className:"threads-list-item-col-replies"},void 0,(0,a.Z)(he.Z,{thread:n})),(0,a.Z)("div",{className:"threads-list-item-col-last-poster"},void 0,(0,a.Z)(Ne,{thread:n})),(0,a.Z)("div",{className:"threads-list-item-col-last-activity"},void 0,(0,a.Z)(me,{thread:n})),i&&o&&(0,a.Z)("div",{className:"threads-list-item-col-subscription"},void 0,(0,a.Z)(Ee,{disabled:r,thread:n})),i&&n.moderation.length>0&&(0,a.Z)("div",{className:"threads-list-item-col-checkbox"},void 0,(0,a.Z)(Ze,{checked:l,disabled:r,thread:n}))))},Pe=e=>{let{width:t}=e;return(0,a.Z)("span",{className:"ui-preview-text",style:{width:t+"px"}},void 0," ")};var Oe,Re,Ae,Ie,De,je,ze,Ue,Me;const Be=e=>{let{showOptions:t}=e;return(0,a.Z)("div",{className:"threads-list threads-list-loader"},void 0,(0,a.Z)("ul",{className:"list-group"},void 0,(0,a.Z)("li",{className:"list-group-item threads-list-item"},void 0,(0,a.Z)("div",{className:"threads-list-item-top-row"},void 0,t&&(Oe||(Oe=(0,a.Z)("div",{className:"threads-list-item-col-icon"},void 0,(0,a.Z)("span",{className:"threads-list-icon ui-preview-img"})))),Re||(Re=(0,a.Z)("div",{className:"threads-list-item-col-title"},void 0,(0,a.Z)("span",{className:"threads-list-item-title"},void 0,(0,a.Z)(Pe,{width:"90"})," ",(0,a.Z)(Pe,{width:"40"})," ",(0,a.Z)(Pe,{width:"120"})),(0,a.Z)("span",{className:"threads-list-item-title-sm"},void 0,(0,a.Z)(Pe,{width:"90"})," ",(0,a.Z)(Pe,{width:"40"})," ",(0,a.Z)(Pe,{width:"120"}))))),Ae||(Ae=(0,a.Z)("div",{className:"threads-list-item-bottom-row"},void 0,(0,a.Z)("div",{className:"threads-list-item-col-category"},void 0,(0,a.Z)(Pe,{width:"70"})),(0,a.Z)("div",{className:"threads-list-item-col-replies"},void 0,(0,a.Z)(Pe,{width:"50"})),(0,a.Z)("div",{className:"threads-list-item-col-last-poster"},void 0,(0,a.Z)("span",{className:"threads-list-item-last-poster"},void 0,(0,a.Z)(fe.ZP,{size:32}))),(0,a.Z)("div",{className:"threads-list-item-col-last-activity"},void 0,(0,a.Z)("span",{className:"threads-list-item-last-activity"},void 0,(0,a.Z)(Pe,{width:"50"})))))),(0,a.Z)("li",{className:"list-group-item threads-list-item"},void 0,(0,a.Z)("div",{className:"threads-list-item-top-row"},void 0,t&&(Ie||(Ie=(0,a.Z)("div",{className:"threads-list-item-col-icon"},void 0,(0,a.Z)("span",{className:"threads-list-icon ui-preview-img"})))),De||(De=(0,a.Z)("div",{className:"threads-list-item-col-title"},void 0,(0,a.Z)("span",{className:"threads-list-item-title"},void 0,(0,a.Z)(Pe,{width:"120"})," ",(0,a.Z)(Pe,{width:"30"})," ",(0,a.Z)(Pe,{width:"60"})),(0,a.Z)("span",{className:"threads-list-item-title-sm"},void 0,(0,a.Z)(Pe,{width:"120"})," ",(0,a.Z)(Pe,{width:"30"})," ",(0,a.Z)(Pe,{width:"60"}))))),je||(je=(0,a.Z)("div",{className:"threads-list-item-bottom-row"},void 0,(0,a.Z)("div",{className:"threads-list-item-col-category"},void 0,(0,a.Z)(Pe,{width:"55"})),(0,a.Z)("div",{className:"threads-list-item-col-replies"},void 0,(0,a.Z)(Pe,{width:"60"})),(0,a.Z)("div",{className:"threads-list-item-col-last-poster"},void 0,(0,a.Z)("span",{className:"threads-list-item-last-poster"},void 0,(0,a.Z)(fe.ZP,{size:32}))),(0,a.Z)("div",{className:"threads-list-item-col-last-activity"},void 0,(0,a.Z)("span",{className:"threads-list-item-last-activity"},void 0,(0,a.Z)(Pe,{width:"70"})))))),(0,a.Z)("li",{className:"list-group-item threads-list-item"},void 0,(0,a.Z)("div",{className:"threads-list-item-top-row"},void 0,t&&(ze||(ze=(0,a.Z)("div",{className:"threads-list-item-col-icon"},void 0,(0,a.Z)("span",{className:"threads-list-icon ui-preview-img"})))),Ue||(Ue=(0,a.Z)("div",{className:"threads-list-item-col-title"},void 0,(0,a.Z)("span",{className:"threads-list-item-title"},void 0,(0,a.Z)(Pe,{width:"40"})," ",(0,a.Z)(Pe,{width:"120"})," ",(0,a.Z)(Pe,{width:"80"})),(0,a.Z)("span",{className:"threads-list-item-title-sm"},void 0,(0,a.Z)(Pe,{width:"40"})," ",(0,a.Z)(Pe,{width:"120"})," ",(0,a.Z)(Pe,{width:"80"}))))),Me||(Me=(0,a.Z)("div",{className:"threads-list-item-bottom-row"},void 0,(0,a.Z)("div",{className:"threads-list-item-col-category"},void 0,(0,a.Z)(Pe,{width:"75"})),(0,a.Z)("div",{className:"threads-list-item-col-replies"},void 0,(0,a.Z)(Pe,{width:"40"})),(0,a.Z)("div",{className:"threads-list-item-col-last-poster"},void 0,(0,a.Z)("span",{className:"threads-list-item-last-poster"},void 0,(0,a.Z)(fe.ZP,{size:32}))),(0,a.Z)("div",{className:"threads-list-item-col-last-activity"},void 0,(0,a.Z)("span",{className:"threads-list-item-last-activity"},void 0,(0,a.Z)(Pe,{width:"60"}))))))))};var qe;const He=e=>{let{threads:t,onClick:s}=e;return(0,a.Z)("li",{className:"list-group-item threads-list-update-prompt"},void 0,(0,a.Z)("button",{type:"button",className:"btn btn-block threads-list-update-prompt-btn",onClick:s},void 0,qe||(qe=(0,a.Z)("span",{className:"material-icon"},void 0,"cached")),(0,a.Z)("span",{className:"threads-list-update-prompt-message"},void 0,interpolate(ngettext("There is %(threads)s new or updated thread. Click here to show it.","There are %(threads)s new or updated threads. Click here to show them.",t),{threads:t},!0))))},Fe=e=>{let{list:t,categories:s,category:i,threads:o,busyThreads:n,selection:r,isLoaded:l,showOptions:d,updatedThreads:c,applyUpdate:p,emptyMessage:u}=e;return l?(0,a.Z)("div",{className:"threads-list"},void 0,o.length>0?(0,a.Z)("ul",{className:"list-group"},void 0,c>0&&(0,a.Z)(He,{threads:c,onClick:p}),o.map((e=>(0,a.Z)(Te,{activeCategory:i,categories:s,thread:e,showOptions:d,showSubscription:d&&"subscribed"===t.type,isBusy:n.indexOf(e.id)>=0,isSelected:r.indexOf(e.id)>=0},e.id)))):(0,a.Z)("ul",{className:"list-group"},void 0,c>0&&(0,a.Z)(He,{threads:c,onClick:p}),(0,a.Z)(pe,{category:i,list:t,message:u}))):(0,a.Z)(Be,{showOptions:d})};var Ye=s(2125),Ve=s(5547),Ge=s(3328),$e=s(5830),We=s(9145);const Qe=class extends Ye.Z{constructor(e){super(e),this.state={isMounted:!0,isLoaded:!1,isBusy:!1,diff:{results:[]},moderation:[],busyThreads:[],dropdown:!1,subcategories:[],next:0};let t=this.getCategory();E.Z.has("THREADS")?this.initWithPreloadedData(t,E.Z.get("THREADS")):this.initWithoutPreloadedData(t)}getCategory(){return this.props.route.category.special_role?null:this.props.route.category.id}initWithPreloadedData(e,t){this.state=Object.assign(this.state,{moderation:ce(t.results),subcategories:t.subcategories,next:t.next}),this.startPolling(e)}initWithoutPreloadedData(e){this.loadThreads(e)}loadThreads(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;O.Z.get(this.props.options.api,{category:e,list:this.props.route.list.type,start:t||0},"threads").then((s=>{this.state.isMounted&&(0===t?I.Z.dispatch((0,L.ZB)(s.results)):I.Z.dispatch((0,L.R3)(s.results,this.getSorting())),this.setState({isLoaded:!0,isBusy:!1,moderation:ce(I.Z.getState().threads),subcategories:s.subcategories,next:s.next}),this.startPolling(e))}),(e=>{A.Z.apiError(e)}))}startPolling(e){Ve.Z.start({poll:"threads",url:this.props.options.api,data:{category:e,list:this.props.route.list.type},frequency:12e4,update:this.pollResponse})}componentDidMount(){this.setPageTitle(),E.Z.has("THREADS")&&(I.Z.dispatch((0,L.ZB)(E.Z.pop("THREADS").results)),this.setState({isLoaded:!0})),I.Z.dispatch(T.YP())}componentWillUnmount(){this.state.isMounted=!1,Ve.Z.stop("threads")}getTitle(){return this.props.options.title?this.props.options.title:function(e){return e.category.level?e.category.name:E.Z.get("THREADS_ON_INDEX")?E.Z.get("SETTINGS").index_header?E.Z.get("SETTINGS").index_header:E.Z.get("SETTINGS").forum_name:gettext("Threads")}(this.props.route)}setPageTitle(){this.props.route.category.level||!E.Z.get("THREADS_ON_INDEX")?Ge.Z.set(function(e){return e.category.level?e.list.path?{title:e.list.longName,parent:e.category.name}:{title:e.category.name}:E.Z.get("THREADS_ON_INDEX")?e.list.path?{title:e.list.longName}:null:e.list.path?{title:e.list.longName,parent:gettext("Threads")}:{title:gettext("Threads")}}(this.props.route)):this.props.options.title?Ge.Z.set(this.props.options.title):E.Z.get("SETTINGS").index_title?document.title=E.Z.get("SETTINGS").index_title:document.title=E.Z.get("SETTINGS").forum_name}getSorting(){return this.props.route.category.level?d:l}loadMore=()=>{this.setState({isBusy:!0}),this.loadThreads(this.getCategory(),this.state.next)};pollResponse=e=>{this.setState({diff:Object.assign({},e,{results:de(this.props.threads,e.results)})})};addThreads=e=>{I.Z.dispatch((0,L.R3)(e,this.getSorting()))};applyDiff=()=>{this.addThreads(this.state.diff.results),this.setState(Object.assign({},this.state.diff,{moderation:ce(I.Z.getState().threads),diff:{results:[]}}))};freezeThread=e=>{this.setState((function(t){return{busyThreads:$e.ZN(t.busyThreads,e)}}))};updateThread=e=>{I.Z.dispatch((0,L.r$)(e,e,this.getSorting()))};deleteThread=e=>{I.Z.dispatch((0,L.l8)(e))};getMoreButton(){return this.state.next?(0,a.Z)("div",{className:"pager-more"},void 0,(0,a.Z)(n.Z,{className:"btn btn-default btn-outline",loading:this.state.isBusy||this.state.busyThreads.length,onClick:this.loadMore},void 0,gettext("Show more"))):null}getClassName(){let e="page page-threads";var t;return e+=" page-threads-"+this.props.route.list.type,(t=this.props).route.category.level||!E.Z.get("THREADS_ON_INDEX")||t.options.title||(e+=" page-threads-index"),this.props.route.category.css_class&&(e+=" page-threads-"+this.props.route.category.css_class),e}render(){const e=this.props.route.categories[0],{category:t,list:s}=this.props.route,i=t.special_role;return(0,a.Z)("div",{className:this.getClassName()},void 0,"root_category"==i&&E.Z.get("THREADS_ON_INDEX")&&E.Z.get("SETTINGS").index_header&&(0,a.Z)(We.Iv,{header:E.Z.get("SETTINGS").index_header,message:t.description&&(0,a.Z)(We.Ql,{message:t.description.html}),styleName:"forum-index"}),"root_category"==i&&!E.Z.get("THREADS_ON_INDEX")&&(0,a.Z)(We.Iv,{header:gettext("Threads"),styleName:"threads"}),"private_threads"==i&&(0,a.Z)(We.Iv,{header:this.props.options.title,message:this.props.options.pageLead&&(0,a.Z)(We.bM,{},void 0,(0,a.Z)("p",{},void 0,this.props.options.pageLead)),styleName:"private-threads"}),!i&&(0,a.Z)(We.Iv,{header:t.name,message:t.description&&(0,a.Z)(We.Ql,{message:t.description.html}),styleName:t.css_class||"category-threads"}),(0,a.Z)(re,{api:this.props.options.api,root:e,route:this.props.route,user:this.props.user,pageLead:this.props.options.pageLead,threads:this.props.threads,threadsCount:this.state.count,moderation:this.state.moderation,selection:this.props.selection,busyThreads:this.state.busyThreads,addThreads:this.addThreads,startThread:this.props.options.startThread,freezeThread:this.freezeThread,deleteThread:this.deleteThread,updateThread:this.updateThread,isLoaded:this.state.isLoaded,isBusy:this.state.isBusy},void 0,(0,a.Z)(Fe,{category:t,categories:this.props.route.categoriesMap,list:s,selection:this.props.selection,threads:this.props.threads,updatedThreads:this.state.diff.results.length,applyUpdate:this.applyDiff,showOptions:!!this.props.user.id,isLoaded:this.state.isLoaded,busyThreads:this.state.busyThreads,emptyMessage:this.props.options.emptyMessage}),this.getMoreButton()))}};function Ke(e,t){var s;let o=function(e){let t=[{type:"all",path:"",name:gettext("All"),longName:gettext("All threads")}];return e.id&&(t.push({type:"my",path:"my/",name:gettext("My"),longName:gettext("My threads")}),t.push({type:"new",path:"new/",name:gettext("New"),longName:gettext("New threads")}),t.push({type:"unread",path:"unread/",name:gettext("Unread"),longName:gettext("Unread threads")}),t.push({type:"subscribed",path:"subscribed/",name:gettext("Subscribed"),longName:gettext("Subscribed threads")}),e.acl.can_see_unapproved_content_lists&&t.push({type:"unapproved",path:"unapproved/",name:gettext("Unapproved"),longName:gettext("Unapproved content")})),t}(e),n=[],r={};const l=(0,i.$j)((d=t,function(e){return{options:d,selection:e.selection,threads:e.threads,tick:e.tick.tick,user:e.auth.user}}))(Qe);var d;return E.Z.get("CATEGORIES").forEach((function(e){o.forEach((function(t){r[e.id]=e,n.push({path:e.url.index+t.path,element:s||(s=(0,a.Z)(l,{})),categories:E.Z.get("CATEGORIES"),categoriesMap:r,category:e,lists:o,list:t})}))})),n}var Je=s(9633);const Xe="misago:private-threads";function et(e){return e.get("CURRENT_LINK").substr(0,Xe.length)===Xe?{api:e.get("PRIVATE_THREADS_API"),startThread:{mode:"START_PRIVATE",submit:E.Z.get("PRIVATE_THREADS_API")},title:gettext("Private threads"),pageLead:gettext("Private threads are threads which only those that started them and those they have invited may see and participate in."),emptyMessage:gettext("You aren't participating in any private threads.")}:{api:e.get("THREADS_API")}}E.Z.addInitializer({name:"component:threads",initializer:function(e){e.has("THREADS")&&e.has("CATEGORIES")&&(0,Je.Z)({paths:Ke(e.get("user"),et(e))})},after:"store"})},7806:(e,t,s)=>{"use strict";var a=s(7785),i=s(2233),o=s(2928),n=s(7294),r=s(9605),l=s(8657),d=s(3904);function c(e){return e.filter((e=>e.results.count>0)).map((e=>Object.assign({},e,{count:e.results.count,results:e.results.results.slice(0,5)})))}var p=s(7462);const u="HEADER",h="RESULT",m="FOOTER";function v(e){let{value:t,onChange:s}=e;return(0,o.Z)("input",{"aria-haspopup":"true","aria-expanded":"false","aria-controls":"dropdown-menu dropdown-search-results",autoComplete:"off",className:"form-control",value:t,onChange:s,placeholder:gettext("Search"),role:"combobox",type:"text"})}function g(e){let{children:t,onChange:s,query:a}=e;return(0,o.Z)("ul",{className:"dropdown-menu dropdown-search-results",role:"menu"},void 0,(0,o.Z)("li",{className:"form-group"},void 0,(0,o.Z)(v,{value:a,onChange:s})),t)}function Z(){return(0,o.Z)("li",{className:"dropdown-search-message"},void 0,gettext("Search returned no results."))}var b,_=s(7848);function f(e){let{message:t}=e;return b||(b=(0,o.Z)("li",{className:"dropdown-search-loader"},void 0,(0,o.Z)(_.Z,{})))}function N(e){let{provider:t,query:s}=e;const a=t.url+"?q="+encodeURI(s),i=ngettext('See full "%(provider)s" results page with %(count)s result.','See full "%(provider)s" results page with %(count)s results.',t.count);return(0,o.Z)("li",{className:"dropdown-search-footer"},void 0,(0,o.Z)("a",{href:a},void 0,interpolate(i,{count:t.count,provider:t.name},!0)))}function x(e){let{provider:t}=e;return(0,o.Z)("li",{className:"dropdown-search-header"},void 0,t.name)}var y,w,k,C=s(381),S=s.n(C),E=s(9755);function L(e){let{result:t}=e;const{poster:s,thread:a}=t,i=gettext("Posted by %(poster)s on %(posted_on)s in %(category)s.");return(0,o.Z)("li",{},void 0,(0,o.Z)("a",{href:t.url.index,className:"dropdown-search-thread"},void 0,(0,o.Z)("h5",{},void 0,a.title),(0,o.Z)("small",{className:"dropdown-search-post-content"},void 0,E(t.content).text()),(0,o.Z)("small",{className:"dropdown-search-post-footer"},void 0,interpolate(i,{category:t.category.name,posted_on:S()(t.posted_on).format("LL"),poster:t.poster_name},!0))))}function T(e){let{result:t}=e;const{rank:s}=t,a=gettext("%(title)s, joined on %(joined_on)s"),i=t.title||s.title||s.name;return(0,o.Z)("li",{},void 0,(0,o.Z)("a",{href:t.url,className:"dropdown-search-user"},void 0,(0,o.Z)("div",{className:"media"},void 0,(0,o.Z)("div",{className:"media-left"},void 0,(0,o.Z)(r.ZP,{size:38,user:t})),(0,o.Z)("div",{className:"media-body"},void 0,(0,o.Z)("h5",{className:"media-heading"},void 0,t.username),(0,o.Z)("small",{},void 0,interpolate(a,{title:i,joined_on:S()(t.joined_on).format("LL")},!0))))))}function P(e){let{provider:t,result:s}=e;return"threads"===t.id?(0,o.Z)(L,{result:s}):(0,o.Z)(T,{result:s})}function O(e){let{provider:t,result:s,type:a,query:i}=e;return a===u?(0,o.Z)(x,{provider:t}):a===m?(0,o.Z)(N,{provider:t,query:i}):(0,o.Z)(P,{provider:t,result:s})}function R(e,t){const s=e.results.length;for(var a=0;a<s;a++){const s=e.results[a];t.push({provider:e,result:s,type:h})}t.push({provider:e,type:m})}function A(e){let{isLoading:t,onChange:s,results:a,query:i}=e;if(!i.trim().length)return(0,o.Z)(g,{onChange:s,query:i});if(a.length){const e=function(e){const t=[];return function(e,t){const s=e.length;for(var a=0;a<s;a++){const s=e[a];t.push({provider:s,type:u}),R(s,t)}}(e,t),t}(a);return(0,o.Z)(g,{onChange:s,query:i},void 0,e.map((e=>{const{type:t,provider:s,result:a}=e;return t===h?n.createElement(O,(0,p.Z)({key:[s.id,t,a.id].join("_")},e)):n.createElement(O,(0,p.Z)({key:[s.id,t].join("_"),query:i},e))})))}return t?(0,o.Z)(g,{onChange:s,query:i},void 0,y||(y=(0,o.Z)(f,{}))):(0,o.Z)(g,{onChange:s,query:i},void 0,w||(w=(0,o.Z)(Z,{})))}const I=class extends n.Component{constructor(){super(),this.state={isLoading:!1,isOpen:!1,query:"",results:[]},this.intervalId=null}componentDidMount(){document.addEventListener("mousedown",this.onDocumentMouseDown),document.addEventListener("keydown",this.onEscape)}componentWillUnmount(){document.removeEventListener("mousedown",this.onDocumentMouseDown),document.removeEventListener("keydown",this.onEscape)}onToggle=e=>{this.setState(((e,t)=>(e.isOpen||window.setTimeout((()=>{this.container.querySelector("input").focus()}),100),{isOpen:!e.isOpen})))};onDocumentMouseDown=e=>{let t=!0,s=e.target;for(;null!==s&&s!==document;){if(s===this.container)return void(t=!1);s=s.parentNode}t&&this.setState({isOpen:!1})};onEscape=e=>{"Escape"===e.key&&this.setState({isOpen:!1})};onChange=e=>{const t=e.target.value;this.setState({query:t}),this.loadResults(t.trim())};loadResults(e){if(!e.length)return;const t=300+300*Math.random();this.intervalId&&window.clearTimeout(this.intervalId),this.setState({isLoading:!0}),this.intervalId=window.setTimeout((()=>{l.Z.get(i.Z.get("SEARCH_API"),{q:e}).then((e=>{this.setState({intervalId:null,isLoading:!1,results:c(e)})}),(e=>{d.Z.apiError(e),this.setState({intervalId:null,isLoading:!1,results:[]})}))}),t)}render(){let e="navbar-search dropdown";return this.state.isOpen&&(e+=" open"),n.createElement("div",{className:e,ref:e=>this.container=e},(0,o.Z)("a",{"aria-haspopup":"true","aria-expanded":"false",className:"navbar-icon","data-toggle":"dropdown",href:i.Z.get("SEARCH_URL"),onClick:this.onToggle},void 0,k||(k=(0,o.Z)("i",{className:"material-icon"},void 0,"search"))),(0,o.Z)(A,{isLoading:this.state.isLoading,onChange:this.onChange,results:this.state.results,query:this.state.query}))}};var D=s(2211),j=s(3345),z=s(6359),U=s(9940);const M=["progress-bar-danger","progress-bar-warning","progress-bar-warning","progress-bar-primary","progress-bar-success"],B=[gettext("Entered password is very weak."),gettext("Entered password is weak."),gettext("Entered password is average."),gettext("Entered password is strong."),gettext("Entered password is very strong.")],q=class extends n.Component{constructor(e){super(e),this._score=0,this._password=null,this._inputs=[],this.state={loaded:!1}}componentDidMount(){U.Z.load().then((()=>{this.setState({loaded:!0})}))}getScore(e,t){let s=!1;return e!==this._password&&(s=!0),t.length!==this._inputs.length?s=!0:t.map(((e,t)=>{e.trim()!==this._inputs[t]&&(s=!0)})),s&&(this._score=U.Z.scorePassword(e,t),this._password=e,this._inputs=t.map((function(e){return e.trim()}))),this._score}render(){if(!this.state.loaded)return null;let e=this.getScore(this.props.password,this.props.inputs);return(0,o.Z)("div",{className:"help-block password-strength"},void 0,(0,o.Z)("div",{className:"progress"},void 0,(0,o.Z)("div",{className:"progress-bar "+M[e],style:{width:20+20*e+"%"},role:"progress-bar","aria-valuenow":e,"aria-valuemin":"0","aria-valuemax":"4"},void 0,(0,o.Z)("span",{className:"sr-only"},void 0,B[e]))),(0,o.Z)("p",{className:"text-small"},void 0,B[e]))}};var H,F,Y,V=s(6106),G=s(7235),$=s(8274),W=s(3825),Q=s(9801),K=s(3051),J=s(5210);class X extends j.Z{constructor(e){super(e);const{username:t,password:s}=this.props.criteria;let a=0;s.forEach((e=>{"MinimumLengthValidator"===e.name&&(a=e.min_length)}));const o={username:[J.lG(),J.HR(t.min_length),J.gS(t.max_length)],email:[J.Do()],password:[J.Vb(a)],captcha:W.ZP.validator()};i.Z.get("TERMS_OF_SERVICE_ID")&&(o.termsOfService=[J.fT()]),i.Z.get("PRIVACY_POLICY_ID")&&(o.privacyPolicy=[J.jA()]),this.state={isLoading:!1,username:"",email:"",password:"",captcha:"",termsOfService:null,privacyPolicy:null,validators:o,errors:{}}}clean(){return!!this.isValid()||(d.Z.error(gettext("Form contains errors.")),this.setState({errors:this.validate()}),!1)}send(){return l.Z.post(i.Z.get("USERS_API"),{username:this.state.username,email:this.state.email,password:this.state.password,captcha:this.state.captcha,terms_of_service:this.state.termsOfService,privacy_policy:this.state.privacyPolicy})}handleSuccess(e){this.props.callback(e)}handleError(e){400===e.status?(this.setState({errors:Object.assign({},this.state.errors,e)}),e.__all__&&e.__all__.length>0?d.Z.error(e.__all__[0]):d.Z.error(gettext("Form contains errors."))):403===e.status&&e.ban?((0,K.Z)(e.ban),Q.Z.hide()):d.Z.apiError(e)}handlePrivacyPolicyChange=e=>{const t=e.target.value;this.handleToggleAgreement("privacyPolicy",t)};handleTermsOfServiceChange=e=>{const t=e.target.value;this.handleToggleAgreement("termsOfService",t)};handleToggleAgreement=(e,t)=>{this.setState(((s,a)=>{if(null===s[e])return{errors:{...s.errors,[e]:null},[e]:t};const i=this.state.validators[e][0];return{errors:{...s.errors,[e]:[i(null)]},[e]:null}}))};render(){return(0,o.Z)("div",{className:"modal-dialog modal-register",role:"document"},void 0,(0,o.Z)("div",{className:"modal-content"},void 0,(0,o.Z)("div",{className:"modal-header"},void 0,(0,o.Z)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":pgettext("modal","Close")},void 0,H||(H=(0,o.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,o.Z)("h4",{className:"modal-title"},void 0,gettext("Register"))),(0,o.Z)("form",{onSubmit:this.handleSubmit},void 0,(0,o.Z)("input",{type:"type",style:{display:"none"}}),(0,o.Z)("input",{type:"password",style:{display:"none"}}),(0,o.Z)("div",{className:"modal-body"},void 0,(0,o.Z)(G.Z,{buttonClassName:"col-xs-12 col-sm-6",buttonLabel:gettext("Join with %(site)s"),formLabel:gettext("Or create forum account:")}),(0,o.Z)(z.Z,{label:gettext("Username"),for:"id_username",validation:this.state.errors.username},void 0,(0,o.Z)("input",{type:"text",id:"id_username",className:"form-control","aria-describedby":"id_username_status",disabled:this.state.isLoading,onChange:this.bindInput("username"),value:this.state.username})),(0,o.Z)(z.Z,{label:gettext("E-mail"),for:"id_email",validation:this.state.errors.email},void 0,(0,o.Z)("input",{type:"text",id:"id_email",className:"form-control","aria-describedby":"id_email_status",disabled:this.state.isLoading,onChange:this.bindInput("email"),value:this.state.email})),(0,o.Z)(z.Z,{label:gettext("Password"),for:"id_password",validation:this.state.errors.password,extra:(0,o.Z)(q,{password:this.state.password,inputs:[this.state.username,this.state.email]})},void 0,(0,o.Z)("input",{type:"password",id:"id_password",className:"form-control","aria-describedby":"id_password_status",disabled:this.state.isLoading,onChange:this.bindInput("password"),value:this.state.password})),W.ZP.component({form:this}),(0,o.Z)(V.Z,{errors:this.state.errors,privacyPolicy:this.state.privacyPolicy,termsOfService:this.state.termsOfService,onPrivacyPolicyChange:this.handlePrivacyPolicyChange,onTermsOfServiceChange:this.handleTermsOfServiceChange})),(0,o.Z)("div",{className:"modal-footer"},void 0,(0,o.Z)("button",{className:"btn btn-default","data-dismiss":"modal",disabled:this.state.isLoading,type:"button"},void 0,gettext("Cancel")),(0,o.Z)(D.Z,{className:"btn-primary",loading:this.state.isLoading},void 0,gettext("Register account"))))))}}class ee extends n.Component{getLead(){return"user"===this.props.activation?gettext("%(username)s, your account has been created but you need to activate it before you will be able to sign in."):"admin"===this.props.activation?gettext("%(username)s, your account has been created but board administrator will have to activate it before you will be able to sign in."):void 0}getSubscript(){return"user"===this.props.activation?gettext("We have sent an e-mail to %(email)s with link that you have to click to activate your account."):"admin"===this.props.activation?gettext("We will send an e-mail to %(email)s when this takes place."):void 0}render(){return(0,o.Z)("div",{className:"modal-dialog modal-message modal-register",role:"document"},void 0,(0,o.Z)("div",{className:"modal-content"},void 0,(0,o.Z)("div",{className:"modal-header"},void 0,(0,o.Z)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":pgettext("modal","Close")},void 0,F||(F=(0,o.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,o.Z)("h4",{className:"modal-title"},void 0,gettext("Registration complete"))),(0,o.Z)("div",{className:"modal-body"},void 0,Y||(Y=(0,o.Z)("div",{className:"message-icon"},void 0,(0,o.Z)("span",{className:"material-icon"},void 0,"info_outline"))),(0,o.Z)("div",{className:"message-body"},void 0,(0,o.Z)("p",{className:"lead"},void 0,interpolate(this.getLead(),{username:this.props.username},!0)),(0,o.Z)("p",{},void 0,interpolate(this.getSubscript(),{email:this.props.email},!0)),(0,o.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,gettext("Ok"))))))}}const te=class extends n.Component{constructor(e){super(e),this.state={complete:!1}}completeRegistration=e=>{"active"===e.activation?(Q.Z.hide(),$.Z.signIn(e)):this.setState({complete:e})};render(){return this.state.complete?(0,o.Z)(ee,{activation:this.state.complete.activation,email:this.state.complete.email,username:this.state.complete.username}):n.createElement(X,(0,p.Z)({callback:this.completeRegistration},this.props))}};var se;const ae=class extends n.Component{constructor(e){super(e),this.state={isLoading:!1,isLoaded:!1,criteria:null}}showRegisterForm=()=>{"closed"===misago.get("SETTINGS").account_activation?d.Z.info(gettext("New registrations are currently disabled.")):this.state.isLoaded?Q.Z.show((0,o.Z)(te,{criteria:this.state.criteria})):(this.setState({isLoading:!0}),Promise.all([W.ZP.load(),l.Z.get(misago.get("AUTH_CRITERIA_API"))]).then((e=>{this.setState({isLoading:!1,isLoaded:!0,criteria:e[1]}),Q.Z.show((0,o.Z)(te,{criteria:e[1]}))}),(()=>{this.setState({isLoading:!1}),d.Z.error(gettext("Registration is currently unavailable due to an error."))})))};getClassName(){return this.props.className+(this.state.isLoading?" btn-loading":"")}render(){return(0,o.Z)("button",{className:"btn "+this.getClassName(),disabled:this.state.isLoading,onClick:this.showRegisterForm,type:"button"},void 0,gettext("Register"),this.state.isLoading?se||(se=(0,o.Z)(_.Z,{})):null)}};var ie,oe,ne,re,le=s(4467),de=s(8621);class ce extends n.Component{showSignInModal(){Q.Z.show(le.Z)}componentDidMount(){"login"===new URLSearchParams(window.location.search).get("modal")&&window.setTimeout(this.showSignInModal,500)}render(){const e=i.Z.get("SETTINGS").DELEGATE_AUTH;return(0,o.Z)("ul",{className:"dropdown-menu user-dropdown dropdown-menu-right",role:"menu"},void 0,(0,o.Z)("li",{className:"guest-preview"},void 0,(0,o.Z)("h4",{},void 0,gettext("You are browsing as guest.")),(0,o.Z)("p",{},void 0,gettext("Sign in or register to start and participate in discussions.")),e?(0,o.Z)("div",{className:"row"},void 0,(0,o.Z)("div",{className:"col-xs-12"},void 0,(0,o.Z)("a",{className:"btn btn-default btn-sign-in btn-block",href:i.Z.get("SETTINGS").LOGIN_URL},void 0,gettext("Sign in")))):(0,o.Z)("div",{className:"row"},void 0,(0,o.Z)("div",{className:"col-xs-6"},void 0,(0,o.Z)("button",{className:"btn btn-default btn-sign-in btn-block",onClick:this.showSignInModal,type:"button"},void 0,gettext("Sign in"))),(0,o.Z)("div",{className:"col-xs-6"},void 0,(0,o.Z)(ae,{className:"btn-primary btn-register btn-block"},void 0,gettext("Register"))))))}}class pe extends ce{render(){return i.Z.get("SETTINGS").DELEGATE_AUTH?(0,o.Z)("div",{className:"nav nav-guest"},void 0,(0,o.Z)("a",{className:"btn navbar-btn btn-default btn-sign-in",href:i.Z.get("SETTINGS").LOGIN_URL},void 0,gettext("Sign in")),ie||(ie=(0,o.Z)("div",{className:"navbar-left"},void 0,(0,o.Z)(I,{})))):(0,o.Z)("div",{className:"nav nav-guest"},void 0,(0,o.Z)("button",{className:"btn navbar-btn btn-default btn-sign-in",onClick:this.showSignInModal,type:"button"},void 0,gettext("Sign in")),(0,o.Z)(ae,{className:"navbar-btn btn-primary btn-register"},void 0,gettext("Register")),oe||(oe=(0,o.Z)("div",{className:"navbar-left"},void 0,(0,o.Z)(I,{}))))}}class ue extends n.Component{showGuestMenu(){de.Z.show(ce)}render(){return(0,o.Z)("button",{type:"button",onClick:this.showGuestMenu},void 0,ne||(ne=(0,o.Z)(r.ZP,{size:"64"})))}}const he=class extends n.Component{constructor(e){super(e),this.state={isLoading:!1}}callApi(e){if(this.state.isLoading)return!1;this.setState({isLoading:!0}),l.Z.post(this.props.user.api.avatar,{avatar:e}).then((e=>{this.setState({isLoading:!1}),d.Z.success(e.detail),this.props.onComplete(e)}),(e=>{400===e.status?(d.Z.error(e.detail),this.setState({isLoading:!1})):this.props.showError(e)}))}setGravatar=()=>{this.callApi("gravatar")};setGenerated=()=>{this.callApi("generated")};getGravatarButton(){return this.props.options.gravatar?(0,o.Z)(D.Z,{onClick:this.setGravatar,disabled:this.state.isLoading,className:"btn-default btn-block btn-avatar-gravatar"},void 0,gettext("Download my Gravatar")):null}getCropButton(){return this.props.options.crop_src?(0,o.Z)(D.Z,{className:"btn-default btn-block btn-avatar-crop",disabled:this.state.isLoading,onClick:this.props.showCrop},void 0,gettext("Re-crop uploaded image")):null}getUploadButton(){return this.props.options.upload?(0,o.Z)(D.Z,{className:"btn-default btn-block btn-avatar-upload",disabled:this.state.isLoading,onClick:this.props.showUpload},void 0,gettext("Upload new image")):null}getGalleryButton(){return this.props.options.galleries?(0,o.Z)(D.Z,{className:"btn-default btn-block btn-avatar-gallery",disabled:this.state.isLoading,onClick:this.props.showGallery},void 0,gettext("Pick avatar from gallery")):null}getAvatarPreview(){let e={id:this.props.user.id,avatars:this.props.options.avatars};return this.state.isLoading?(0,o.Z)("div",{className:"avatar-preview preview-loading"},void 0,(0,o.Z)(r.ZP,{size:"200",user:e}),re||(re=(0,o.Z)(_.Z,{}))):(0,o.Z)("div",{className:"avatar-preview"},void 0,(0,o.Z)(r.ZP,{size:"200",user:e}))}render(){return(0,o.Z)("div",{className:"modal-body modal-avatar-index"},void 0,(0,o.Z)("div",{className:"row"},void 0,(0,o.Z)("div",{className:"col-md-5"},void 0,this.getAvatarPreview()),(0,o.Z)("div",{className:"col-md-7"},void 0,this.getGravatarButton(),(0,o.Z)(D.Z,{onClick:this.setGenerated,disabled:this.state.isLoading,className:"btn-default btn-block btn-avatar-generate"},void 0,gettext("Generate my individual avatar")),this.getCropButton(),this.getUploadButton(),this.getGalleryButton())))}};var me,ve=s(9755);const ge=class extends n.Component{constructor(e){super(e),this.state={isLoading:!1,deviceRatio:1}}getAvatarSize(){return this.props.upload?this.props.options.crop_tmp.size:this.props.options.crop_src.size}getImagePath(){return this.props.upload?this.props.dataUrl:this.props.options.crop_src.url}componentDidMount(){let e=ve(".crop-form"),t=this.getAvatarSize();const s=e.width();for(;s<t;)t/=2;const a=this.getAvatarSize()/t;e.width(t),e.cropit({width:t,height:t,exportZoom:a,imageState:{src:this.getImagePath()},onImageLoaded:()=>{if(this.props.upload){let t=e.cropit("zoom"),s=e.cropit("imageSize");if(s.width>s.height){let a=(s.width*t-this.getAvatarSize())/-2;e.cropit("offset",{x:a,y:0})}else if(s.width<s.height){let a=(s.height*t-this.getAvatarSize())/-2;e.cropit("offset",{x:0,y:a})}else e.cropit("offset",{x:0,y:0})}else{let t=this.props.options.crop_src.crop;t&&(e.cropit("zoom",t.zoom),e.cropit("offset",{x:t.x,y:t.y}))}}})}componentWillUnmount(){ve(".crop-form").cropit("disable")}cropAvatar=()=>{if(this.state.isLoading)return!1;this.setState({isLoading:!0});let e=this.props.upload?"crop_tmp":"crop_src",t=ve(".crop-form");const s=t.cropit("exportZoom"),a=t.cropit("offset");l.Z.post(this.props.user.api.avatar,{avatar:e,crop:{offset:{x:a.x*s,y:a.y*s},zoom:t.cropit("zoom")*s}}).then((e=>{this.props.onComplete(e),d.Z.success(e.detail)}),(e=>{400===e.status?(d.Z.error(e.detail),this.setState({isLoading:!1})):this.props.showError(e)}))};render(){return(0,o.Z)("div",{},void 0,me||(me=(0,o.Z)("div",{className:"modal-body modal-avatar-crop"},void 0,(0,o.Z)("div",{className:"crop-form"},void 0,(0,o.Z)("div",{className:"cropit-preview"}),(0,o.Z)("input",{type:"range",className:"cropit-image-zoom-input"})))),(0,o.Z)("div",{className:"modal-footer"},void 0,(0,o.Z)("div",{className:"col-md-6 col-md-offset-3"},void 0,(0,o.Z)(D.Z,{onClick:this.cropAvatar,loading:this.state.isLoading,className:"btn-primary btn-block"},void 0,this.props.upload?gettext("Set avatar"):gettext("Crop image")),(0,o.Z)(D.Z,{onClick:this.props.showIndex,disabled:this.state.isLoading,className:"btn-default btn-block"},void 0,gettext("Cancel")))))}};var Ze,be=s(8772);const _e=class extends n.Component{constructor(e){super(e),this.state={image:null,preview:null,progress:0,uploaded:null,dataUrl:null}}validateFile(e){if(e.size>this.props.options.upload.limit)return interpolate(gettext("Selected file is too big. (%(filesize)s)"),{filesize:(0,be.Z)(e.size)},!0);let t=gettext("Selected file type is not supported.");if(-1===this.props.options.upload.allowed_mime_types.indexOf(e.type))return t;let s=!1,a=e.name.toLowerCase();return this.props.options.upload.allowed_extensions.map((function(e){a.substr(-1*e.length)===e&&(s=!0)})),!s&&t}pickFile=()=>{document.getElementById("avatar-hidden-upload").click()};uploadFile=()=>{let e=document.getElementById("avatar-hidden-upload").files[0];if(!e)return;let t=this.validateFile(e);if(t)return void d.Z.error(t);this.setState({image:e,preview:URL.createObjectURL(e),progress:0});let s=new FormData;s.append("avatar","upload"),s.append("image",e),l.Z.upload(this.props.user.api.avatar,s,(e=>{this.setState({progress:e})})).then((e=>{this.setState({options:e,uploaded:e.detail}),d.Z.info(gettext("Your image has been uploaded and you may now crop it."))}),(e=>{400===e.status||413===e.status?(d.Z.error(e.detail),this.setState({isLoading:!1,image:null,progress:0})):this.props.showError(e)}))};getUploadRequirements(e){let t=e.allowed_extensions.map((function(e){return e.substr(1)}));return interpolate(gettext("%(files)s files smaller than %(limit)s"),{files:t.join(", "),limit:(0,be.Z)(e.limit)},!0)}getUploadButton(){return(0,o.Z)("div",{className:"modal-body modal-avatar-upload"},void 0,(0,o.Z)(D.Z,{className:"btn-pick-file",onClick:this.pickFile},void 0,Ze||(Ze=(0,o.Z)("div",{className:"material-icon"},void 0,"input")),gettext("Select file")),(0,o.Z)("p",{className:"text-muted"},void 0,this.getUploadRequirements(this.props.options.upload)))}getUploadProgressLabel(){return interpolate(gettext("%(progress)s % complete"),{progress:this.state.progress},!0)}getUploadProgress(){return(0,o.Z)("div",{className:"modal-body modal-avatar-upload"},void 0,(0,o.Z)("div",{className:"upload-progress"},void 0,(0,o.Z)("img",{src:this.state.preview}),(0,o.Z)("div",{className:"progress"},void 0,(0,o.Z)("div",{className:"progress-bar",role:"progressbar","aria-valuenow":"{this.state.progress}","aria-valuemin":"0","aria-valuemax":"100",style:{width:this.state.progress+"%"}},void 0,(0,o.Z)("span",{className:"sr-only"},void 0,this.getUploadProgressLabel())))))}renderUpload(){return(0,o.Z)("div",{},void 0,(0,o.Z)("input",{type:"file",id:"avatar-hidden-upload",className:"hidden-file-upload",onChange:this.uploadFile}),this.state.image?this.getUploadProgress():this.getUploadButton(),(0,o.Z)("div",{className:"modal-footer"},void 0,(0,o.Z)("div",{className:"col-md-6 col-md-offset-3"},void 0,(0,o.Z)(D.Z,{onClick:this.props.showIndex,disabled:!!this.state.image,className:"btn-default btn-block"},void 0,gettext("Cancel")))))}renderCrop(){return(0,o.Z)(ge,{options:this.state.options,user:this.props.user,upload:this.state.uploaded,dataUrl:this.state.preview,onComplete:this.props.onComplete,showError:this.props.showError,showIndex:this.props.showIndex})}render(){return this.state.uploaded?this.renderCrop():this.renderUpload()}};var fe,Ne=s(9130);class xe extends n.Component{select=()=>{this.props.select(this.props.id)};getClassName(){return this.props.selection===this.props.id?this.props.disabled?"btn btn-avatar btn-disabled avatar-selected":"btn btn-avatar avatar-selected":this.props.disabled?"btn btn-avatar btn-disabled":"btn btn-avatar"}render(){return(0,o.Z)("button",{type:"button",className:this.getClassName(),disabled:this.props.disabled,onClick:this.select},void 0,(0,o.Z)("img",{src:this.props.url}))}}class ye extends n.Component{render(){return(0,o.Z)("div",{className:"avatars-gallery"},void 0,(0,o.Z)("h3",{},void 0,this.props.name),(0,o.Z)("div",{className:"avatars-gallery-images"},void 0,(0,Ne.Z)(this.props.images,4,null).map(((e,t)=>(0,o.Z)("div",{className:"row"},t,e.map(((e,t)=>(0,o.Z)("div",{className:"col-xs-3"},t,e?n.createElement(xe,(0,p.Z)({disabled:this.props.disabled,select:this.props.select,selection:this.props.selection},e)):fe||(fe=(0,o.Z)("div",{className:"blank-avatar"}))))))))))}}const we=class extends n.Component{constructor(e){super(e),this.state={selection:null,isLoading:!1}}select=e=>{this.setState({selection:e})};save=()=>{if(this.state.isLoading)return!1;this.setState({isLoading:!0}),l.Z.post(this.props.user.api.avatar,{avatar:"galleries",image:this.state.selection}).then((e=>{this.setState({isLoading:!1}),d.Z.success(e.detail),this.props.onComplete(e),this.props.showIndex()}),(e=>{400===e.status?(d.Z.error(e.detail),this.setState({isLoading:!1})):this.props.showError(e)}))};render(){return(0,o.Z)("div",{},void 0,(0,o.Z)("div",{className:"modal-body modal-avatar-gallery"},void 0,this.props.options.galleries.map(((e,t)=>(0,o.Z)(ye,{name:e.name,images:e.images,selection:this.state.selection,disabled:this.state.isLoading,select:this.select},t)))),(0,o.Z)("div",{className:"modal-footer"},void 0,(0,o.Z)("div",{className:"row"},void 0,(0,o.Z)("div",{className:"col-md-6 col-md-offset-3"},void 0,(0,o.Z)(D.Z,{onClick:this.save,loading:this.state.isLoading,disabled:!this.state.selection,className:"btn-primary btn-block"},void 0,this.state.selection?gettext("Save choice"):gettext("Select avatar")),(0,o.Z)(D.Z,{onClick:this.props.showIndex,disabled:this.state.isLoading,className:"btn-default btn-block"},void 0,gettext("Cancel"))))))}};var ke,Ce,Se,Ee=s(3784),Le=s(6935),Te=s(287);class Pe extends n.Component{getErrorReason(){return this.props.reason?(0,o.Z)("p",{dangerouslySetInnerHTML:{__html:this.props.reason}}):null}render(){return(0,o.Z)("div",{className:"modal-body"},void 0,ke||(ke=(0,o.Z)("div",{className:"message-icon"},void 0,(0,o.Z)("span",{className:"material-icon"},void 0,"remove_circle_outline"))),(0,o.Z)("div",{className:"message-body"},void 0,(0,o.Z)("p",{className:"lead"},void 0,this.props.message),this.getErrorReason(),(0,o.Z)("button",{className:"btn btn-default","data-dismiss":"modal",type:"button"},void 0,gettext("Ok"))))}}const Oe=class extends n.Component{componentDidMount(){l.Z.get(this.props.user.api.avatar).then((e=>{this.setState({component:he,options:e,error:null})}),(e=>{this.showError(e)}))}showError=e=>{this.setState({error:e})};showIndex=()=>{this.setState({component:he})};showUpload=()=>{this.setState({component:_e})};showCrop=()=>{this.setState({component:ge})};showGallery=()=>{this.setState({component:we})};completeFlow=e=>{Te.Z.dispatch((0,Le.n1)(this.props.user,e.avatars)),this.setState({component:he,options:e})};getBody(){return this.state?this.state.error?(0,o.Z)(Pe,{message:this.state.error.detail,reason:this.state.error.reason}):(0,o.Z)(this.state.component,{options:this.state.options,user:this.props.user,onComplete:this.completeFlow,showError:this.showError,showIndex:this.showIndex,showCrop:this.showCrop,showUpload:this.showUpload,showGallery:this.showGallery}):Ce||(Ce=(0,o.Z)(Ee.Z,{}))}getClassName(){return this.state&&this.state.error?"modal-dialog modal-message modal-change-avatar":"modal-dialog modal-change-avatar"}render(){return(0,o.Z)("div",{className:this.getClassName(),role:"document"},void 0,(0,o.Z)("div",{className:"modal-content"},void 0,(0,o.Z)("div",{className:"modal-header"},void 0,(0,o.Z)("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":pgettext("modal","Close")},void 0,Se||(Se=(0,o.Z)("span",{"aria-hidden":"true"},void 0,"×"))),(0,o.Z)("h4",{className:"modal-title"},void 0,gettext("Change your avatar"))),this.getBody()))}};function Re(e){return{user:e.auth.user}}var Ae,Ie,De,je,ze,Ue,Me,Be,qe,He,Fe,Ye,Ve,Ge;class $e extends n.Component{changeAvatar(){Q.Z.show((0,a.$j)(Re)(Oe))}render(){const{user:e}=this.props;return(0,o.Z)("ul",{className:"dropdown-menu user-dropdown dropdown-menu-right",role:"menu"},void 0,(0,o.Z)("li",{className:"dropdown-header"},void 0,(0,o.Z)("strong",{},void 0,e.username),(0,o.Z)("div",{className:"row user-stats"},void 0,(0,o.Z)("div",{className:"col-sm-3"},void 0,Ae||(Ae=(0,o.Z)("span",{className:"material-icon"},void 0,"message")),e.posts),(0,o.Z)("div",{className:"col-sm-3"},void 0,Ie||(Ie=(0,o.Z)("span",{className:"material-icon"},void 0,"forum")),e.threads),(0,o.Z)("div",{className:"col-sm-3"},void 0,De||(De=(0,o.Z)("span",{className:"material-icon"},void 0,"favorite")),e.followers),(0,o.Z)("div",{className:"col-sm-3"},void 0,je||(je=(0,o.Z)("span",{className:"material-icon"},void 0,"favorite_outline")),e.following))),ze||(ze=(0,o.Z)("li",{className:"divider"})),(0,o.Z)("li",{},void 0,(0,o.Z)("a",{href:e.url},void 0,Ue||(Ue=(0,o.Z)("span",{className:"material-icon"},void 0,"account_circle")),gettext("See your profile"))),(0,o.Z)("li",{},void 0,(0,o.Z)("a",{href:i.Z.get("USERCP_URL")},void 0,Me||(Me=(0,o.Z)("span",{className:"material-icon"},void 0,"done_all")),gettext("Change options"))),(0,o.Z)("li",{},void 0,(0,o.Z)("button",{className:"btn-link",onClick:this.changeAvatar,type:"button"},void 0,Be||(Be=(0,o.Z)("span",{className:"material-icon"},void 0,"portrait")),gettext("Change avatar"))),!!e.acl.can_use_private_threads&&(0,o.Z)("li",{},void 0,(0,o.Z)("a",{href:i.Z.get("PRIVATE_THREADS_URL")},void 0,qe||(qe=(0,o.Z)("span",{className:"material-icon"},void 0,"message")),gettext("Private threads"),(0,o.Z)(We,{user:e}))),He||(He=(0,o.Z)("li",{className:"divider"})),(0,o.Z)("li",{className:"dropdown-buttons"},void 0,(0,o.Z)("button",{className:"btn btn-default btn-block",onClick:()=>document.getElementById("hidden-logout-form").submit(),type:"button"},void 0,gettext("Log out"))))}}function We(e){let{user:t}=e;return t.unread_private_threads?(0,o.Z)("span",{className:"badge"},void 0,t.unread_private_threads):null}function Qe(e){let{user:t}=e;return(0,o.Z)("ul",{className:"ul nav navbar-nav nav-user"},void 0,Fe||(Fe=(0,o.Z)("li",{},void 0,(0,o.Z)(I,{}))),(0,o.Z)(Ke,{user:t}),(0,o.Z)("li",{className:"dropdown"},void 0,(0,o.Z)("a",{"aria-haspopup":"true","aria-expanded":"false",className:"dropdown-toggle","data-toggle":"dropdown",href:t.url,role:"button"},void 0,(0,o.Z)(r.ZP,{user:t,size:"64"})),(0,o.Z)($e,{user:t})))}function Ke(e){let{user:t}=e;if(!t.acl.can_use_private_threads)return null;let s=null;return s=t.unread_private_threads?gettext("You have unread private threads!"):gettext("Private threads"),(0,o.Z)("li",{},void 0,(0,o.Z)("a",{className:"navbar-icon",href:i.Z.get("PRIVATE_THREADS_URL"),title:s},void 0,Ye||(Ye=(0,o.Z)("span",{className:"material-icon"},void 0,"message")),t.unread_private_threads>0&&(0,o.Z)("span",{className:"badge"},void 0,t.unread_private_threads)))}function Je(e){return{user:e.auth.user}}class Xe extends n.Component{showUserMenu(){de.Z.showConnected("user-menu",(0,a.$j)(Je)($e))}render(){return(0,o.Z)("button",{type:"button",onClick:this.showUserMenu},void 0,(0,o.Z)(r.ZP,{user:this.props.user,size:"50"}))}}class et extends n.Component{render(){return this.props.isAuthenticated?(0,o.Z)(Qe,{user:this.props.user}):Ve||(Ve=(0,o.Z)(pe,{}))}}class tt extends n.Component{render(){return this.props.isAuthenticated?(0,o.Z)(Xe,{user:this.props.user}):Ge||(Ge=(0,o.Z)(ue,{}))}}function st(e){return e.auth}var at=s(4869);i.Z.addInitializer({name:"component:user-menu",initializer:function(){(0,at.Z)((0,a.$j)(st)(et),"user-menu-mount"),(0,at.Z)((0,a.$j)(st)(tt),"user-menu-compact-mount")},after:"store"})},7031:(e,t,s)=>{"use strict";var a,i=s(2928),o=s(7294),n=s(7785),r=s(905),l=s(9655),d=s(4417);const c=(e,t)=>{let s=e;return"rank"===t.component?s+=t.slug:s+=t.component,s+"/"},p=e=>{let{baseUrl:t,page:s,pages:o}=e;return(0,i.Z)("div",{className:"nav-container"},void 0,(0,i.Z)("div",{className:"dropdown hidden-sm hidden-md hidden-lg"},void 0,(0,i.Z)("button",{className:"btn btn-default btn-block btn-outline dropdown-toggle",type:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},void 0,a||(a=(0,i.Z)("span",{className:"material-icon"},void 0,"menu")),s.name),(0,i.Z)("ul",{className:"dropdown-menu stick-to-bottom"},void 0,o.map((e=>{const s=c(t,e);return(0,i.Z)("li",{},s,(0,i.Z)(l.rU,{to:s},void 0,e.name))})))),(0,i.Z)("ul",{className:"nav nav-pills hidden-xs",role:"menu"},void 0,o.map((e=>{const s=c(t,e);return(0,i.Z)(d.Z,{path:s},s,(0,i.Z)(l.rU,{to:s},void 0,e.name))}))))},u=class extends o.Component{getEmptyMessage(){return interpolate(gettext("No users have posted any new messages during last %(days)s days."),{days:this.props.trackedPeriod},!0)}render(){return(0,i.Z)("div",{className:"active-posters-list"},void 0,(0,i.Z)(r.Z,{},void 0,(0,i.Z)(p,{baseUrl:misago.get("USERS_LIST_URL"),page:this.props.page,pages:misago.get("USERS_LISTS")}),(0,i.Z)("p",{className:"lead"},void 0,this.getEmptyMessage())))}};var h,m,v=s(9605),g=s(4039);const Z=class extends o.Component{shouldComponentUpdate(){return!1}getClassName(){return this.props.hiddenOnMobile?"list-group-item hidden-xs hidden-sm":"list-group-item"}render(){return(0,i.Z)("li",{className:this.getClassName()},void 0,h||(h=(0,i.Z)("div",{className:"rank-user-avatar"},void 0,(0,i.Z)("span",{},void 0,(0,i.Z)(v.ZP,{size:"50"})))),(0,i.Z)("div",{className:"rank-user"},void 0,(0,i.Z)("div",{className:"user-name"},void 0,(0,i.Z)("span",{className:"item-title"},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:g.e(30,80)+"px"}},void 0," "))),(0,i.Z)("div",{className:"user-details"},void 0,(0,i.Z)("span",{className:"user-status"},void 0,m||(m=(0,i.Z)("span",{className:"status-icon ui-preview-text"},void 0," ")),(0,i.Z)("span",{className:"status-label ui-preview-text hidden-xs hidden-sm",style:{width:g.e(30,50)+"px"}},void 0," ")),(0,i.Z)("span",{className:"rank-name"},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:g.e(30,50)+"px"}},void 0," ")),(0,i.Z)("span",{className:"user-title hidden-xs hidden-sm"},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:g.e(30,50)+"px"}},void 0," "))),(0,i.Z)("div",{className:"user-compact-stats visible-xs-block"},void 0,(0,i.Z)("span",{className:"rank-position"},void 0,(0,i.Z)("strong",{},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:g.e(20,30)+"px"}},void 0," ")),(0,i.Z)("small",{},void 0,gettext("Rank"))),(0,i.Z)("span",{className:"rank-posts-counted"},void 0,(0,i.Z)("strong",{},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:g.e(20,30)+"px"}},void 0," ")),(0,i.Z)("small",{},void 0,gettext("Ranked posts"))))),(0,i.Z)("div",{className:"rank-position hidden-xs"},void 0,(0,i.Z)("strong",{},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:g.e(20,30)+"px"}},void 0," ")),(0,i.Z)("small",{},void 0,gettext("Rank"))),(0,i.Z)("div",{className:"rank-posts-counted hidden-xs"},void 0,(0,i.Z)("strong",{},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:g.e(20,30)+"px"}},void 0," ")),(0,i.Z)("small",{},void 0,gettext("Ranked posts"))),(0,i.Z)("div",{className:"rank-posts-total hidden-xs"},void 0,(0,i.Z)("strong",{},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:g.e(20,30)+"px"}},void 0," ")),(0,i.Z)("small",{},void 0,gettext("Total posts"))))}},b=class extends o.Component{shouldComponentUpdate(){return!1}render(){return(0,i.Z)("div",{className:"active-posters-list"},void 0,(0,i.Z)(r.Z,{},void 0,(0,i.Z)(p,{baseUrl:misago.get("USERS_LIST_URL"),page:this.props.page,pages:misago.get("USERS_LISTS")}),(0,i.Z)("p",{className:"lead ui-preview"},void 0,(0,i.Z)("span",{className:"ui-preview-text",style:{width:g.e(50,220)+"px"}},void 0," ")),(0,i.Z)("div",{className:"active-posters ui-preview"},void 0,(0,i.Z)("ul",{className:"list-group"},void 0,[0,1,2].map((e=>(0,i.Z)(Z,{hiddenOnMobile:e>0},e)))))))}};var _,f=s(4678),N=s(2233);const x=class extends o.Component{getClassName(){return this.props.rank.css_class?"list-group-item list-group-rank-"+this.props.rank.css_class:"list-group-item"}getUserStatus(){return this.props.user.status?(0,i.Z)(f.ZP,{user:this.props.user,status:this.props.user.status},void 0,(0,i.Z)(f.Jj,{user:this.props.user,status:this.props.user.status}),(0,i.Z)(f.pg,{user:this.props.user,status:this.props.user.status,className:"status-label hidden-xs hidden-sm"})):(0,i.Z)("span",{className:"user-status"},void 0,_||(_=(0,i.Z)("span",{className:"status-icon ui-preview-text"},void 0," ")),(0,i.Z)("span",{className:"status-label ui-preview-text hidden-xs hidden-sm",style:{width:g.e(30,50)+"px"}},void 0," "))}getRankName(){if(!this.props.rank.is_tab)return(0,i.Z)("span",{className:"rank-name item-title"},void 0,this.props.rank.name);let e=N.Z.get("USERS_LIST_URL")+this.props.rank.slug+"/";return(0,i.Z)(l.rU,{to:e,className:"rank-name item-title"},void 0,this.props.rank.name)}getUserTitle(){return this.props.user.title?(0,i.Z)("span",{className:"user-title hidden-xs hidden-sm"},void 0,this.props.user.title):null}render(){return(0,i.Z)("li",{className:this.getClassName()},void 0,(0,i.Z)("div",{className:"rank-user-avatar"},void 0,(0,i.Z)("a",{href:this.props.user.url},void 0,(0,i.Z)(v.ZP,{user:this.props.user,size:50,size2x:64}))),(0,i.Z)("div",{className:"rank-user"},void 0,(0,i.Z)("div",{className:"user-name"},void 0,(0,i.Z)("a",{href:this.props.user.url,className:"item-title"},void 0,this.props.user.username)),(0,i.Z)("div",{className:"user-details"},void 0,this.getUserStatus(),this.getRankName(),this.getUserTitle()),(0,i.Z)("div",{className:"user-compact-stats visible-xs-block"},void 0,(0,i.Z)("span",{className:"rank-position"},void 0,(0,i.Z)("strong",{},void 0,"#",this.props.counter),(0,i.Z)("small",{},void 0,gettext("Rank"))),(0,i.Z)("span",{className:"rank-posts-counted"},void 0,(0,i.Z)("strong",{},void 0,this.props.user.meta.score),(0,i.Z)("small",{},void 0,gettext("Ranked posts"))))),(0,i.Z)("div",{className:"rank-position hidden-xs"},void 0,(0,i.Z)("strong",{},void 0,"#",this.props.counter),(0,i.Z)("small",{},void 0,gettext("Rank"))),(0,i.Z)("div",{className:"rank-posts-counted hidden-xs"},void 0,(0,i.Z)("strong",{},void 0,this.props.user.meta.score),(0,i.Z)("small",{},void 0,gettext("Ranked posts"))),(0,i.Z)("div",{className:"rank-posts-total hidden-xs"},void 0,(0,i.Z)("strong",{},void 0,this.props.user.posts),(0,i.Z)("small",{},void 0,gettext("Total posts"))))}},y=class extends o.Component{getLeadMessage(){let e=ngettext("%(posters)s top poster from last %(days)s days.","%(posters)s top posters from last %(days)s days.",this.props.count);return interpolate(e,{posters:this.props.count,days:this.props.trackedPeriod},!0)}render(){return(0,i.Z)("div",{className:"active-posters-list"},void 0,(0,i.Z)(r.Z,{},void 0,(0,i.Z)(p,{baseUrl:misago.get("USERS_LIST_URL"),page:this.props.page,pages:misago.get("USERS_LISTS")}),(0,i.Z)("p",{className:"lead"},void 0,this.getLeadMessage()),(0,i.Z)("div",{className:"active-posters ui-ready"},void 0,(0,i.Z)("ul",{className:"list-group"},void 0,this.props.users.map(((e,t)=>(0,i.Z)(x,{user:e,rank:e.rank,counter:t+1},e.id)))))))}};var w=s(6935),k=s(5547),C=s(287),S=s(3328);const E=class extends o.Component{constructor(e){super(e),N.Z.has("USERS")?this.initWithPreloadedData(N.Z.pop("USERS")):this.initWithoutPreloadedData(),this.startPolling()}initWithPreloadedData(e){this.state={isLoaded:!0,trackedPeriod:e.tracked_period,count:e.count},C.Z.dispatch((0,w.ZB)(e.results))}initWithoutPreloadedData(){this.state={isLoaded:!1}}startPolling(){k.Z.start({poll:"active-posters",url:N.Z.get("USERS_API"),data:{list:"active"},frequency:9e4,update:this.update})}update=e=>{C.Z.dispatch((0,w.ZB)(e.results)),this.setState({isLoaded:!0,trackedPeriod:e.tracked_period,count:e.count})};componentDidMount(){S.Z.set({title:this.props.route.extra.name,parent:gettext("Users")})}componentWillUnmount(){k.Z.stop("active-posters")}render(){const e={name:this.props.route.extra.name};return this.state.isLoaded?this.state.count>0?(0,i.Z)(y,{page:e,users:this.props.users,trackedPeriod:this.state.trackedPeriod,count:this.state.count}):(0,i.Z)(u,{page:e,trackedPeriod:this.state.trackedPeriod}):(0,i.Z)(b,{page:e})}},L=class extends o.Component{getClassName(){return this.props.copy&&this.props.copy.length&&1===function(e,t){if(e=(e+"").toLowerCase(),(t=(t+"").toLowerCase()).length<=0)return 0;let s=0,a=0,i=t.length;for(;a=e.indexOf(t,a),a>=0;)s+=1,a+=i;return s}(this.props.copy,"<p")&&-1===this.props.copy.indexOf("<br")?"page-lead lead":"page-lead"}render(){return this.props.copy&&this.props.copy.length?(0,i.Z)("div",{className:this.getClassName(),dangerouslySetInnerHTML:{__html:this.props.copy}}):null}};var T=s(429);const P=e=>{let{users:t}=e;return(0,i.Z)(T.Z,{cols:4,isReady:!0,showStatus:!0,users:t})};var O;class R extends o.Component{shouldComponentUpdate(){return!1}render=()=>O||(O=(0,i.Z)(T.Z,{cols:4,isReady:!1}))}const A=R;var I=s(2490);const D=e=>{let{users:t}=e;return t.more?(0,i.Z)("p",{},void 0,interpolate(ngettext("There is %(more)s more member with this role.","There are %(more)s more members with this role.",t.more),{more:t.more},!0)):(0,i.Z)("p",{},void 0,gettext("There are no more members with this role."))};var j,z,U,M,B,q,H,F;const Y=e=>{let{baseUrl:t,users:s}=e;return(0,i.Z)("div",{className:"misago-pagination"},void 0,s.isLoaded&&s.first?(0,i.Z)(l.rU,{className:"btn btn-default btn-outline btn-icon",to:t,title:gettext("Go to first page")},void 0,j||(j=(0,i.Z)("span",{className:"material-icon"},void 0,"first_page"))):(0,i.Z)("button",{className:"btn btn-default btn-outline btn-icon",title:gettext("Go to first page"),type:"button",disabled:!0},void 0,z||(z=(0,i.Z)("span",{className:"material-icon"},void 0,"first_page"))),s.isLoaded&&s.previous?(0,i.Z)(l.rU,{className:"btn btn-default btn-outline btn-icon",to:t+(s.previous>1?s.previous+"/":""),title:gettext("Go to previous page")},void 0,U||(U=(0,i.Z)("span",{className:"material-icon"},void 0,"chevron_left"))):(0,i.Z)("button",{className:"btn btn-default btn-outline btn-icon",title:gettext("Go to previous page"),type:"button",disabled:!0},void 0,M||(M=(0,i.Z)("span",{className:"material-icon"},void 0,"chevron_left"))),s.isLoaded&&s.next?(0,i.Z)(l.rU,{className:"btn btn-default btn-outline btn-icon",to:t+s.next+"/",title:gettext("Go to next page")},void 0,B||(B=(0,i.Z)("span",{className:"material-icon"},void 0,"chevron_right"))):(0,i.Z)("button",{className:"btn btn-default btn-outline btn-icon",title:gettext("Go to next page"),type:"button",disabled:!0},void 0,q||(q=(0,i.Z)("span",{className:"material-icon"},void 0,"chevron_right"))),s.isLoaded&&s.last?(0,i.Z)(l.rU,{className:"btn btn-default btn-outline btn-icon",to:t+s.last+"/",title:gettext("Go to last page")},void 0,H||(H=(0,i.Z)("span",{className:"material-icon"},void 0,"last_page"))):(0,i.Z)("button",{className:"btn btn-default btn-outline btn-icon",title:gettext("Go to last page"),type:"button",disabled:!0},void 0,F||(F=(0,i.Z)("span",{className:"material-icon"},void 0,"last_page"))))},V=e=>{let{baseUrl:t,users:s}=e;return(0,i.Z)(I.o8,{},void 0,(0,i.Z)(I.Z2,{},void 0,(0,i.Z)(I.Eg,{},void 0,(0,i.Z)(Y,{baseUrl:t,users:s}))),(0,i.Z)(I.Z2,{auto:!0},void 0,(0,i.Z)(I.Eg,{},void 0,(0,i.Z)(D,{users:s}))))};var G;const $=class extends o.Component{constructor(e){super(e),N.Z.has("USERS")?this.initWithPreloadedData(N.Z.pop("USERS")):this.initWithoutPreloadedData(),this.startPolling(e.params.page||1)}initWithPreloadedData(e){this.state=Object.assign(e,{isLoaded:!0}),C.Z.dispatch((0,w.ZB)(e.results))}initWithoutPreloadedData(){this.state={isLoaded:!1}}startPolling(e){k.Z.start({poll:"rank-users",url:N.Z.get("USERS_API"),data:{rank:this.props.route.rank.id,page:e},frequency:9e4,update:this.update})}update=e=>{C.Z.dispatch((0,w.ZB)(e.results)),e.isLoaded=!0,this.setState(e)};componentDidMount(){S.Z.set({title:this.props.route.rank.name,page:this.props.params.page||null,parent:gettext("Users")})}componentWillUnmount(){k.Z.stop("rank-users")}componentWillReceiveProps(e){this.props.params.page!==e.params.page&&(S.Z.set({title:this.props.route.rank.name,page:e.params.page||null,parent:gettext("Users")}),this.setState({isLoaded:!1}),k.Z.stop("rank-users"),this.startPolling(e.params.page))}getClassName(){return this.props.route.rank.css_class?"rank-users-list rank-users-"+this.props.route.rank.css_class:"rank-users-list"}getRankDescription(){return this.props.route.rank.description?(0,i.Z)("div",{className:"rank-description"},void 0,(0,i.Z)(L,{copy:this.props.route.rank.description.html})):null}getComponent(){return this.state.isLoaded?this.state.count>0?(0,i.Z)(P,{users:this.props.users}):(0,i.Z)("p",{className:"lead"},void 0,gettext("There are no users with this rank at the moment.")):G||(G=(0,i.Z)(A,{}))}render(){return(0,i.Z)("div",{className:this.getClassName()},void 0,(0,i.Z)(r.Z,{},void 0,(0,i.Z)(p,{baseUrl:N.Z.get("USERS_LIST_URL"),page:{name:this.props.route.rank.name},pages:N.Z.get("USERS_LISTS")}),this.getRankDescription(),this.getComponent(),(0,i.Z)(V,{baseUrl:N.Z.get("USERS_LIST_URL")+this.props.route.rank.slug+"/",users:this.state})))}};var W=s(2125),Q=s(9145);const K=class extends W.Z{render(){return(0,i.Z)("div",{className:"page page-users-lists"},void 0,(0,i.Z)(Q.sP,{},void 0,(0,i.Z)(Q.mr,{styleName:"users-lists"},void 0,(0,i.Z)(Q.gC,{styleName:"users-lists"},void 0,(0,i.Z)("h1",{},void 0,gettext("Users"))))),this.props.children)}};function J(e){return{tick:e.tick.tick,user:e.auth.user,users:e.users}}function X(){let e=[];return N.Z.get("USERS_LISTS").forEach((function(t){"rank"===t.component?(e.push({path:N.Z.get("USERS_LIST_URL")+t.slug+"/:page/",component:(0,n.$j)(J)($),rank:t}),e.push({path:N.Z.get("USERS_LIST_URL")+t.slug+"/",component:(0,n.$j)(J)($),rank:t})):"active-posters"===t.component&&e.push({path:N.Z.get("USERS_LIST_URL")+t.component+"/",component:(0,n.$j)(J)(E),extra:{name:t.name}})})),e}var ee=s(9633);N.Z.addInitializer({name:"component:users",initializer:function(e){e.has("USERS_LISTS")&&(0,ee.Z)({basepath:N.Z.get("USERS_LIST_URL"),component:K,paths:X()})},after:"store"})},7751:(e,t,s)=>{"use strict";var a=s(2233),i=s(6142);a.Z.addInitializer({name:"include",initializer:function(e){i.Z.init(e.get("STATIC_URL"))}})},6093:(e,t,s)=>{"use strict";var a=s(2233),i=s(2833);a.Z.addInitializer({name:"local-storage",initializer:function(){i.Z.init("misago_")}})},9764:(e,t,s)=>{"use strict";var a=s(2233),i=s(8621);a.Z.addInitializer({name:"dropdown",initializer:function(){let e=document.getElementById("mobile-navbar-dropdown-mount");e&&i.Z.init(e)},before:"store"})},7549:(e,t,s)=>{"use strict";var a=s(2233),i=s(9801);a.Z.addInitializer({name:"modal",initializer:function(){let e=document.getElementById("modal-mount");e&&i.Z.init(e)},before:"store"})},2331:(e,t,s)=>{"use strict";var a=s(381),i=s.n(a),o=s(2233),n=s(9755);o.Z.addInitializer({name:"moment",initializer:function(){i().locale(n("html").attr("lang"))}})},1513:(e,t,s)=>{"use strict";var a=s(2233),i=s(3328);a.Z.addInitializer({name:"page-title",initializer:function(e){i.Z.init(e.get("SETTINGS").forum_index_title,e.get("SETTINGS").forum_name)}})},8749:(e,t,s)=>{"use strict";var a=s(2233),i=s(8657),o=s(3904),n=s(5547);a.Z.addInitializer({name:"polls",initializer:function(){n.Z.init(i.Z,o.Z)}})},8251:(e,t,s)=>{"use strict";var a=s(2233),i=s(8657),o=s(4646),n=s(3904);a.Z.addInitializer({name:"posting",initializer:function(){o.Z.init(i.Z,n.Z,document.getElementById("posting-mount"))}})},6720:(e,t,s)=>{"use strict";var a=s(2233),i=s(5486),o=s(287);a.Z.addInitializer({name:"reducer:auth",initializer:function(e){o.Z.addReducer("auth",i.ZP,Object.assign({isAuthenticated:e.get("isAuthenticated"),isAnonymous:!e.get("isAuthenticated"),user:e.get("user")},i.E3))},before:"store"})},846:(e,t,s)=>{"use strict";var a=s(2233),i=s(8154),o=s(287);a.Z.addInitializer({name:"reducer:participants",initializer:function(){let e=null;a.Z.has("THREAD")&&(e=a.Z.get("THREAD").participants),o.Z.addReducer("participants",i.ZP,e||[])},before:"store"})},8255:(e,t,s)=>{"use strict";var a=s(2233),i=s(9752),o=s(287);a.Z.addInitializer({name:"reducer:poll",initializer:function(){let e=null;e=a.Z.has("THREAD")&&a.Z.get("THREAD").poll?(0,i.ZB)(a.Z.get("THREAD").poll):{},o.Z.addReducer("poll",i.ZP,e)},before:"store"})},4113:(e,t,s)=>{"use strict";var a=s(2233),i=s(1981),o=s(287);a.Z.addInitializer({name:"reducer:posts",initializer:function(){let e=null;e=a.Z.has("POSTS")?(0,i.ZB)(a.Z.get("POSTS")):{isLoaded:!1,isBusy:!1},o.Z.addReducer("posts",i.ZP,e)},before:"store"})},4444:(e,t,s)=>{"use strict";var a=s(2233),i=s(8598),o=s(287);a.Z.addInitializer({name:"reducer:profile-details",initializer:function(){let e=null;a.Z.has("PROFILE_DETAILS")&&(e=a.Z.get("PROFILE_DETAILS")),o.Z.addReducer("profile-details",i.ZP,e||{})},before:"store"})},1764:(e,t,s)=>{"use strict";var a=s(2233),i=s(7519),o=s(287);a.Z.addInitializer({name:"reducer:profile-hydrate",initializer:function(){a.Z.has("PROFILE")&&o.Z.dispatch((0,i.ZB)(a.Z.get("PROFILE")))},after:"store"})},8351:(e,t,s)=>{"use strict";var a=s(2233),i=s(7519),o=s(287);a.Z.addInitializer({name:"reducer:profile",initializer:function(){o.Z.addReducer("profile",i.ZP,{})},before:"store"})},1521:(e,t,s)=>{"use strict";var a=s(2233),i=s(6427),o=s(287);a.Z.addInitializer({name:"reducer:search",initializer:function(){o.Z.addReducer("search",i.ZP,Object.assign({},i.E3,{providers:a.Z.get("SEARCH_PROVIDERS")||[],query:a.Z.get("SEARCH_QUERY")||""}))},before:"store"})},9984:(e,t,s)=>{"use strict";var a=s(2233),i=s(4600),o=s(287);a.Z.addInitializer({name:"reducer:selection",initializer:function(){o.Z.addReducer("selection",i.ZP,[])},before:"store"})},1229:(e,t,s)=>{"use strict";var a=s(2233),i=s(7346),o=s(287);a.Z.addInitializer({name:"reducer:snackbar",initializer:function(){o.Z.addReducer("snackbar",i.ZP,i.E3)},before:"store"})},3589:(e,t,s)=>{"use strict";var a=s(2233),i=s(7738),o=s(287);a.Z.addInitializer({name:"reducer:thread",initializer:function(){let e=null;e=a.Z.has("THREAD")?(0,i.ZB)(a.Z.get("THREAD")):{isBusy:!1},o.Z.addReducer("thread",i.ZP,e)},before:"store"})},4108:(e,t,s)=>{"use strict";var a=s(2233),i=s(1340),o=s(287);a.Z.addInitializer({name:"reducer:threads",initializer:function(){o.Z.addReducer("threads",i.ZP,[])},before:"store"})},3934:(e,t,s)=>{"use strict";var a=s(2233),i=s(5586),o=s(287);a.Z.addInitializer({name:"reducer:tick",initializer:function(){o.Z.addReducer("tick",i.ZP,i.E3)},before:"store"})},5577:(e,t,s)=>{"use strict";var a=s(2233),i=s(8927),o=s(287);a.Z.addInitializer({name:"reducer:username-history",initializer:function(){o.Z.addReducer("username-history",i.ZP,[])},before:"store"})},3526:(e,t,s)=>{"use strict";var a=s(2233),i=s(6935),o=s(287);a.Z.addInitializer({name:"reducer:users",initializer:function(){o.Z.addReducer("users",i.ZP,[])},before:"store"})},3060:(e,t,s)=>{"use strict";var a=s(2233),i=s(3904),o=s(287);a.Z.addInitializer({name:"snackbar",initializer:function(){i.Z.init(o.Z)},after:"store"})},2292:(e,t,s)=>{"use strict";var a=s(2233),i=s(287);a.Z.addInitializer({name:"store",initializer:function(){i.Z.init()},before:"_end"})},3409:(e,t,s)=>{"use strict";var a=s(2233),i=s(5586),o=s(287);a.Z.addInitializer({name:"tick-start",initializer:function(){window.setInterval((function(){o.Z.dispatch((0,i.bq)())}),5e4)},after:"store"})},1341:(e,t,s)=>{"use strict";var a=s(2233),i=s(6142),o=s(9940);a.Z.addInitializer({name:"zxcvbn",initializer:function(){o.Z.init(i.Z)}})},5486:(e,t,s)=>{"use strict";s.d(t,{E3:()=>i,ZP:()=>p,r$:()=>l,w7:()=>c,zB:()=>d});var a=s(6935),i={signedIn:!1,signedOut:!1};const o="PATCH_USER",n="SIGN_IN",r="SIGN_OUT";function l(e){return{type:o,patch:e}}function d(e){return{type:n,user:e}}function c(){return{type:r,soft:arguments.length>0&&void 0!==arguments[0]&&arguments[0]}}function p(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case o:let s=Object.assign({},e);return s.user=Object.assign({},e.user,t.patch),s;case n:return Object.assign({},e,{signedIn:t.user});case r:return Object.assign({},e,{isAuthenticated:!1,isAnonymous:!0,signedOut:!t.soft});case a.oB:if(e.isAuthenticated&&e.user.id===t.userId){let s=Object.assign({},e);return s.user=Object.assign({},e.user,{avatars:t.avatars}),s}return e;case a.D9:if(e.isAuthenticated&&e.user.id===t.userId){let s=Object.assign({},e);return s.user=Object.assign({},e.user,{username:t.username,slug:t.slug}),s}return e;default:return e}}},8154:(e,t,s)=>{"use strict";s.d(t,{ZP:()=>o,gx:()=>i});const a="REPLACE_PARTICIPANTS";function i(e){return{type:a,state:e}}function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t.type===a?t.state:e}},9752:(e,t,s)=>{"use strict";s.d(t,{Ar:()=>u,Od:()=>m,ZB:()=>c,ZH:()=>r,ZP:()=>v,b9:()=>l,gx:()=>h,n6:()=>p});var a=s(381),i=s.n(a);const o="BUSY_POLL",n="RELEASE_POLL",r="REMOVE_POLL",l="REPLACE_POLL",d="UPDATE_POLL";function c(e){let t=!1;for(const s in e.choices)if(e.choices[s].selected){t=!0;break}return Object.assign({},e,{posted_on:i()(e.posted_on),hasSelectedChoices:t,endsOn:e.length?i()(e.posted_on).add(e.length,"days"):null,isBusy:!1})}function p(){return{type:o}}function u(){return{type:n}}function h(e){return{type:l,state:arguments.length>1&&void 0!==arguments[1]&&arguments[1]?e:c(e)}}function m(){return{type:r}}function v(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case o:return Object.assign({},e,{isBusy:!0});case n:return Object.assign({},e,{isBusy:!1});case r:return{isBusy:!1};case l:return t.state;case d:return Object.assign({},e,t.data);default:return e}}},2747:(e,t,s)=>{"use strict";s.d(t,{Qu:()=>n,ZB:()=>r,ZP:()=>c,r$:()=>d});var a=s(381),i=s.n(a),o=s(6935);const n="PATCH_POST";function r(e){return Object.assign({},e,{posted_on:i()(e.posted_on),updated_on:i()(e.updated_on),hidden_on:i()(e.hidden_on),attachments:e.attachments?e.attachments.map(l):null,poster:e.poster?(0,o.Ru)(e.poster):null,isSelected:!1,isBusy:!1,isDeleted:!1})}function l(e){return Object.assign({},e,{uploaded_on:i()(e.uploaded_on)})}function d(e,t){return{type:n,post:e,patch:t}}function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t.type===n&&e.id==t.post.id?Object.assign({},e,t.patch):e}},1981:(e,t,s)=>{"use strict";s.d(t,{R3:()=>g,Rz:()=>Z,Vx:()=>b,Ys:()=>p,ZB:()=>m,ZP:()=>_,_H:()=>u,kR:()=>h,zD:()=>v});var a=s(2747);const i="APPEND_POSTS",o="SELECT_POST",n="DESELECT_POST",r="DESELECT_POSTS",l="LOAD_POSTS",d="UNLOAD_POSTS",c="UPDATE_POSTS";function p(e){return{type:o,post:e}}function u(e){return{type:n,post:e}}function h(){return{type:r}}function m(e){return Object.assign({},e,{results:e.results.map(a.ZB),isLoaded:!0,isBusy:!1,isSelected:!1})}function v(e){return{type:l,state:arguments.length>1&&void 0!==arguments[1]&&arguments[1]?e:m(e)}}function g(e){return{type:i,state:arguments.length>1&&void 0!==arguments[1]&&arguments[1]?e:m(e)}}function Z(){return{type:d}}function b(e){return{type:c,update:e}}function _(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case o:const s=e.results.map((e=>e.id==t.post.id?Object.assign({},e,{isSelected:!0}):e));return Object.assign({},e,{results:s});case n:const p=e.results.map((e=>e.id==t.post.id?Object.assign({},e,{isSelected:!1}):e));return Object.assign({},e,{results:p});case r:const u=e.results.map((e=>Object.assign({},e,{isSelected:!1})));return Object.assign({},e,{results:u});case i:let h=e.results.slice();const m=e.results.map((e=>e.id));return t.state.results.map((e=>{-1===m.indexOf(e.id)&&h.push(e)})),Object.assign({},t.state,{results:h});case l:return t.state;case d:return Object.assign({},e,{isLoaded:!1});case c:return Object.assign({},e,t.update);case a.Qu:const v=e.results.map((e=>(0,a.ZP)(e,t)));return Object.assign({},e,{results:v});default:return e}}},8598:(e,t,s)=>{"use strict";s.d(t,{ZP:()=>o,zD:()=>i});const a="LOAD_DETAILS";function i(e){return{type:a,newState:e}}function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t.type===a?t.newState:e}},7519:(e,t,s)=>{"use strict";s.d(t,{ZB:()=>l,ZP:()=>c,r$:()=>d});var a=s(381),i=s.n(a),o=s(6935);const n="HYDRATE_PROFILE",r="PATCH_PROFILE";function l(e){return{type:n,profile:e}}function d(e){return{type:r,patch:e}}function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case n:return Object.assign({},t.profile,{joined_on:i()(t.profile.joined_on),status:(0,o.$q)(t.profile.status)});case r:return Object.assign({},e,t.patch);case o.oB:return e.id===t.userId?Object.assign({},e,{avatars:t.avatars}):e;case o.D9:return e.id===t.userId?Object.assign({},e,{username:t.username,slug:t.slug}):e;default:return e}}},6427:(e,t,s)=>{"use strict";s.d(t,{E3:()=>n,P0:()=>l,Vx:()=>r,ZP:()=>d});const a="REPLACE_SEARCH",i="UPDATE_SEARCH",o="UPDATE_SEARCH_PROVIDER",n={isLoading:!1,query:"",providers:[]};function r(e){return{type:i,update:e}}function l(e){return{type:o,provider:e}}function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case a:return t.state;case i:return Object.assign({},e,t.update);case o:return Object.assign({},e,{providers:e.providers.map((e=>e.id===t.provider.id?t.provider:e))});default:return e}}},4600:(e,t,s)=>{"use strict";s.d(t,{$6:()=>r,YP:()=>l,ZP:()=>c,wc:()=>d});var a=s(5830);const i="SELECT_ALL",o="SELECT_NONE",n="SELECT_ITEM";function r(e){return{type:i,items:e}}function l(){return{type:o}}function d(e){return{type:n,item:e}}function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case i:return t.items;case o:return[];case n:return(0,a.ZN)(e,t.item);default:return e}}},7346:(e,t,s)=>{"use strict";s.d(t,{E3:()=>a,OV:()=>n,ZP:()=>l,p2:()=>r});var a={type:"info",message:"",isVisible:!1};const i="SHOW_SNACKBAR",o="HIDE_SNACKBAR";function n(e,t){return{type:i,message:e,messageType:t}}function r(){return{type:o}}function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t.type===i?{type:t.messageType,message:t.message,isVisible:!0}:t.type===o?Object.assign({},e,{isVisible:!1}):e}},7738:(e,t,s)=>{"use strict";s.d(t,{Ar:()=>h,Vx:()=>v,ZB:()=>p,ZP:()=>Z,gx:()=>m,n6:()=>u,y8:()=>g});var a=s(381),i=s.n(a),o=s(9752);const n="BUSY_THREAD",r="RELEASE_THREAD",l="REPLACE_THREAD",d="UPDATE_THREAD",c="UPDATE_THREAD_ACL";function p(e){return Object.assign({},e,{started_on:i()(e.started_on),last_post_on:i()(e.last_post_on),best_answer_marked_on:e.best_answer_marked_on?i()(e.best_answer_marked_on):null,isBusy:!1})}function u(){return{type:n}}function h(){return{type:r}}function m(e){return{type:l,state:arguments.length>1&&void 0!==arguments[1]&&arguments[1]?e:p(e)}}function v(e){return{type:d,data:e}}function g(e){return{type:c,data:e}}function Z(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case n:return Object.assign({},e,{isBusy:!0});case r:return Object.assign({},e,{isBusy:!1});case o.ZH:return Object.assign({},e,{poll:null});case o.b9:return Object.assign({},e,{poll:t.state});case l:return t.state;case d:return Object.assign({},e,t.data);case c:const s=Object.assign({},e.acl,t.data);return Object.assign({},e,{acl:s});default:return e}}},1340:(e,t,s)=>{"use strict";s.d(t,{R3:()=>h,V8:()=>v,ZB:()=>g,ZP:()=>f,l8:()=>m,r$:()=>Z});var a=s(381),i=s.n(a),o=s(9759);const n="APPEND_THREADS",r="DELETE_THREAD",l="FILTER_THREADS",d="HYDRATE_THREADS",c="PATCH_THREAD",p="SORT_THREADS",u=["can_announce","can_approve","can_close","can_hide","can_move","can_merge","can_pin","can_review"];function h(e,t){return{type:n,items:e,sorting:t}}function m(e){return{type:r,thread:e}}function v(e,t){return{type:l,category:e,categoriesMap:t}}function g(e){return{type:d,items:e}}function Z(e,t){return{type:c,thread:e,patch:t,sorting:arguments.length>2&&void 0!==arguments[2]?arguments[2]:null}}function b(e){let t=[];return u.forEach((function(s){e[s]&&t.push(s)})),t}function _(e){return Object.assign({},e,{started_on:i()(e.started_on),last_post_on:i()(e.last_post_on),moderation:b(e.acl)})}function f(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case n:return(0,o.Z)(t.items.map(_),e).sort(t.sorting);case r:return e.filter((function(e){return e.id!==t.thread.id}));case l:return e.filter((function(e){const s=t.categoriesMap[e.category];return s.lft>=t.category.lft&&s.rght<=t.category.rght||2==e.weight}));case d:return t.items.map(_);case c:const s=e.map((function(e){return e.id===t.thread.id?Object.assign({},e,t.patch):e}));return t.sorting?s.sort(t.sorting):s;case p:return e.sort(t.sorting);default:return e}}},5586:(e,t,s)=>{"use strict";s.d(t,{E3:()=>a,ZP:()=>n,bq:()=>o});var a={tick:0};const i="TICK";function o(){return{type:i}}function n(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null).type===i?Object.assign({},e,{tick:e.tick+1}):e}},8927:(e,t,s)=>{"use strict";s.d(t,{KP:()=>c,R3:()=>p,ZB:()=>u,ZP:()=>m});var a=s(381),i=s.n(a),o=s(6935),n=s(9759);const r="ADD_NAME_CHANGE",l="APPEND_HISTORY",d="HYDRATE_HISTORY";function c(e,t,s){return{type:r,change:e,user:t,changedBy:s}}function p(e){return{type:l,items:e}}function u(e){return{type:d,items:e}}function h(e){return Object.assign({},e,{changed_on:i()(e.changed_on)})}function m(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case r:let s=e.slice();return s.unshift({id:Math.floor(Date.now()/1e3),changed_by:t.changedBy,changed_by_username:t.changedBy.username,changed_on:i()(),new_username:t.change.username,old_username:t.user.username}),s;case l:return(0,n.Z)(e,t.items.map(h));case d:return t.items.map(h);case o.oB:return e.map((function(e){return(e=Object.assign({},e)).changed_by&&e.changed_by.id===t.userId&&(e.changed_by=Object.assign({},e.changed_by,{avatars:t.avatars})),e}));case o.D9:return e.map((function(e){return(e=Object.assign({},e)).changed_by&&e.changed_by.id===t.userId&&(e.changed_by=Object.assign({},e.changed_by,{username:t.username,slug:t.slug})),Object.assign({},e)}));default:return e}}},6935:(e,t,s)=>{"use strict";s.d(t,{$q:()=>u,D9:()=>d,R3:()=>c,Ru:()=>h,ZB:()=>p,ZP:()=>g,_S:()=>v,n1:()=>m,oB:()=>l});var a=s(381),i=s.n(a),o=s(9759);const n="APPEND_USERS",r="HYDRATE_USERS",l="UPDATE_AVATAR",d="UPDATE_USERNAME";function c(e){return{type:n,items:e}}function p(e){return{type:r,items:e}}function u(e){return e?Object.assign({},e,{last_click:e.last_click?i()(e.last_click):null,banned_until:e.banned_until?i()(e.banned_until):null}):null}function h(e){return Object.assign({},e,{joined_on:i()(e.joined_on),status:u(e.status)})}function m(e,t){return{type:l,userId:e.id,avatars:t}}function v(e,t,s){return{type:d,userId:e.id,username:t,slug:s}}function g(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(t.type){case n:return(0,o.Z)(e,t.items.map(h));case r:return t.items.map(h);case l:return e.map((function(e){return(e=Object.assign({},e)).id===t.userId&&(e.avatars=t.avatars),e}));default:return e}}},8657:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});var a=s(9755);const i=new class{constructor(){this._cookieName=null,this._csrfToken=null,this._locks={}}init(e){this._cookieName=e}getCsrfToken(){if(-1!==document.cookie.indexOf(this._cookieName)){let e=new RegExp(this._cookieName+"=([^;]*)"),t=document.cookie.match(e)[0];return t?t.split("=")[1]:null}return null}request(e,t,s){let i=this;return new Promise((function(o,n){let r={url:t,method:e,headers:{"X-CSRFToken":i.getCsrfToken()},data:s?JSON.stringify(s):null,contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){o(e)},error:function(e){let t=e.responseJSON||{};t.status=e.status,0===t.status&&(t.detail=gettext("Lost connection with application.")),404===t.status&&(t.detail&&"NOT FOUND"!==t.detail||(t.detail=gettext("Action link is invalid."))),500!==t.status||t.detail||(t.detail=gettext("Unknown error has occured.")),t.statusText=e.statusText,n(t)}};a.ajax(r)}))}get(e,t,s){if(t&&(e+="?"+a.param(t)),s){let t=this;return this._locks[s]&&(this._locks[s].url=e),this._locks[s]&&this._locks[s].waiter?{then:function(){}}:this._locks[s]&&this._locks[s].wait?(this._locks[s].waiter=!0,new Promise((function(a,i){let o=function(e){t._locks[s].wait?window.setTimeout((function(){o(e)}),300):t._locks[s].url!==e?o(t._locks[s].url):(t._locks[s].waiter=!1,t.request("GET",t._locks[s].url).then((function(i){t._locks[s].url===e?a(i):(t._locks[s].waiter=!0,o(t._locks[s].url))}),(function(a){t._locks[s].url===e?i(a):(t._locks[s].waiter=!0,o(t._locks[s].url))})))};window.setTimeout((function(){o(e)}),300)}))):(this._locks[s]={url:e,wait:!0,waiter:!1},new Promise((function(a,i){t.request("GET",e).then((function(i){t._locks[s].wait=!1,t._locks[s].url===e&&a(i)}),(function(a){t._locks[s].wait=!1,t._locks[s].url===e&&i(a)}))})))}return this.request("GET",e)}post(e,t){return this.request("POST",e,t)}patch(e,t){return this.request("PATCH",e,t)}put(e,t){return this.request("PUT",e,t)}delete(e,t){return this.request("DELETE",e,t)}upload(e,t,s){let i=this;return new Promise((function(o,n){let r={url:e,method:"POST",headers:{"X-CSRFToken":i.getCsrfToken()},data:t,contentType:!1,processData:!1,xhr:function(){let e=new window.XMLHttpRequest;return e.upload.addEventListener("progress",(function(e){e.lengthComputable&&s(Math.round(e.loaded/e.total*100))}),!1),e},success:function(e){o(e)},error:function(e){let t=e.responseJSON||{};t.status=e.status,0===t.status&&(t.detail=gettext("Lost connection with application.")),413!==t.status||t.detail||(t.detail=gettext("Upload was rejected by server as too large.")),404===t.status&&(t.detail&&"NOT FOUND"!==t.detail||(t.detail=gettext("Action link is invalid."))),500!==t.status||t.detail||(t.detail=gettext("Unknown error has occured.")),t.statusText=e.statusText,n(t)}};a.ajax(r)}))}}},8274:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});var a=s(5486);const i=new class{init(e,t,s){this._store=e,this._local=t,this._modal=s,this.syncSession(),this.watchState()}syncSession(){const e=this._store.getState().auth;e.isAuthenticated?this._local.set("auth",{isAuthenticated:!0,username:e.user.username}):this._local.set("auth",{isAuthenticated:!1})}watchState(){const e=this._store.getState().auth;this._local.watch("auth",(t=>{t.isAuthenticated?this._store.dispatch((0,a.zB)({username:t.username})):e.isAuthenticated&&this._store.dispatch((0,a.w7)())})),this._modal.hide()}signIn(e){this._store.dispatch((0,a.zB)(e)),this._local.set("auth",{isAuthenticated:!0,username:e.username}),this._modal.hide()}signOut(){this._store.dispatch((0,a.w7)()),this._local.set("auth",{isAuthenticated:!1}),this._modal.hide()}softSignOut(){this._store.dispatch((0,a.w7)(!0)),this._local.set("auth",{isAuthenticated:!1}),this._modal.hide()}}},3825:(e,t,s)=>{"use strict";s.d(t,{ZP:()=>u});var a,i=s(2928),o=s(7294),n=s(6359);class r{init(e,t,s,a){this._context=e,this._ajax=t,this._include=s,this._snackbar=a}}class l extends r{load(){return new Promise((function(e){e()}))}validator(){return null}component(){return null}}class d extends r{load(){var e=this;return new Promise(((t,s)=>{e._ajax.get(e._context.get("CAPTCHA_API")).then((function(s){e.question=s.question,e.helpText=s.help_text,t()}),(function(){e._snackbar.error(gettext("Failed to load CAPTCHA.")),s()}))}))}validator(){return[]}component(e){return(0,i.Z)(n.Z,{label:this.question,for:"id_captcha",labelClass:e.labelClass||"",controlClass:e.controlClass||"",validation:e.form.state.errors.captcha,helpText:this.helpText||null},void 0,(0,i.Z)("input",{"aria-describedby":"id_captcha_status",className:"form-control",disabled:e.form.state.isLoading,id:"id_captcha",onChange:e.form.bindInput("captcha"),type:"text",value:e.form.state.captcha}))}}class c extends o.Component{componentDidMount(){grecaptcha.render("recaptcha",{sitekey:this.props.siteKey,callback:e=>{this.props.binding({target:{value:e}})}})}render(){return a||(a=(0,i.Z)("div",{id:"recaptcha"}))}}class p extends r{load(){return this._include.include("https://www.google.com/recaptcha/api.js",!0),new Promise((function(e){var t=function(){"undefined"==typeof grecaptcha?window.setTimeout((function(){t()}),200):e()};t()}))}validator(){return[]}component(e){return(0,i.Z)(n.Z,{label:gettext("Please solve the quick test"),for:"id_captcha",labelClass:e.labelClass||"",controlClass:e.controlClass||"",validation:e.form.state.errors.captcha,helpText:gettext("This test helps us prevent automated spam registrations on our site.")},void 0,(0,i.Z)(c,{binding:e.form.bindInput("captcha"),siteKey:this._context.get("SETTINGS").recaptcha_site_key}))}}const u=new class{init(e,t,s,a){switch(e.get("SETTINGS").captcha_type){case"no":this._captcha=new l;break;case"qa":this._captcha=new d;break;case"re":this._captcha=new p}this._captcha.init(e,t,s,a)}load(){return this._captcha.load()}validator(){return this._captcha.validator()}component(e){return this._captcha.component(e)}}},6142:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});var a=s(9755);const i=new class{init(e){this._staticUrl=e,this._included=[]}include(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];-1===this._included.indexOf(e)&&(this._included.push(e),this._include(e,t))}_include(e,t){a.ajax({url:(t?"":this._staticUrl)+e,cache:!0,dataType:"script"})}}},2833:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});let a=window.localStorage;const i=new class{init(e){this._prefix=e,this._watchers=[],window.addEventListener("storage",(e=>{let t=JSON.parse(e.newValue);this._watchers.forEach((function(s){s.key===e.key&&e.oldValue!==e.newValue&&s.callback(t)}))}))}set(e,t){a.setItem(this._prefix+e,JSON.stringify(t))}get(e){let t=a.getItem(this._prefix+e);return t?JSON.parse(t):null}watch(e,t){this._watchers.push({key:this._prefix+e,callback:t})}}},8621:(e,t,s)=>{"use strict";s.d(t,{Z:()=>o});var a=s(4869),i=s(9755);const o=new class{init(e){this._element=e,this._component=null}show(e){this._component===e?this.hide():(this._component=e,(0,a.Z)(e,this._element.id),i(this._element).addClass("open"))}showConnected(e,t){this._component===e?this.hide():(this._component=e,(0,a.Z)(t,this._element.id,!0),i(this._element).addClass("open"))}hide(){i(this._element).removeClass("open"),this._component=null}}},9801:(e,t,s)=>{"use strict";s.d(t,{Z:()=>n});var a=s(3935),i=s(4869),o=s(9755);const n=new class{init(e){this._element=e,this._modal=o(e).modal({show:!1}),this._modal.on("hidden.bs.modal",(()=>{a.unmountComponentAtNode(this._element)}))}show(e){(0,i.Z)(e,this._element.id),this._modal.modal("show")}hide(){this._modal.modal("hide")}}},3328:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});const a=new class{init(e,t){this._indexTitle=e,this._forumName=t}set(e){if(!e)return void(document.title=this._indexTitle||this._forumName);"string"==typeof e&&(e={title:e});let t=e.title;e.page>1&&(t+=" ("+interpolate(gettext("page: %(page)s"),{page:e.page},!0)+")"),e.parent&&(t+=" | "+e.parent),document.title=t+" | "+this._forumName}}},5547:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});const a=new class{init(e,t){this._ajax=e,this._snackbar=t,this._polls={}}start(e){this.stop(e.poll);const t=()=>{this._polls[e.poll]=e,this._ajax.get(e.url,e.data||null).then((s=>{this._polls[e.poll]._stopped||(e.update(s),this._polls[e.poll].timeout=window.setTimeout(t,e.frequency))}),(t=>{this._polls[e.poll]._stopped||(e.error?e.error(t):this._snackbar.apiError(t))}))};e.delayed?this._polls[e.poll]={timeout:window.setTimeout(t,e.frequency)}:t()}stop(e){this._polls[e]&&(window.clearTimeout(this._polls[e].timeout),this._polls[e]._stopped=!0)}}},4646:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});var a=s(7294),i=s(3935),o=s(661),n=s(4869);const r=new class{init(e,t,s){this._ajax=e,this._snackbar=t,this._mount=s,this._mode=null,this._spacer=document.getElementById("posting-spacer"),this._observer=new ResizeObserver((e=>{this._spacer.style.height=e[0].contentRect.height+"px"})),this._isOpen=!1,this._isClosing=!1,this._beforeunloadSet=!1}isOpen(){return this._isOpen}setBeforeUnload(){this._beforeunloadSet||(window.addEventListener("beforeunload",this.beforeUnload,{capture:!0}),this._beforeunloadSet=!0)}unsetBeforeUnload(){window.removeEventListener("beforeunload",this.beforeUnload,{capture:!0}),this._beforeunloadSet=!1}beforeUnload(e){return e.returnValue="true","true"}open(e){if(!1===this._isOpen)this._mode=e.mode,this._isOpen=e.submit,this._realOpen(e);else if(this._isOpen!==e.submit){let t=gettext("You are already working on other message. Do you want to discard it?");window.confirm(t)&&(this._mode=e.mode,this._isOpen=e.submit,this._realOpen(e))}else"REPLY"==this._mode&&"REPLY"==e.mode&&this._realOpen(e)}_realOpen(e){(0,n.Z)(a.createElement(o.ZP,e),this._mount.id),this._mount.classList.add("show"),this._observer.observe(this._mount),this.setBeforeUnload()}close=()=>{this.unsetBeforeUnload(),this._isOpen&&!this._isClosing&&(this._isClosing=!0,this._mount.classList.remove("show"),window.setTimeout((()=>{i.unmountComponentAtNode(this._mount),this._observer.unobserve(this._mount),this._spacer.style.height="0px;",this._isClosing=!1,this._isOpen=!1,this._mode=null}),300))}}},3904:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});var a=s(7346);const i=new class{init(e){this._store=e,this._timeout=null}alert(e,t){this._timeout?(window.clearTimeout(this._timeout),this._store.dispatch((0,a.p2)()),this._timeout=window.setTimeout((()=>{this._timeout=null,this.alert(e,t)}),300)):(this._store.dispatch((0,a.OV)(e,t)),this._timeout=window.setTimeout((()=>{this._store.dispatch((0,a.p2)()),this._timeout=null}),5e3))}info(e){this.alert(e,"info")}success(e){this.alert(e,"success")}warning(e){this.alert(e,"warning")}error(e){this.alert(e,"error")}apiError(e){let t=e.detail;t||(t=404===e.status?gettext("Action link is invalid."):gettext("Unknown error has occured.")),403===e.status&&"Permission denied"===t&&(t=gettext("You don't have permission to perform this action.")),this.error(t)}}},287:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});var a=s(4890);const i=new class{constructor(){this._store=null,this._reducers={},this._initialState={}}addReducer(e,t,s){this._reducers[e]=t,this._initialState[e]=s}init(){this._store=(0,a.MT)((0,a.UY)(this._reducers),this._initialState)}getStore(){return this._store}getState(){return this._store.getState()}dispatch(e){return this._store.dispatch(e)}}},9940:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});const a=new class{init(e){this._include=e,this._isLoaded=!1}scorePassword(e,t){return this._isLoaded?zxcvbn(e,t).score:0}load(){return this._isLoaded?this._loadedPromise():(this._include.include("misago/js/zxcvbn.js"),this._loadingPromise())}_loadingPromise(){const e=this;return new Promise((function(t,s){var a=function(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;i+=1,i>200?s():"undefined"==typeof zxcvbn?window.setTimeout((function(){a(i)}),200):(e._isLoaded=!0,t())};a()}))}_loadedPromise(){return new Promise((function(e){e()}))}}},3051:(e,t,s)=>{"use strict";s.d(t,{Z:()=>m});var a,i=s(2928),o=s(381),n=s.n(o),r=s(7294),l=s(3935),d=s(7785);const c=class extends r.Component{getReasonMessage(){return this.props.message.html?(0,i.Z)("div",{className:"lead",dangerouslySetInnerHTML:{__html:this.props.message.html}}):(0,i.Z)("p",{className:"lead"},void 0,this.props.message.plain)}getExpirationMessage(){if(this.props.expires){if(this.props.expires.isAfter(n()())){let e=interpolate(gettext("This ban expires on %(expires_on)s."),{expires_on:this.props.expires.format("LL, LT")},!0),t=interpolate(gettext("This ban expires %(expires_on)s."),{expires_on:this.props.expires.fromNow()},!0);return(0,i.Z)("abbr",{title:e},void 0,t)}return gettext("This ban has expired.")}return gettext("This ban is permanent.")}render(){return(0,i.Z)("div",{className:"page page-error page-error-banned"},void 0,(0,i.Z)("div",{className:"container"},void 0,(0,i.Z)("div",{className:"message-panel"},void 0,a||(a=(0,i.Z)("div",{className:"message-icon"},void 0,(0,i.Z)("span",{className:"material-icon"},void 0,"highlight_off"))),(0,i.Z)("div",{className:"message-body"},void 0,this.getReasonMessage(),(0,i.Z)("p",{className:"message-footnote"},void 0,this.getExpirationMessage())))))}};var p=s(2233),u=s(287);let h=(0,d.$j)((function(e){return e.tick}))(c);function m(e,t){if(l.render((0,i.Z)(d.zt,{store:u.Z.getStore()},void 0,(0,i.Z)(h,{message:e.message,expires:e.expires_on?n()(e.expires_on):null})),document.getElementById("page-mount")),void 0===t||t){let e=p.Z.get("SETTINGS").forum_name;document.title=gettext("You are banned")+" | "+e,window.history.pushState({},"",p.Z.get("BANNED_URL"))}}},9130:(e,t,s)=>{"use strict";function a(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=[],i=[];if(e.forEach((function(e){i.push(e),i.length===t&&(a.push(i),i=[])})),!1!==s&&i.length>0&&i.length<t)for(let e=i.length;e<t;e++)i.push(s);return i.length&&a.push(i),a}s.d(t,{Z:()=>a})},9759:(e,t,s)=>{"use strict";function a(e,t){let s=[];return e.concat(t).filter((function(e){return-1===s.indexOf(e.id)&&(s.push(e.id),!0)}))}s.d(t,{Z:()=>a})},9627:(e,t,s)=>{"use strict";s.d(t,{Z:()=>i});const a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};function i(e){return e.replace(/[&<>"']/g,(function(e){return a[e]}))}},8772:(e,t,s)=>{"use strict";function a(e){return e>1073741824?i(e/1073741824)+" GB":e>1048576?i(e/1048576)+" MB":e>1024?i(e/1024)+" KB":i(e)+" B"}function i(e){return e.toFixed(1)}s.d(t,{Z:()=>a})},4869:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});var a=s(2928),i=(s(7294),s(3935)),o=s(7785),n=s(287);function r(e,t){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=document.getElementById(t),l=e.props?e:(0,a.Z)(e,{});r&&(s?i.render((0,a.Z)(o.zt,{store:n.Z.getStore()},void 0,l),r):i.render(l,r))}},4039:(e,t,s)=>{"use strict";function a(e,t){return Math.floor(Math.random()*(t-e+1))+e}s.d(t,{e:()=>a})},9633:(e,t,s)=>{"use strict";s.d(t,{Z:()=>c});var a=s(2928),i=(s(7294),s(3935)),o=s(7785),n=s(9250),r=s(9655),l=s(287);const d=document.getElementById("page-mount");function c(e){let t=[];e.basepath&&t.push({path:e.basepath,element:(0,a.Z)(n.Fg,{to:e.paths[0].path})}),e.paths.map((e=>t.push(e)));const{Component:s}=e,c=(0,r.aj)(t);i.render((0,a.Z)(o.zt,{store:l.Z.getStore()},void 0,s?(0,a.Z)(s,{},void 0,(0,a.Z)(n.pG,{router:c})):(0,a.Z)(n.pG,{router:c})),d)}},5830:(e,t,s)=>{"use strict";function a(e,t){if(-1===e.indexOf(t)){let s=e.slice();return s.push(t),s}return e.filter((function(e){return e!==t}))}s.d(t,{ZN:()=>a})},5210:(e,t,s)=>{"use strict";s.d(t,{BS:()=>p,C1:()=>n,Do:()=>d,Ei:()=>c,HR:()=>u,Vb:()=>v,fT:()=>r,gS:()=>h,jA:()=>l,lG:()=>m});var a=s(9755);const i=/^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i,o=new RegExp("^[0-9a-z]+$","i");function n(e){return function(t){if(!1===t||null===t||0===a.trim(t).length)return e||gettext("This field is required.")}}function r(e){const t=gettext("You have to accept the terms of service.");return n(e||t)}function l(e){const t=gettext("You have to accept the privacy policy.");return n(e||t)}function d(e){return function(t){if(!i.test(t))return e||gettext("Enter a valid email address.")}}function c(e,t){return function(s){var i="",o=a.trim(s).length;if(o<e)return i=t?t(e,o):ngettext("Ensure this value has at least %(limit_value)s character (it has %(show_value)s).","Ensure this value has at least %(limit_value)s characters (it has %(show_value)s).",e),interpolate(i,{limit_value:e,show_value:o},!0)}}function p(e,t){return function(s){var i="",o=a.trim(s).length;if(o>e)return i=t?t(e,o):ngettext("Ensure this value has at most %(limit_value)s character (it has %(show_value)s).","Ensure this value has at most %(limit_value)s characters (it has %(show_value)s).",e),interpolate(i,{limit_value:e,show_value:o},!0)}}function u(e){return c(e,(function(e){return ngettext("Username must be at least %(limit_value)s character long.","Username must be at least %(limit_value)s characters long.",e)}))}function h(e){return p(e,(function(e){return ngettext("Username cannot be longer than %(limit_value)s character.","Username cannot be longer than %(limit_value)s characters.",e)}))}function m(){return function(e){if(!o.test(a.trim(e)))return gettext("Username can only contain latin alphabet letters and digits.")}}function v(e){return function(t){const s=t.length;if(s<e){const t=ngettext("Valid password must be at least %(limit_value)s character long.","Valid password must be at least %(limit_value)s characters long.",e);return interpolate(t,{limit_value:e,show_value:s},!0)}}}},6700:(e,t,s)=>{var a={"./af":2786,"./af.js":2786,"./ar":867,"./ar-dz":4130,"./ar-dz.js":4130,"./ar-kw":6135,"./ar-kw.js":6135,"./ar-ly":6440,"./ar-ly.js":6440,"./ar-ma":7702,"./ar-ma.js":7702,"./ar-sa":6040,"./ar-sa.js":6040,"./ar-tn":7100,"./ar-tn.js":7100,"./ar.js":867,"./az":1083,"./az.js":1083,"./be":9808,"./be.js":9808,"./bg":8338,"./bg.js":8338,"./bm":7438,"./bm.js":7438,"./bn":8905,"./bn-bd":6225,"./bn-bd.js":6225,"./bn.js":8905,"./bo":1560,"./bo.js":1560,"./br":1278,"./br.js":1278,"./bs":622,"./bs.js":622,"./ca":2468,"./ca.js":2468,"./cs":5822,"./cs.js":5822,"./cv":877,"./cv.js":877,"./cy":7373,"./cy.js":7373,"./da":4780,"./da.js":4780,"./de":9740,"./de-at":217,"./de-at.js":217,"./de-ch":894,"./de-ch.js":894,"./de.js":9740,"./dv":5300,"./dv.js":5300,"./el":837,"./el.js":837,"./en-au":8348,"./en-au.js":8348,"./en-ca":7925,"./en-ca.js":7925,"./en-gb":2243,"./en-gb.js":2243,"./en-ie":6436,"./en-ie.js":6436,"./en-il":7207,"./en-il.js":7207,"./en-in":4175,"./en-in.js":4175,"./en-nz":6319,"./en-nz.js":6319,"./en-sg":1662,"./en-sg.js":1662,"./eo":2915,"./eo.js":2915,"./es":5655,"./es-do":5251,"./es-do.js":5251,"./es-mx":6112,"./es-mx.js":6112,"./es-us":1146,"./es-us.js":1146,"./es.js":5655,"./et":5603,"./et.js":5603,"./eu":7763,"./eu.js":7763,"./fa":6959,"./fa.js":6959,"./fi":1897,"./fi.js":1897,"./fil":2549,"./fil.js":2549,"./fo":4694,"./fo.js":4694,"./fr":4470,"./fr-ca":3049,"./fr-ca.js":3049,"./fr-ch":2330,"./fr-ch.js":2330,"./fr.js":4470,"./fy":5044,"./fy.js":5044,"./ga":9295,"./ga.js":9295,"./gd":2101,"./gd.js":2101,"./gl":8794,"./gl.js":8794,"./gom-deva":7884,"./gom-deva.js":7884,"./gom-latn":3168,"./gom-latn.js":3168,"./gu":5349,"./gu.js":5349,"./he":4206,"./he.js":4206,"./hi":94,"./hi.js":94,"./hr":316,"./hr.js":316,"./hu":2138,"./hu.js":2138,"./hy-am":1423,"./hy-am.js":1423,"./id":9218,"./id.js":9218,"./is":135,"./is.js":135,"./it":626,"./it-ch":150,"./it-ch.js":150,"./it.js":626,"./ja":9183,"./ja.js":9183,"./jv":4286,"./jv.js":4286,"./ka":2105,"./ka.js":2105,"./kk":7772,"./kk.js":7772,"./km":8758,"./km.js":8758,"./kn":9282,"./kn.js":9282,"./ko":3730,"./ko.js":3730,"./ku":1408,"./ku.js":1408,"./ky":3291,"./ky.js":3291,"./lb":6841,"./lb.js":6841,"./lo":5466,"./lo.js":5466,"./lt":7010,"./lt.js":7010,"./lv":7595,"./lv.js":7595,"./me":9861,"./me.js":9861,"./mi":5493,"./mi.js":5493,"./mk":5966,"./mk.js":5966,"./ml":7341,"./ml.js":7341,"./mn":5115,"./mn.js":5115,"./mr":370,"./mr.js":370,"./ms":9847,"./ms-my":1237,"./ms-my.js":1237,"./ms.js":9847,"./mt":2126,"./mt.js":2126,"./my":6165,"./my.js":6165,"./nb":4924,"./nb.js":4924,"./ne":6744,"./ne.js":6744,"./nl":3901,"./nl-be":9814,"./nl-be.js":9814,"./nl.js":3901,"./nn":3877,"./nn.js":3877,"./oc-lnc":2135,"./oc-lnc.js":2135,"./pa-in":5858,"./pa-in.js":5858,"./pl":4495,"./pl.js":4495,"./pt":9520,"./pt-br":7971,"./pt-br.js":7971,"./pt.js":9520,"./ro":6459,"./ro.js":6459,"./ru":1793,"./ru.js":1793,"./sd":950,"./sd.js":950,"./se":490,"./se.js":490,"./si":124,"./si.js":124,"./sk":4249,"./sk.js":4249,"./sl":4985,"./sl.js":4985,"./sq":1104,"./sq.js":1104,"./sr":9131,"./sr-cyrl":9915,"./sr-cyrl.js":9915,"./sr.js":9131,"./ss":5893,"./ss.js":5893,"./sv":8760,"./sv.js":8760,"./sw":1172,"./sw.js":1172,"./ta":7333,"./ta.js":7333,"./te":3110,"./te.js":3110,"./tet":2095,"./tet.js":2095,"./tg":7321,"./tg.js":7321,"./th":9041,"./th.js":9041,"./tk":9005,"./tk.js":9005,"./tl-ph":5768,"./tl-ph.js":5768,"./tlh":9444,"./tlh.js":9444,"./tr":2397,"./tr.js":2397,"./tzl":8254,"./tzl.js":8254,"./tzm":1106,"./tzm-latn":699,"./tzm-latn.js":699,"./tzm.js":1106,"./ug-cn":9288,"./ug-cn.js":9288,"./uk":7691,"./uk.js":7691,"./ur":3795,"./ur.js":3795,"./uz":6791,"./uz-latn":588,"./uz-latn.js":588,"./uz.js":6791,"./vi":5666,"./vi.js":5666,"./x-pseudo":4378,"./x-pseudo.js":4378,"./yo":5805,"./yo.js":5805,"./zh-cn":3839,"./zh-cn.js":3839,"./zh-hk":5726,"./zh-hk.js":5726,"./zh-mo":9807,"./zh-mo.js":9807,"./zh-tw":4152,"./zh-tw.js":4152};function i(e){var t=o(e);return s(t)}function o(e){if(!s.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}i.keys=function(){return Object.keys(a)},i.resolve=o,e.exports=i,i.id=6700}},n={};function r(e){var t=n[e];if(void 0!==t)return t.exports;var s=n[e]={id:e,loaded:!1,exports:{}};return o[e].call(s.exports,s,s.exports,r),s.loaded=!0,s.exports}r.m=o,e=[],r.O=(t,s,a,i)=>{if(!s){var o=1/0;for(c=0;c<e.length;c++){for(var[s,a,i]=e[c],n=!0,l=0;l<s.length;l++)(!1&i||o>=i)&&Object.keys(r.O).every((e=>r.O[e](s[l])))?s.splice(l--,1):(n=!1,i<o&&(o=i));if(n){e.splice(c--,1);var d=a();void 0!==d&&(t=d)}}return t}i=i||0;for(var c=e.length;c>0&&e[c-1][2]>i;c--)e[c]=e[c-1];e[c]=[s,a,i]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},s=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,r.t=function(e,a){if(1&a&&(e=this(e)),8&a)return e;if("object"==typeof e&&e){if(4&a&&e.__esModule)return e;if(16&a&&"function"==typeof e.then)return e}var i=Object.create(null);r.r(i);var o={};t=t||[null,s({}),s([]),s(s)];for(var n=2&a&&e;"object"==typeof n&&!~t.indexOf(n);n=s(n))Object.getOwnPropertyNames(n).forEach((t=>o[t]=()=>e[t]));return o.default=()=>e,r.d(i,o),i},r.d=(e,t)=>{for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},r.f={},r.e=e=>Promise.all(Object.keys(r.f).reduce(((t,s)=>(r.f[s](e,t),t)),[])),r.u=e=>"hljs.js",r.miniCssF=e=>{},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a={},i="misago:",r.l=(e,t,s,o)=>{if(a[e])a[e].push(t);else{var n,l;if(void 0!==s)for(var d=document.getElementsByTagName("script"),c=0;c<d.length;c++){var p=d[c];if(p.getAttribute("src")==e||p.getAttribute("data-webpack")==i+s){n=p;break}}n||(l=!0,(n=document.createElement("script")).charset="utf-8",n.timeout=120,r.nc&&n.setAttribute("nonce",r.nc),n.setAttribute("data-webpack",i+s),n.src=e),a[e]=[t];var u=(t,s)=>{n.onerror=n.onload=null,clearTimeout(h);var i=a[e];if(delete a[e],n.parentNode&&n.parentNode.removeChild(n),i&&i.forEach((e=>e(s))),t)return t(s)},h=setTimeout(u.bind(null,void 0,{type:"timeout",target:n}),12e4);n.onerror=u.bind(null,n.onerror),n.onload=u.bind(null,n.onload),l&&document.head.appendChild(n)}},r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e;r.g.importScripts&&(e=r.g.location+"");var t=r.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var s=t.getElementsByTagName("script");s.length&&(e=s[s.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=e})(),(()=>{var e={174:0};r.f.j=(t,s)=>{var a=r.o(e,t)?e[t]:void 0;if(0!==a)if(a)s.push(a[2]);else{var i=new Promise(((s,i)=>a=e[t]=[s,i]));s.push(a[2]=i);var o=r.p+r.u(t),n=new Error;r.l(o,(s=>{if(r.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=s&&("load"===s.type?"missing":s.type),o=s&&s.target&&s.target.src;n.message="Loading chunk "+t+" failed.\n("+i+": "+o+")",n.name="ChunkLoadError",n.type=i,n.request=o,a[1](n)}}),"chunk-"+t,t)}},r.O.j=t=>0===e[t];var t=(t,s)=>{var a,i,[o,n,l]=s,d=0;if(o.some((t=>0!==e[t]))){for(a in n)r.o(n,a)&&(r.m[a]=n[a]);if(l)var c=l(r)}for(t&&t(s);d<o.length;d++)i=o[d],r.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return r.O(c)},s=globalThis.webpackChunkmisago=globalThis.webpackChunkmisago||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})(),r.O(void 0,[736],(()=>r(2233))),r.O(void 0,[736],(()=>r(1341))),r.O(void 0,[736],(()=>r(3409))),r.O(void 0,[736],(()=>r(2292))),r.O(void 0,[736],(()=>r(3060))),r.O(void 0,[736],(()=>r(8251))),r.O(void 0,[736],(()=>r(8749))),r.O(void 0,[736],(()=>r(1513))),r.O(void 0,[736],(()=>r(2331))),r.O(void 0,[736],(()=>r(7549))),r.O(void 0,[736],(()=>r(9764))),r.O(void 0,[736],(()=>r(6093))),r.O(void 0,[736],(()=>r(7751))),r.O(void 0,[736],(()=>r(3240))),r.O(void 0,[736],(()=>r(6226))),r.O(void 0,[736],(()=>r(4109))),r.O(void 0,[736],(()=>r(8339))),r.O(void 0,[736],(()=>r(3526))),r.O(void 0,[736],(()=>r(5577))),r.O(void 0,[736],(()=>r(3934))),r.O(void 0,[736],(()=>r(4108))),r.O(void 0,[736],(()=>r(3589))),r.O(void 0,[736],(()=>r(1229))),r.O(void 0,[736],(()=>r(9984))),r.O(void 0,[736],(()=>r(1521))),r.O(void 0,[736],(()=>r(8351))),r.O(void 0,[736],(()=>r(1764))),r.O(void 0,[736],(()=>r(4444))),r.O(void 0,[736],(()=>r(4113))),r.O(void 0,[736],(()=>r(8255))),r.O(void 0,[736],(()=>r(846))),r.O(void 0,[736],(()=>r(6720))),r.O(void 0,[736],(()=>r(7031))),r.O(void 0,[736],(()=>r(7806))),r.O(void 0,[736],(()=>r(2168))),r.O(void 0,[736],(()=>r(630))),r.O(void 0,[736],(()=>r(5920))),r.O(void 0,[736],(()=>r(1814))),r.O(void 0,[736],(()=>r(5049))),r.O(void 0,[736],(()=>r(1323))),r.O(void 0,[736],(()=>r(1768))),r.O(void 0,[736],(()=>r(2488))),r.O(void 0,[736],(()=>r(5563))),r.O(void 0,[736],(()=>r(4795))),r.O(void 0,[736],(()=>r(3026))),r.O(void 0,[736],(()=>r(9223))),r.O(void 0,[736],(()=>r(4894)));var l=r.O(void 0,[736],(()=>r(5147)));l=r.O(l)})();
//# sourceMappingURL=misago.js.map